<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>自定义模块</title>
    <link href="/2024/06/02/%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A8%A1%E5%9D%97/"/>
    <url>/2024/06/02/%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A8%A1%E5%9D%97/</url>
    
    <content type="html"><![CDATA[<h1 id="自定义模块的调用"><a href="#自定义模块的调用" class="headerlink" title="自定义模块的调用"></a>自定义模块的调用</h1><p><strong>__name__</strong></p><p>在定义在自定义模块后，在其他程序中引入这个自定义模块后，如果不加入”if _<em>name</em>_ &#x3D;&#x3D; “_<em>main</em><em>“,防止模块中的测试代码被执行。当一个python模块被导入时，__name__会被设置为模块的名称，如果直接执行__name__会被设置成__main__。如果当钱文件的__name__的值为</em>__name__的时候才会被执行。</p><blockquote><p>建立一个a.py文件</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(__name__)<br></code></pre></td></tr></table></figure><p>运行该程序，则会输出__main__。</p><blockquote><p>如果再建立一个b.py 导入a.py再运行程序</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> a<br></code></pre></td></tr></table></figure><p>运行这个程序的时候，输出为oop01，此时a.py文件中的print(__name__)输出的是a.py文件的名称。</p><p><strong>__all__</strong></p><p>__all__可以设置自定义模块中那些函数可以被其他程序导入。但是这个也有限制，如果是使用 from model import *的方式，程序中设置的__all__限制是起作用的，但是如果是import model的方式导入模块，则不受__all__的限制。</p><blockquote><p>建立一个a1.py文件</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">h1</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;hi&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ok</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ok&quot;</span>)<br></code></pre></td></tr></table></figure><blockquote><p>建立一个b1.py文件</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> a1<br><br>a1.h1()<br>a1.ok()<br></code></pre></td></tr></table></figure><p>运行b1.py文件，结果如下。</p><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_37f4c796ddf0af6e6c630ec7f43a5e00.png"></p><p><strong>如果使用__all__进行限制</strong></p><blockquote><p>在a1.py文件中添加一行带代码</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">h1</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;hi&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ok</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ok&quot;</span>)<br> <br>__all__ = [<span class="hljs-string">&quot;ok&quot;</span>]  <span class="hljs-comment"># 这里只运行ok函数可以通过使用</span><br></code></pre></td></tr></table></figure><blockquote><p>修该b1.py文件</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> a1 <span class="hljs-keyword">import</span> *<br><br>hi()  <span class="hljs-comment"># 此时的h1函数不能使用</span><br>ok()<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>python面相对象</title>
    <link href="/2024/06/02/python%E9%9D%A2%E7%9B%B8%E5%AF%B9%E8%B1%A1/"/>
    <url>/2024/06/02/python%E9%9D%A2%E7%9B%B8%E5%AF%B9%E8%B1%A1/</url>
    
    <content type="html"><![CDATA[<h1 id="面向对象编程"><a href="#面向对象编程" class="headerlink" title="面向对象编程"></a>面向对象编程</h1><blockquote><p>问题提出：</p></blockquote><p>张老太养了两只猫，一只小白，今年3岁，白色。一只小花，今年8岁，花色。</p><p>【1】请编写一个程序，当用户输入小猫的名字的时候，显示该猫的名字，年龄和颜色</p><p>【2】但输入的小猫名字错误的时候则显示张老太没有这只猫猫。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 使用字典键值对的方式</span><br>cats = &#123;<span class="hljs-string">&quot;小白&quot;</span>: &#123;<span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;小白&quot;</span>, <span class="hljs-string">&quot;age&quot;</span>: <span class="hljs-number">3</span>, <span class="hljs-string">&quot;color&quot;</span>: <span class="hljs-string">&quot;white&quot;</span>&#125;, <span class="hljs-string">&quot;小花&quot;</span>: &#123;<span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;小花&quot;</span>, <span class="hljs-string">&quot;age&quot;</span>: <span class="hljs-number">8</span>, <span class="hljs-string">&quot;color&quot;</span>: <span class="hljs-string">&quot;花色&quot;</span>&#125;&#125;<br>name = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;请输入小猫的名字: &quot;</span>)<br><span class="hljs-keyword">if</span> name <span class="hljs-keyword">in</span> cats.keys():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;小猫的名字:<span class="hljs-subst">&#123;cats[name][<span class="hljs-string">&#x27;name&#x27;</span>]&#125;</span>\n小猫的年龄: <span class="hljs-subst">&#123;cats[name][<span class="hljs-string">&#x27;age&#x27;</span>]&#125;</span>\n小猫的颜色: <span class="hljs-subst">&#123;cats[name][<span class="hljs-string">&#x27;color&#x27;</span>]&#125;</span>&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;张老太没有叫<span class="hljs-subst">&#123;name&#125;</span>的小猫&quot;</span>)<br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_7e6e15147615be8ad58ad89c4832eed7.png"></p><blockquote><p>存在问题：上面的字典只能保存小猫的属性，但是无法关联小猫的行为（动作）。</p></blockquote><p><strong>类可以将对象的属性和方法绑定在一起，扩增对象的功能</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Cat</span>:<br>    name = <span class="hljs-literal">None</span><br>    age = <span class="hljs-literal">None</span><br>    color = <span class="hljs-literal">None</span><br><br><br><span class="hljs-comment"># 实例化对象</span><br>cat1 = Cat()<br>cat1.name = <span class="hljs-string">&quot;小白&quot;</span><br>cat1.age = <span class="hljs-number">3</span><br>cat1.color = <span class="hljs-string">&quot;white&quot;</span><br><br>cat2 = Cat()<br>cat2.name = <span class="hljs-string">&quot;小花&quot;</span><br>cat2.age = <span class="hljs-number">8</span><br>cat2.color = <span class="hljs-string">&quot;花色&quot;</span><br><br><span class="hljs-comment"># 打印信息</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;cat1的名字<span class="hljs-subst">&#123;cat1.name&#125;</span>,年龄<span class="hljs-subst">&#123;cat1.age&#125;</span>,颜色<span class="hljs-subst">&#123;cat1.color&#125;</span>&quot;</span>)<br><span class="hljs-comment">#cat1的名字小白,年龄3,颜色white</span><br></code></pre></td></tr></table></figure><blockquote><p>oop的方式可以更好的管理小猫的属性</p></blockquote><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_5c1b201761e8c82fe835360c8adf717e.png"></p><h3 id="对象的布尔值"><a href="#对象的布尔值" class="headerlink" title="对象的布尔值"></a>对象的布尔值</h3><p>一下的对象值都是False</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;-----下面对象的布尔值------&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bool</span>(<span class="hljs-literal">False</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bool</span>(<span class="hljs-number">0</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bool</span>(<span class="hljs-literal">None</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bool</span>(<span class="hljs-string">&quot;&quot;</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bool</span>([]))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bool</span>(()))  <span class="hljs-comment"># 空元组</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bool</span>(&#123;&#125;))  <span class="hljs-comment"># 空字典</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bool</span>(<span class="hljs-built_in">set</span>()))  <span class="hljs-comment"># 空集合</span><br></code></pre></td></tr></table></figure><h3 id="成员方法"><a href="#成员方法" class="headerlink" title="成员方法"></a>成员方法</h3><p>类中定义的行为(函数)，称为成员方法。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">Func</span>(<span class="hljs-params">self,参数列表</span>):<br>    方法体<br></code></pre></td></tr></table></figure><ul><li>在方法定义参数列表时，需要添加self</li><li>self在定义成员方法的时候需要写上</li><li>self表示当前对象本身，有点类似js中的this</li><li>在通过对象调用方法的时候，self会隐式传入</li><li>在方法内部需要使用self才能访问到成员变量</li></ul><blockquote><p>问题提出</p></blockquote><p>【1】定义一个Person类，有name和age属性，完成如下的要求</p><p>【2】添加hi成员方法，输出“hi python”</p><p>【3】添加cal01成员方法，计算1+..+1000的结果</p><p>【4】添加cal02成员方法，该方法可以接收一个数n，计算从1+..+n的结果</p><p>【5】添加get_sum成员方法，计算两个数的和，并返回</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span>:<br>    name = <span class="hljs-literal">None</span><br>    age = <span class="hljs-literal">None</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">hi</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;hi pyhton&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">cal01</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">sum</span> = <span class="hljs-number">0</span><br>        i = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">while</span> i &lt;= <span class="hljs-number">100</span>:<br>            <span class="hljs-built_in">sum</span> += i<br>            i += <span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">sum</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">cal02</span>(<span class="hljs-params">self, n</span>):<br>        <span class="hljs-built_in">sum</span> = <span class="hljs-number">0</span><br>        i = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">while</span> i &lt;= n:<br>            <span class="hljs-built_in">sum</span> += i<br>            i += <span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">sum</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_sum</span>(<span class="hljs-params">self, num1, num2</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;两个数的和为<span class="hljs-subst">&#123;num1 + num2&#125;</span>&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    person = Person()<br>    person.name = <span class="hljs-string">&quot;小明&quot;</span><br>    person.age = <span class="hljs-number">20</span><br>    person.hi()<br>    person.cal01()<br>    person.cal02(n=<span class="hljs-number">10</span>)<br>    person.get_sum(num1=<span class="hljs-number">10</span>, num2=<span class="hljs-number">20</span>)<br><br><span class="hljs-comment"># 输出结果</span><br><span class="hljs-comment"># hi pyhton</span><br><span class="hljs-comment"># 5050</span><br><span class="hljs-comment"># 55</span><br><span class="hljs-comment"># 两个数的和为30</span><br></code></pre></td></tr></table></figure><blockquote><p>动态的给对象添加方法</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">test</span>():<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;this is a test&quot;</span><br>person.test = test <span class="hljs-comment"># 动态的给当前的对象person添加方法test</span><br><span class="hljs-built_in">print</span>(person.test()) <span class="hljs-comment"># this is a test</span><br></code></pre></td></tr></table></figure><h3 id="self"><a href="#self" class="headerlink" title="self"></a>self</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Cat</span>:<br>    name = <span class="hljs-string">&quot;加菲猫&quot;</span><br>    age = <span class="hljs-number">2</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">info</span>(<span class="hljs-params">self, name</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;name的信息为: <span class="hljs-subst">&#123;name&#125;</span>&quot;</span>)<br><br><br>cat = Cat()<br>cat.info(name=<span class="hljs-string">&quot;波斯猫&quot;</span>) <span class="hljs-comment"># 输出：name的信息为: 波斯猫</span><br></code></pre></td></tr></table></figure><blockquote><p>如果添加上self呢？</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Cat</span>:<br>    name = <span class="hljs-string">&quot;加菲猫&quot;</span><br>    age = <span class="hljs-number">2</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">info</span>(<span class="hljs-params">self, name</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;name的信息为: <span class="hljs-subst">&#123;self.name&#125;</span>&quot;</span>)<br><br><br>cat = Cat()<br>cat.info(name=<span class="hljs-string">&quot;波斯猫&quot;</span>) <span class="hljs-comment">#输出结果：name的信息为: 加菲猫</span><br></code></pre></td></tr></table></figure><p>在对象中定义方法的时候，需要在函数中添加self参数，如果不想添加self参数，可以使用静态方法</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Cat</span>:<br>    name = <span class="hljs-string">&quot;加菲猫&quot;</span><br>    age = <span class="hljs-number">2</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">info</span>(<span class="hljs-params">self, name</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;name的信息为: <span class="hljs-subst">&#123;self.name&#125;</span>&quot;</span>)<br><br><span class="hljs-meta">    @staticmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test</span>():<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;this is a static test&quot;</span>)<br><br><br>cat = Cat()<br>cat.info(name=<span class="hljs-string">&quot;波斯猫&quot;</span>)<br>cat.test()  <span class="hljs-comment"># 使用对象调用静态方法</span><br>Cat.test()  <span class="hljs-comment"># 使用类调用静态方法</span><br></code></pre></td></tr></table></figure><p>那么对象和self之间的关系是什么呢？那个对象调用，self就指向那个对象。<strong>self是隐式传入函数中</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;self的地址<span class="hljs-subst">&#123;<span class="hljs-built_in">id</span>(self)&#125;</span>&quot;</span>)<br><br><br>dog = Dog()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;dog对象的地址<span class="hljs-subst">&#123;<span class="hljs-built_in">id</span>(dog)&#125;</span>&quot;</span>)<br>dog.test()<br><span class="hljs-comment">#dog对象的地址3123093511760</span><br><span class="hljs-comment">#self的地址3123093511760</span><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span>:<br>    name = <span class="hljs-string">&quot;藏獒&quot;</span><br>    age = <span class="hljs-number">2</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">eat</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;self.name&#125;</span>饿了&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">cry</span>(<span class="hljs-params">self, name</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;name&#125;</span> is crying&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;self.name&#125;</span> is crying&quot;</span>)<br>        self.eat()<br><br><br>dog = Dog()<br>dog.cry(<span class="hljs-string">&quot;金毛&quot;</span>)<br><span class="hljs-comment">#金毛 is crying</span><br><span class="hljs-comment">#藏獒 is crying</span><br><span class="hljs-comment">#藏獒饿了</span><br><br>dog = Dog()<br><span class="hljs-comment"># dog.cry(&quot;金毛&quot;)</span><br>dog.name = <span class="hljs-string">&quot;中华田园犬&quot;</span><br>dog.cry(<span class="hljs-string">&quot;金毛&quot;</span>)<br><span class="hljs-comment"># 金毛 is crying</span><br><span class="hljs-comment"># 中华田园犬 is crying</span><br><span class="hljs-comment"># 中华田园犬饿了</span><br></code></pre></td></tr></table></figure><blockquote><p>练习</p></blockquote><p>【1】定义一个person类</p><p>【2】里面有name，age属性</p><p>【3】并提供compare_to比较方法，用于判断是否和另一个人相等</p><p>【4】名字和年龄都相等则返回True否则返回False</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span>:<br>    name = <span class="hljs-string">&quot;小明&quot;</span><br>    age = <span class="hljs-number">12</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">compare_to</span>(<span class="hljs-params">self, other</span>):<br>        <span class="hljs-keyword">if</span> self.name == other.name <span class="hljs-keyword">and</span> self.age == other.age:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><br>p1 = Person()<br>p2 = Person()<br>p2.name = <span class="hljs-string">&quot;小花&quot;</span><br>p2.age = <span class="hljs-number">24</span><br><span class="hljs-built_in">print</span>(p1.compare_to(p2)) <span class="hljs-comment"># False</span><br></code></pre></td></tr></table></figure><p>也可以编写添加构造器的版本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name, age</span>):<br>        self.name = name<br>        self.age = age<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">compare_to</span>(<span class="hljs-params">self, other</span>):<br>        <span class="hljs-keyword">if</span> self.name == other.name <span class="hljs-keyword">and</span> self.age == other.age:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><br>p1 = Person(name=<span class="hljs-string">&quot;xiao&quot;</span>, age=<span class="hljs-number">20</span>)<br>p2 = Person(name=<span class="hljs-string">&quot;xiao&quot;</span>, age=<span class="hljs-number">20</span>)<br><span class="hljs-built_in">print</span>(p1.compare_to(p2))  <span class="hljs-comment"># True</span><br></code></pre></td></tr></table></figure><h3 id="对象的传参机制"><a href="#对象的传参机制" class="headerlink" title="对象的传参机制"></a>对象的传参机制</h3><p>可以看出下面例子中p1的内存地址并没有发生改变。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span>:<br>    name = <span class="hljs-literal">None</span><br>    age = <span class="hljs-literal">None</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">f</span>(<span class="hljs-params">person</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;peeson的地址<span class="hljs-subst">&#123;<span class="hljs-built_in">id</span>(person)&#125;</span>&quot;</span>)<br>    person.name = <span class="hljs-string">&quot;json&quot;</span><br>    person.age += <span class="hljs-number">1</span><br><br><br>p1 = Person()<br>p1.name = <span class="hljs-string">&quot;joden&quot;</span><br>p1.age = <span class="hljs-number">10</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;p1的地址<span class="hljs-subst">&#123;<span class="hljs-built_in">id</span>(p1)&#125;</span>,p1的名字<span class="hljs-subst">&#123;p1.name&#125;</span>,p1的年龄<span class="hljs-subst">&#123;p1.age&#125;</span>&quot;</span>)<br>f(p1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;p1的地址<span class="hljs-subst">&#123;<span class="hljs-built_in">id</span>(p1)&#125;</span>,p1的名字<span class="hljs-subst">&#123;p1.name&#125;</span>,p1的年龄<span class="hljs-subst">&#123;p1.age&#125;</span>&quot;</span>)<br><span class="hljs-comment">#p1的地址2267628644048,p1的名字joden,p1的年龄10</span><br><span class="hljs-comment">#peeson的地址2267628644048</span><br><span class="hljs-comment">#p1的地址2267628644048,p1的名字json,p1的年龄11</span><br></code></pre></td></tr></table></figure><h3 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h3><p>在面向对象编程中主要的变量就是成员变量（属性）和局部变量，局部变量一般是在成员方法中定义的变量，作用域只在成员方法中，出了成员方法没用。属性和局部变量是可以重名的，访问的时候带上self表示访问的是属性，没有带self表示访问的是局部变量。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span>:<br>    name = <span class="hljs-literal">None</span><br>    age = <span class="hljs-literal">None</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">hi</span>(<span class="hljs-params">self</span>):<br>        name = <span class="hljs-string">&quot;pipi&quot;</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;name=<span class="hljs-subst">&#123;name&#125;</span>&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;name=<span class="hljs-subst">&#123;self.name&#125;</span>&quot;</span>)<br><br><br>p = Person()<br>p.hi()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;-&#x27;</span> * <span class="hljs-number">40</span>)<br>p.name = <span class="hljs-string">&quot;jack&quot;</span><br>p.hi()<br><span class="hljs-comment"># name=pipi</span><br><span class="hljs-comment"># name=None</span><br><span class="hljs-comment"># ----------------------------------------</span><br><span class="hljs-comment"># name=pipi</span><br><span class="hljs-comment"># name=jack</span><br></code></pre></td></tr></table></figure><h3 id="构造方法"><a href="#构造方法" class="headerlink" title="构造方法"></a>构造方法</h3><ul><li>在初始化对象的时候会自动执行____init__</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;__init__执行&quot;</span>)<br><br><br>p1 = Person()<br>p2 = Person()<br><span class="hljs-comment"># __init__执行</span><br><span class="hljs-comment"># __init__执行</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Lambda表达式</title>
    <link href="/2024/06/02/Lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    <url>/2024/06/02/Lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<p>python中lambda表达式就是定义一个匿名函数。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">lambda</span> 参数列表:表达式<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">anonymous</span>(<span class="hljs-params">参数列表</span>):<br><span class="hljs-keyword">return</span> 表达式<br></code></pre></td></tr></table></figure><blockquote><p>举例</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">myfun = <span class="hljs-keyword">lambda</span> x: x ** <span class="hljs-number">2</span><br>lst = [myfun(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>)]<br><span class="hljs-built_in">print</span>(lst)<br><span class="hljs-comment">#[0, 1, 4, 9, 16, 25, 36, 49, 64, 81]</span><br></code></pre></td></tr></table></figure><blockquote><p>无返回值的lambda函数</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 使用 def 定义的空函数</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">do_nothing</span>():<br>    <span class="hljs-keyword">pass</span><br><br><span class="hljs-comment"># 使用 lambda 定义的“空”函数</span><br>do_nothing_lambda = <span class="hljs-keyword">lambda</span>: <span class="hljs-literal">None</span><br><br><span class="hljs-comment"># 调用这两个函数</span><br><span class="hljs-built_in">print</span>(do_nothing())         <span class="hljs-comment"># 输出: None</span><br><span class="hljs-built_in">print</span>(do_nothing_lambda())  <span class="hljs-comment"># 输出: None</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>python数据分析</title>
    <link href="/2024/06/01/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/"/>
    <url>/2024/06/01/python%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h1 id="python数据分析"><a href="#python数据分析" class="headerlink" title="python数据分析"></a>python数据分析</h1><blockquote><p><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html</a></p></blockquote><h2 id="pandas"><a href="#pandas" class="headerlink" title="pandas"></a>pandas</h2><h3 id="Serirs"><a href="#Serirs" class="headerlink" title="Serirs"></a>Serirs</h3><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_3265fe24d28b1e347a37aa7b4c4735e9.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br>ser1 = pd.Series(np.random.rand(<span class="hljs-number">10</span>), index=np.random.rand(<span class="hljs-number">10</span>), copy=<span class="hljs-literal">False</span>)<br><span class="hljs-built_in">print</span>(ser1)<br><span class="hljs-built_in">print</span>(ser1.index)<br><span class="hljs-built_in">print</span>(ser1.values)<br>ser1.values[<span class="hljs-number">0</span>] = <span class="hljs-number">123</span><br><span class="hljs-built_in">print</span>(ser1)<br></code></pre></td></tr></table></figure><p>Series函数中的copy参数，</p><ul><li><code>copy=True</code>: 当设置为<code>True</code>时，构造<code>Series</code>对象时会对传入的数据进行深拷贝。这意味着创建的<code>Series</code>对象与原始数据是独立的，修改<code>Series</code>对象不会影响原始数据，反之亦然。</li><li><code>copy=False</code>: 当设置为<code>False</code>时，构造<code>Series</code>对象时不会进行深拷贝，而是对传入的数据进行引用。这意味着创建的<code>Series</code>对象与原始数据共享相同的内存空间，修改<code>Series</code>对象可能会影响原始数据，反之亦然。</li></ul><p>默认情况下，<code>copy</code>参数是<code>False</code>。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><br><span class="hljs-comment"># 原始数据</span><br>data = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]<br><br><span class="hljs-comment"># 不进行复制</span><br>series_no_copy = pd.Series(data, copy=<span class="hljs-literal">False</span>)<br>series_no_copy[<span class="hljs-number">0</span>] = <span class="hljs-number">100</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Original data after modifying series_no_copy:&quot;</span>, data)<br><br><span class="hljs-comment"># 进行复制</span><br>series_copy = pd.Series(data, copy=<span class="hljs-literal">True</span>)<br>series_copy[<span class="hljs-number">1</span>] = <span class="hljs-number">200</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Original data after modifying series_copy:&quot;</span>, data)<br><span class="hljs-comment">#Original data after modifying series_no_copy: [100, 2, 3, 4, 5]</span><br><span class="hljs-comment">#Original data after modifying series_copy: [100, 2, 3, 4, 5]</span><br></code></pre></td></tr></table></figure><h4 id="Series中data参数输入为数值"><a href="#Series中data参数输入为数值" class="headerlink" title="Series中data参数输入为数值"></a>Series中data参数输入为数值</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># jsut a number</span><br>ser1 = pd.Series(<span class="hljs-number">1</span>, index=[<span class="hljs-string">&#x27;A&#x27;</span>])<br><span class="hljs-built_in">print</span>(ser1)<br><span class="hljs-comment">#A    1</span><br><span class="hljs-comment">#dtype: int64</span><br></code></pre></td></tr></table></figure><h4 id="Series中输入为列表"><a href="#Series中输入为列表" class="headerlink" title="Series中输入为列表"></a>Series中输入为列表</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">ser1 = pd.Series([i ** <span class="hljs-number">2</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>)], copy=<span class="hljs-literal">False</span>)<br><span class="hljs-built_in">print</span>(ser1)<br><span class="hljs-comment">#0     0</span><br><span class="hljs-comment">#1     1</span><br><span class="hljs-comment">#2     4</span><br><span class="hljs-comment">#3     9</span><br><span class="hljs-comment">#4    16</span><br><span class="hljs-comment">#dtype: int64</span><br></code></pre></td></tr></table></figure><h4 id="Series输入为字典"><a href="#Series输入为字典" class="headerlink" title="Series输入为字典"></a>Series输入为字典</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">ser1 = pd.Series(&#123;i: i**i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>)&#125;)<br><span class="hljs-built_in">print</span>(ser1)<br><span class="hljs-comment">#0      1</span><br><span class="hljs-comment">#1      1</span><br><span class="hljs-comment">#2      4</span><br><span class="hljs-comment">#3     27</span><br><span class="hljs-comment">#4    256</span><br><span class="hljs-comment">#dtype: int64</span><br></code></pre></td></tr></table></figure><h4 id="Series输入为ndarray"><a href="#Series输入为ndarray" class="headerlink" title="Series输入为ndarray"></a>Series输入为ndarray</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># ndArray</span><br>ser1 = np.ndarray(<span class="hljs-number">3</span>)<br><span class="hljs-built_in">print</span>(ser1)<br><span class="hljs-comment">#[0.  0.5 1. ]</span><br>ser1 = pd.Series(ser1)<br><span class="hljs-built_in">print</span>(ser1)<br><span class="hljs-comment">#0    0.0</span><br><span class="hljs-comment">#1    0.5</span><br><span class="hljs-comment">#2    1.0</span><br><span class="hljs-comment">#dtype: float64</span><br></code></pre></td></tr></table></figure><h3 id="设置索引值"><a href="#设置索引值" class="headerlink" title="设置索引值"></a>设置索引值</h3><p>Series中index参数默认是从0开始，也可以自己设置索引值。在Series中不能使用负数索引</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># index</span><br>ser1 = pd.Series([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>], index=[<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;D&#x27;</span>])<br><span class="hljs-built_in">print</span>(ser1)<br><span class="hljs-comment">#A    1</span><br><span class="hljs-comment">#B    2</span><br><span class="hljs-comment">#C    3</span><br><span class="hljs-comment">#D    4</span><br><span class="hljs-comment">#dtype: int64</span><br><span class="hljs-comment">#print(ser1[-1])</span><br>test = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]<br><span class="hljs-built_in">print</span>(test[-<span class="hljs-number">1</span>])<br><span class="hljs-comment">#4</span><br></code></pre></td></tr></table></figure><h3 id="Series中数据查询"><a href="#Series中数据查询" class="headerlink" title="Series中数据查询"></a>Series中数据查询</h3><h4 id="通过索引位置查找数据"><a href="#通过索引位置查找数据" class="headerlink" title="通过索引位置查找数据"></a>通过索引位置查找数据</h4><p>和pyhtonlist中的索引查询一样，是左包含右不包含。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">ser1 = pd.Series(np.array(np.random.rand(<span class="hljs-number">10</span>)))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(ser1)) <span class="hljs-comment">#10</span><br><span class="hljs-built_in">print</span>(ser1[:<span class="hljs-number">5</span>])<br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_2aec08072fdb1c14c6dce3d7d010375d.png"></p><h3 id="DataFrame对象"><a href="#DataFrame对象" class="headerlink" title="DataFrame对象"></a>DataFrame对象</h3><p>DataFrame是一个二维表数据结构，由行、列数据组成的表格。DataFrame既有行索引也有列索引，它可以看作是由Series对象组成的字典，不过这些Series对象共用一个索引。</p><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_e5059041b5db319d2b37225a5762e913.png"></p><h3 id="建立DataFrame对象"><a href="#建立DataFrame对象" class="headerlink" title="建立DataFrame对象"></a>建立DataFrame对象</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">pandas.DataFrame(data,index,columns,dtype,copy)<br><span class="hljs-comment"># data：表示数据，可以是ndarray数组、Series对象、列表、字典等。</span><br><span class="hljs-comment"># index：表示行标签（索引）。</span><br><span class="hljs-comment"># columns：列标签（索引）。</span><br><span class="hljs-comment"># dtype：每一列数据的数据类型，其与Python数据类型有所不同，如object数据类型对应的是</span><br><span class="hljs-comment"># Python的字符型。表3.1为Pandas数据类型与Python数据类型的对应表。</span><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">data = [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>], [<span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>]]<br>index = [i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>column = [<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>]<br>df = pd.DataFrame(data=data, index=index, columns=column)<br><span class="hljs-built_in">print</span>(df.head())<br><span class="hljs-comment">#    A  B  C</span><br><span class="hljs-comment"># 0  1  2  3</span><br><span class="hljs-comment"># 1  4  5  6</span><br><span class="hljs-comment"># 2  7  8  9</span><br><span class="hljs-keyword">for</span> column <span class="hljs-keyword">in</span> df.columns:<br>    df_sub = df[column]<br>    <span class="hljs-built_in">print</span>(df_sub)<br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_8df57283634ad41f99d97415b08718b6.png"></p><h4 id="通过二维数据建立DataFrame"><a href="#通过二维数据建立DataFrame" class="headerlink" title="通过二维数据建立DataFrame"></a>通过二维数据建立DataFrame</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">data = [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], [<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]]<br>df = pd.DataFrame(data=data)<br><span class="hljs-built_in">print</span>(df)<br><span class="hljs-comment">#    0  1  2</span><br><span class="hljs-comment"># 0  1  2  3</span><br><span class="hljs-comment"># 1  A  B  C</span><br><span class="hljs-comment"># 2  3  4  5</span><br><span class="hljs-built_in">print</span>(df.columns)<br></code></pre></td></tr></table></figure><h4 id="通过字典创建"><a href="#通过字典创建" class="headerlink" title="通过字典创建"></a>通过字典创建</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 字典对象</span><br>data = &#123;<br>    <span class="hljs-string">&quot;A&quot;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>],<br>    <span class="hljs-string">&quot;B&quot;</span>: [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>],<br>    <span class="hljs-string">&quot;C&quot;</span>: [<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;D&#x27;</span>]<br>&#125;<br>df = pd.DataFrame(data)<br><span class="hljs-built_in">print</span>(df)<br><span class="hljs-comment">#    A  B  C</span><br><span class="hljs-comment"># 0  1  4  A</span><br><span class="hljs-comment"># 1  2  5  B</span><br><span class="hljs-comment"># 2  3  6  C</span><br><span class="hljs-comment"># 3  4  7  D</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> df.columns:<br>    <span class="hljs-built_in">print</span>(df[i].dtype)<br><span class="hljs-comment"># int64</span><br><span class="hljs-comment"># int64</span><br><span class="hljs-comment"># object</span><br></code></pre></td></tr></table></figure><h4 id="DataFrame的重要属性"><a href="#DataFrame的重要属性" class="headerlink" title="DataFrame的重要属性"></a>DataFrame的重要属性</h4><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_3492e71f01153043de31e956539c6244.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df.values)<br><span class="hljs-comment"># [[1 4 &#x27;A&#x27;]</span><br><span class="hljs-comment">#  [2 5 &#x27;B&#x27;]</span><br><span class="hljs-comment">#  [3 6 &#x27;C&#x27;]</span><br><span class="hljs-comment">#  [4 7 &#x27;D&#x27;]]</span><br><span class="hljs-built_in">print</span>(df.dtypes)<br><span class="hljs-comment"># A     int64</span><br><span class="hljs-comment"># B     int64</span><br><span class="hljs-comment"># C    object</span><br><span class="hljs-comment"># dtype: object</span><br><span class="hljs-built_in">print</span>(df.index)<br><span class="hljs-comment"># RangeIndex(start=0, stop=4, step=1)</span><br><span class="hljs-built_in">print</span>(df.columns)<br><span class="hljs-comment"># Index([&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;], dtype=&#x27;object&#x27;)</span><br><span class="hljs-built_in">print</span>(df.T)<br><span class="hljs-comment">#    0  1  2  3</span><br><span class="hljs-comment"># A  1  2  3  4</span><br><span class="hljs-comment"># B  4  5  6  7</span><br><span class="hljs-comment"># C  A  B  C  D</span><br><span class="hljs-built_in">print</span>(df.info)<br><span class="hljs-comment"># &lt;bound method DataFrame.info of    A  B  C</span><br><span class="hljs-comment"># 0  1  4  A</span><br><span class="hljs-comment"># 1  2  5  B</span><br><span class="hljs-comment"># 2  3  6  C</span><br><span class="hljs-comment"># 3  4  7  D&gt;</span><br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_27f6d2d6893386ab000c827849fa5b4b.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df.<span class="hljs-built_in">sum</span>(axis=<span class="hljs-number">0</span>)) <span class="hljs-comment"># axis=0计算列和，axis=1计算行和</span><br><span class="hljs-built_in">print</span>(df.<span class="hljs-built_in">max</span>())<br><span class="hljs-comment"># A    4</span><br><span class="hljs-comment"># B    7</span><br><span class="hljs-comment"># C    D</span><br><span class="hljs-comment"># dtype: object</span><br></code></pre></td></tr></table></figure><h4 id="导入外部数据"><a href="#导入外部数据" class="headerlink" title="导入外部数据"></a>导入外部数据</h4><ul><li>导入.xls或.xlsx文件主要使用Pandas的read_excel()方法</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">pandas.read_excel(io,sheet_name=<span class="hljs-number">0</span>,header=<span class="hljs-number">0</span>,names=<span class="hljs-literal">None</span>,index_col=<span class="hljs-literal">None</span>,usecols=<span class="hljs-literal">None</span>,squeeze=Fa<br>dtype=<span class="hljs-literal">None</span>,engine=<span class="hljs-literal">None</span>,converters=<span class="hljs-literal">None</span>,true_values=<span class="hljs-literal">None</span>,false_values=<span class="hljs-literal">None</span>,skiprows=<span class="hljs-literal">None</span>,nrow<br>na_values=<span class="hljs-literal">None</span>,keep_default_na=<span class="hljs-literal">True</span>,verbose=<span class="hljs-literal">False</span>,parse_dates=<span class="hljs-literal">False</span>,date_parser=<span class="hljs-literal">None</span>,thousan<br>comment=<span class="hljs-literal">None</span>,skipfooter=<span class="hljs-number">0</span>,conver_float=<span class="hljs-literal">True</span>,mangle_dupe_cols=<span class="hljs-literal">True</span>,**kwds)<br></code></pre></td></tr></table></figure><ul><li>导入.csv文件主要使用Pandas的read_csv()方法</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">pandas.read_csv(filepath_or_buffer, *, sep=_NoDefault.no_default, delimiter=<span class="hljs-literal">None</span>, header=<span class="hljs-string">&#x27;infer&#x27;</span>, names=_NoDefault.no_default, index_col=<span class="hljs-literal">None</span>, usecols=<span class="hljs-literal">None</span>, dtype=<span class="hljs-literal">None</span>, engine=<span class="hljs-literal">None</span>, converters=<span class="hljs-literal">None</span>, true_values=<span class="hljs-literal">None</span>, false_values=<span class="hljs-literal">None</span>, skipinitialspace=<span class="hljs-literal">False</span>, skiprows=<span class="hljs-literal">None</span>, skipfooter=<span class="hljs-number">0</span>, nrows=<span class="hljs-literal">None</span>, na_values=<span class="hljs-literal">None</span>, keep_default_na=<span class="hljs-literal">True</span>, na_filter=<span class="hljs-literal">True</span>, verbose=_NoDefault.no_default, skip_blank_lines=<span class="hljs-literal">True</span>, parse_dates=<span class="hljs-literal">None</span>, infer_datetime_format=_NoDefault.no_default, keep_date_col=_NoDefault.no_default, date_parser=_NoDefault.no_default, date_format=<span class="hljs-literal">None</span>, dayfirst=<span class="hljs-literal">False</span>, cache_dates=<span class="hljs-literal">True</span>, iterator=<span class="hljs-literal">False</span>, chunksize=<span class="hljs-literal">None</span>, compression=<span class="hljs-string">&#x27;infer&#x27;</span>, thousands=<span class="hljs-literal">None</span>, decimal=<span class="hljs-string">&#x27;.&#x27;</span>, lineterminator=<span class="hljs-literal">None</span>, quotechar=<span class="hljs-string">&#x27;&quot;&#x27;</span>, quoting=<span class="hljs-number">0</span>, doublequote=<span class="hljs-literal">True</span>, escapechar=<span class="hljs-literal">None</span>, comment=<span class="hljs-literal">None</span>, encoding=<span class="hljs-literal">None</span>, encoding_errors=<span class="hljs-string">&#x27;strict&#x27;</span>, dialect=<span class="hljs-literal">None</span>, on_bad_lines=<span class="hljs-string">&#x27;error&#x27;</span>, delim_whitespace=_NoDefault.no_default, low_memory=<span class="hljs-literal">True</span>, memory_map=<span class="hljs-literal">False</span>, float_precision=<span class="hljs-literal">None</span>, storage_options=<span class="hljs-literal">None</span>, dtype_backend=_NoDefault.no_default)[source<br></code></pre></td></tr></table></figure><ul><li>导入.txt文件，也可以使用read_csv方法，指定sep为制表符，’\t’</li></ul><h4 id="DataFram提取数据"><a href="#DataFram提取数据" class="headerlink" title="DataFram提取数据"></a>DataFram提取数据</h4><p>对象的loc属性和iloc属性都可以抽取数据</p><ul><li><p>loc属性：以列名（columns）和行名（index）作为参数，<strong>当只有一个参数时，默认是行名</strong>，即抽取整行数据，包括所有列，如df.loc[‘A’]。</p></li><li><p>iloc属性：以行和列位置索引（即0，1，2，…）作为参数，0表示第1行，1表示第2行，以此类推。<strong>当只有一个参数时，默认是行索引</strong>，即抽取整行数据，包括所有列。如抽取第1行数据，df.iloc[0]。</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python">data = &#123;<br>    <span class="hljs-string">&quot;A&quot;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>],<br>    <span class="hljs-string">&quot;B&quot;</span>: [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>],<br>    <span class="hljs-string">&quot;C&quot;</span>: [<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;D&#x27;</span>]<br>&#125;<br>df = pd.DataFrame(data)<br><span class="hljs-built_in">print</span>(df)<br><span class="hljs-comment">#    A  B  C</span><br><span class="hljs-comment"># 0  1  4  A</span><br><span class="hljs-comment"># 1  2  5  B</span><br><span class="hljs-comment"># 2  3  6  C</span><br><span class="hljs-comment"># 3  4  7  D</span><br><span class="hljs-built_in">print</span>(df.loc[<span class="hljs-number">0</span>])<br><span class="hljs-comment"># A    1</span><br><span class="hljs-comment"># B    4</span><br><span class="hljs-comment"># C    A</span><br><span class="hljs-built_in">print</span>(df.iloc[<span class="hljs-number">0</span>])<br><span class="hljs-comment"># A    1</span><br><span class="hljs-comment"># B    4</span><br><span class="hljs-comment"># C    A</span><br></code></pre></td></tr></table></figure><blockquote><p>loc和iloc的区别</p></blockquote><h4 id="loc"><a href="#loc" class="headerlink" title="loc"></a><code>loc</code></h4><ul><li><strong>基于标签（Label-based）</strong>: <code>loc</code>是通过行标签和列标签来进行选择和过滤的。</li><li><strong>包含结束点</strong>: 使用<code>loc</code>时，区间是闭区间，<strong>即包括结束点</strong>。</li><li><strong>支持布尔索引</strong>: <code>loc</code>可以接受布尔数组来进行条件筛选。</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><br><span class="hljs-comment"># 创建一个示例DataFrame</span><br>data = &#123;<br>    <span class="hljs-string">&#x27;A&#x27;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>],<br>    <span class="hljs-string">&#x27;B&#x27;</span>: [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>],<br>    <span class="hljs-string">&#x27;C&#x27;</span>: [<span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>]<br>&#125;<br>df = pd.DataFrame(data, index=[<span class="hljs-string">&#x27;x&#x27;</span>, <span class="hljs-string">&#x27;y&#x27;</span>, <span class="hljs-string">&#x27;z&#x27;</span>])<br><br><span class="hljs-comment"># 使用loc进行选择</span><br><span class="hljs-built_in">print</span>(df.loc[<span class="hljs-string">&#x27;x&#x27;</span>])  <span class="hljs-comment"># 选择标签为&#x27;x&#x27;的行</span><br><span class="hljs-built_in">print</span>(df.loc[<span class="hljs-string">&#x27;x&#x27;</span>:<span class="hljs-string">&#x27;y&#x27;</span>])  <span class="hljs-comment"># 选择标签在&#x27;x&#x27;到&#x27;y&#x27;之间的行（包括&#x27;y&#x27;）</span><br><span class="hljs-built_in">print</span>(df.loc[:, <span class="hljs-string">&#x27;A&#x27;</span>])  <span class="hljs-comment"># 选择所有行的&#x27;A&#x27;列</span><br><span class="hljs-built_in">print</span>(df.loc[df[<span class="hljs-string">&#x27;A&#x27;</span>] &gt; <span class="hljs-number">1</span>])  <span class="hljs-comment"># 选择&#x27;A&#x27;列大于1的行</span><br></code></pre></td></tr></table></figure><h4 id="iloc"><a href="#iloc" class="headerlink" title="iloc"></a><code>iloc</code></h4><ul><li><strong>基于位置（Integer position-based）</strong>: <code>iloc</code>是通过行号和列号来进行选择和过滤的。</li><li><strong>不包含结束点</strong>: 使用<code>iloc</code>时，区间是左闭右开的，即<strong>不包括结束点</strong>。</li><li><strong>只接受整数或整数数组</strong>: <code>iloc</code>只接受整数、整数列表或切片。</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 使用iloc进行选择</span><br><span class="hljs-built_in">print</span>(df.iloc[<span class="hljs-number">0</span>])  <span class="hljs-comment"># 选择第0行</span><br><span class="hljs-built_in">print</span>(df.iloc[<span class="hljs-number">0</span>:<span class="hljs-number">2</span>])  <span class="hljs-comment"># 选择第0行到第2行之间的行（不包括第2行）</span><br><span class="hljs-built_in">print</span>(df.iloc[:, <span class="hljs-number">0</span>])  <span class="hljs-comment"># 选择所有行的第0列</span><br><span class="hljs-built_in">print</span>(df.iloc[[<span class="hljs-number">0</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]])  <span class="hljs-comment"># 选择第0和第2行，第1和第2列</span><br></code></pre></td></tr></table></figure><h4 id="直接根据列名进行数据筛选"><a href="#直接根据列名进行数据筛选" class="headerlink" title="直接根据列名进行数据筛选"></a>直接根据列名进行数据筛选</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><br><span class="hljs-comment"># 创建示例 DataFrame</span><br>data = &#123;<br>    <span class="hljs-string">&#x27;A&#x27;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>],<br>    <span class="hljs-string">&#x27;B&#x27;</span>: [<span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>],<br>    <span class="hljs-string">&#x27;C&#x27;</span>: [<span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>]<br>&#125;<br>df = pd.DataFrame(data)<br><br><span class="hljs-comment"># 使用 df[&#x27;A&#x27;]</span><br>series_a = df[<span class="hljs-string">&#x27;A&#x27;</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Type of df[&#x27;A&#x27;]:&quot;</span>, <span class="hljs-built_in">type</span>(series_a))<br><span class="hljs-built_in">print</span>(series_a)<br><span class="hljs-built_in">print</span>()<br><br><span class="hljs-comment"># 使用 df[[&#x27;A&#x27;]]</span><br>dataframe_a = df[[<span class="hljs-string">&#x27;A&#x27;</span>]]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Type of df[[&#x27;A&#x27;]]:&quot;</span>, <span class="hljs-built_in">type</span>(dataframe_a))<br><span class="hljs-built_in">print</span>(dataframe_a)<br><br></code></pre></td></tr></table></figure><ol><li><strong>返回的数据类型</strong>：<ul><li><code>df[&#39;A&#39;]</code> 返回的是一个 Pandas Series 对象。</li><li><code>df[[&#39;A&#39;]]</code> 返回的是一个 Pandas DataFrame 对象。</li></ul></li><li><strong>维度</strong>：<ul><li><code>df[&#39;A&#39;]</code> 返回的是一维数据（Series）。</li><li><code>df[[&#39;A&#39;]]</code> 返回的是二维数据（DataFrame），即使只选择了一列。</li></ul></li><li><strong>操作的灵活性</strong>：<ul><li>由于 <code>df[&#39;A&#39;]</code> 是一个 Series，所以你可以直接对这个 Series 进行一维数据的操作。</li><li><code>df[[&#39;A&#39;]]</code> 是一个 DataFrame，所以你可以继续对这个 DataFrame 进行更多的二维数据操作，比如再选取其他列。</li></ul></li></ol><h4 id="按照指定条件筛选数据"><a href="#按照指定条件筛选数据" class="headerlink" title="按照指定条件筛选数据"></a>按照指定条件筛选数据</h4><ul><li><p>取其中的一个元素.iat[x,x]。</p></li><li><p>基于位置的查询，如.iloc[]、iloc[2,1]。</p></li><li><p>基于行、列名称的查询，如.loc[x]。****</p></li></ul><blockquote><p>iat查询单个元素</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">data = &#123;<br>    <span class="hljs-string">&quot;A&quot;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>],<br>    <span class="hljs-string">&quot;B&quot;</span>: [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>],<br>    <span class="hljs-string">&quot;C&quot;</span>: [<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;D&#x27;</span>]<br>&#125;<br>df = pd.DataFrame(data)<br><span class="hljs-comment">#    A  B  C</span><br><span class="hljs-comment"># 0  1  4  A</span><br><span class="hljs-comment"># 1  2  5  B</span><br><span class="hljs-comment"># 2  3  6  C</span><br><span class="hljs-comment"># 3  4  7  D</span><br><span class="hljs-built_in">print</span>(df.iat[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>])  <span class="hljs-comment"># 5</span><br><span class="hljs-built_in">print</span>(df.iat[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>])  <span class="hljs-comment"># 1</span><br></code></pre></td></tr></table></figure><blockquote><p>iloc和loc基于位置查询</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df.iloc[[<span class="hljs-number">0</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>]]) <span class="hljs-comment"># 筛选出第0，2行和第0,1列数据</span><br><span class="hljs-comment">#   A  B</span><br><span class="hljs-comment">#0  1  4</span><br><span class="hljs-comment">#2  3  6</span><br><span class="hljs-built_in">print</span>(df.iloc[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>]) <span class="hljs-comment"># 筛选出第0行第1列数据</span><br><span class="hljs-comment"># 4</span><br><span class="hljs-built_in">print</span>(df.iloc[<span class="hljs-number">0</span>:<span class="hljs-number">1</span>, <span class="hljs-number">1</span>:<span class="hljs-number">2</span>])  <span class="hljs-comment"># 筛选出第0行第1列 左包含右不包含</span><br><span class="hljs-comment">#    B</span><br><span class="hljs-comment"># 0  4</span><br><span class="hljs-built_in">print</span>(df.loc[[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>], [<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>]]) <span class="hljs-comment"># 筛选出第0,1行，第A,B列数据，左包含右包含</span><br><span class="hljs-comment">#    A  B</span><br><span class="hljs-comment"># 0  1  4</span><br><span class="hljs-comment"># 1  2  5</span><br><span class="hljs-built_in">print</span>(df.loc[(df[<span class="hljs-string">&#x27;A&#x27;</span>] &gt; <span class="hljs-number">2</span>) &amp; (df[<span class="hljs-string">&#x27;B&#x27;</span>] &gt; <span class="hljs-number">2</span>)])<br><span class="hljs-comment">#    A  B  C</span><br><span class="hljs-comment"># 2  3  6  C</span><br><span class="hljs-comment"># 3  4  7  D</span><br></code></pre></td></tr></table></figure><h4 id="数据的增加，删除，修改"><a href="#数据的增加，删除，修改" class="headerlink" title="数据的增加，删除，修改"></a>数据的增加，删除，修改</h4><h5 id="增加数据"><a href="#增加数据" class="headerlink" title="增加数据"></a>增加数据</h5><blockquote><p>增加列数据</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 新建一个DataFrame格式</span><br>data = &#123;<br>    <span class="hljs-string">&quot;A&quot;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>],<br>    <span class="hljs-string">&quot;B&quot;</span>: [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>],<br>    <span class="hljs-string">&quot;C&quot;</span>: [<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;D&#x27;</span>]<br>&#125;<br>df = pd.DataFrame(data)<br>df[<span class="hljs-string">&#x27;E&#x27;</span>] = [<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]<br><span class="hljs-built_in">print</span>(df)<br><span class="hljs-comment">#    A  B  C  E</span><br><span class="hljs-comment"># 0  1  4  A  2</span><br><span class="hljs-comment"># 1  2  5  B  3</span><br><span class="hljs-comment"># 2  3  6  C  4</span><br><span class="hljs-comment"># 3  4  7  D  5</span><br>df.loc[:, <span class="hljs-string">&quot;F&quot;</span>] = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]<br><span class="hljs-built_in">print</span>(df)<br><span class="hljs-comment">#    A  B  C  E  F</span><br><span class="hljs-comment"># 0  1  4  A  2  1</span><br><span class="hljs-comment"># 1  2  5  B  3  2</span><br><span class="hljs-comment"># 2  3  6  C  4  3</span><br><span class="hljs-comment"># 3  4  7  D  5  4</span><br></code></pre></td></tr></table></figure><blockquote><p>增加行数据</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 使用iloc或者loc</span><br>data = &#123;<br>    <span class="hljs-string">&quot;A&quot;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>],<br>    <span class="hljs-string">&quot;B&quot;</span>: [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>],<br>    <span class="hljs-string">&quot;C&quot;</span>: [<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;D&#x27;</span>]<br>&#125;<br>df = pd.DataFrame(data)<br>df.loc[<span class="hljs-string">&quot;A&quot;</span>, :] = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]<br><span class="hljs-built_in">print</span>(df)<br><span class="hljs-comment">#      A    B  C</span><br><span class="hljs-comment"># 0  1.0  4.0  A</span><br><span class="hljs-comment"># 1  2.0  5.0  B</span><br><span class="hljs-comment"># 2  3.0  6.0  C</span><br><span class="hljs-comment"># 3  4.0  7.0  D</span><br><span class="hljs-comment"># A  1.0  2.0  3</span><br>df.loc[<span class="hljs-string">&#x27;B&#x27;</span>] = [<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-string">&#x27;E&#x27;</span>]<br><span class="hljs-built_in">print</span>(df)<br><span class="hljs-comment">#      A    B  C</span><br><span class="hljs-comment"># 0  1.0  4.0  A</span><br><span class="hljs-comment"># 1  2.0  5.0  B</span><br><span class="hljs-comment"># 2  3.0  6.0  C</span><br><span class="hljs-comment"># 3  4.0  7.0  D</span><br><span class="hljs-comment"># A  1.0  2.0  3</span><br><span class="hljs-comment"># B    A    D  E</span><br></code></pre></td></tr></table></figure><blockquote><p>增加多行数据</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python">data = &#123;<br>    <span class="hljs-string">&quot;A&quot;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>],<br>    <span class="hljs-string">&quot;B&quot;</span>: [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>],<br>    <span class="hljs-string">&quot;C&quot;</span>: [<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;D&#x27;</span>]<br>&#125;<br>df = pd.DataFrame(data)<br><span class="hljs-comment"># df.loc[&quot;A&quot;, :] = [1, 2, 3]</span><br><span class="hljs-comment"># print(df)</span><br>df1 = pd.DataFrame(<br>    data=&#123;<br>        <span class="hljs-string">&#x27;A&#x27;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>],<br>        <span class="hljs-string">&#x27;B&#x27;</span>: [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>],<br>        <span class="hljs-string">&#x27;C&#x27;</span>: [<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>]<br>    &#125;<br>)<br><span class="hljs-built_in">print</span>(pd.concat([df1, df], axis=<span class="hljs-number">1</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;-&#x27;</span>*<span class="hljs-number">20</span>)<br><span class="hljs-built_in">print</span>(pd.concat([df,df1],axis=<span class="hljs-number">0</span>))<br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_2c345b67baa6713794a3092e4d7d7483.png"></p><h5 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">DataFrame.drop(labels=<span class="hljs-literal">None</span>, axis=<span class="hljs-number">0</span>, index=<span class="hljs-literal">None</span>, columns=<span class="hljs-literal">None</span>, level=<span class="hljs-literal">None</span>, inplace=<span class="hljs-literal">False</span>,error=<span class="hljs-literal">None</span>)<br><span class="hljs-comment"># labels：表示行标签或列标签。</span><br><span class="hljs-comment"># axis：axis = 0，表示按行删除；axis = 1，表示按列删除。默认值为0，即按行删除。</span><br><span class="hljs-comment"># index：删除行，默认值为None。</span><br><span class="hljs-comment"># columns：删除列，默认值为None。</span><br><span class="hljs-comment"># level：针对有两级索引的数据。level = 0，表示按第1级索引删除整行；level = 1表示按第2级索</span><br><span class="hljs-comment"># 引删除整行，默认值为None。</span><br><span class="hljs-comment"># inplace：可选参数，对原数组做出修改并返回一个新数组。默认值为False，如果值为True，那</span><br><span class="hljs-comment"># 么原数组直接就被替换。</span><br><span class="hljs-comment"># errors：参数值为ignore或raise，默认值为raise，如果值为ignore（忽略），则取消错误。</span><br></code></pre></td></tr></table></figure><blockquote><p>删除行、列数据</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><br>data = &#123;<br>    <span class="hljs-string">&quot;A&quot;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>],<br>    <span class="hljs-string">&quot;B&quot;</span>: [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>],<br>    <span class="hljs-string">&quot;C&quot;</span>: [<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;D&#x27;</span>]<br>&#125;<br>df = pd.DataFrame(data)<br><span class="hljs-built_in">print</span>(df)<br><span class="hljs-built_in">print</span>(df.drop(labels=[<span class="hljs-string">&#x27;A&#x27;</span>], axis=<span class="hljs-number">1</span>))<br><span class="hljs-built_in">print</span>(df.drop(labels=[<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>], axis=<span class="hljs-number">1</span>))<br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_d4efda7653160934731f2640c7eb6070.png"></p><h5 id="修改数据"><a href="#修改数据" class="headerlink" title="修改数据"></a>修改数据</h5><blockquote><p>修改列名</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><br>data = &#123;<br>    <span class="hljs-string">&quot;A&quot;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>],<br>    <span class="hljs-string">&quot;B&quot;</span>: [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>],<br>    <span class="hljs-string">&quot;C&quot;</span>: [<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;D&#x27;</span>]<br>&#125;<br>df = pd.DataFrame(data)<br>df.columns = [<span class="hljs-string">&#x27;上&#x27;</span>, <span class="hljs-string">&#x27;中&#x27;</span>, <span class="hljs-string">&#x27;下&#x27;</span>]<br><span class="hljs-built_in">print</span>(df)<br><span class="hljs-comment">#   上  中  下</span><br><span class="hljs-comment"># 0  1  4  A</span><br><span class="hljs-comment"># 1  2  5  B</span><br><span class="hljs-comment"># 2  3  6  C</span><br><span class="hljs-comment"># 3  4  7  D</span><br><br><span class="hljs-comment"># 使用rename对列名进行重新命名</span><br>df.rename(columns=&#123;<span class="hljs-string">&#x27;上&#x27;</span>: <span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;中&#x27;</span>: <span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;下&#x27;</span>: <span class="hljs-string">&#x27;C&#x27;</span>&#125;,inplace=<span class="hljs-literal">True</span>)<br><span class="hljs-comment"># 参数inplace为True，表示直接修改df；否则，不修改df，只返回修改后的数据。</span><br><span class="hljs-built_in">print</span>(df)<br><span class="hljs-comment">#    A  B  C</span><br><span class="hljs-comment"># 0  1  4  A</span><br><span class="hljs-comment"># 1  2  5  B</span><br><span class="hljs-comment"># 2  3  6  C</span><br><span class="hljs-comment"># 3  4  7  D</span><br></code></pre></td></tr></table></figure><blockquote><p>修改列名</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><br>data = &#123;<br>    <span class="hljs-string">&quot;A&quot;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>],<br>    <span class="hljs-string">&quot;B&quot;</span>: [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>],<br>    <span class="hljs-string">&quot;C&quot;</span>: [<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;D&#x27;</span>]<br>&#125;<br>df = pd.DataFrame(data)<br><br>df.index = [<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;D&#x27;</span>]<br><span class="hljs-built_in">print</span>(df)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;-&#x27;</span> * <span class="hljs-number">30</span>)<br>df = df.rename(index=&#123;<span class="hljs-string">&#x27;A&#x27;</span>: <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;B&#x27;</span>: <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;C&#x27;</span>: <span class="hljs-number">3</span>, <span class="hljs-string">&#x27;D&#x27;</span>: <span class="hljs-number">4</span>&#125;, inplace=<span class="hljs-literal">False</span>)<br><span class="hljs-built_in">print</span>(df)<br><span class="hljs-comment">#  A  B  C</span><br><span class="hljs-comment"># A  1  4  A</span><br><span class="hljs-comment"># B  2  5  B</span><br><span class="hljs-comment"># C  3  6  C</span><br><span class="hljs-comment"># D  4  7  D</span><br><span class="hljs-comment"># ------------------------------</span><br><span class="hljs-comment">#    A  B  C</span><br><span class="hljs-comment"># 1  1  4  A</span><br><span class="hljs-comment"># 2  2  5  B</span><br><span class="hljs-comment"># 3  3  6  C</span><br><span class="hljs-comment"># 4  4  7  D</span><br></code></pre></td></tr></table></figure><blockquote><p>修改数据</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><br>data = &#123;<br>    <span class="hljs-string">&quot;A&quot;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>],<br>    <span class="hljs-string">&quot;B&quot;</span>: [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>],<br>    <span class="hljs-string">&quot;C&quot;</span>: [<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;D&#x27;</span>]<br>&#125;<br>df = pd.DataFrame(data)<br><span class="hljs-comment"># 修改整行数据</span><br>df.loc[<span class="hljs-string">&#x27;C&#x27;</span>] = <span class="hljs-built_in">list</span>(<span class="hljs-string">&#x27;DEF&#x27;</span>)<br><span class="hljs-built_in">print</span>(df)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;-&#x27;</span> * <span class="hljs-number">30</span>)<br>df.iloc[<span class="hljs-number">0</span>] = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]<br><span class="hljs-built_in">print</span>(df)<br><span class="hljs-comment"># 修改整列数据</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;-&#x27;</span> * <span class="hljs-number">30</span>)<br>df.loc[:, <span class="hljs-string">&#x27;D&#x27;</span>] = <span class="hljs-built_in">list</span>(<span class="hljs-string">&#x27;HELLO&#x27;</span>)<br><span class="hljs-built_in">print</span>(df)<br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_312b64d12acc77cb9315956dde4017f4.png"></p><h5 id="删除缺失值"><a href="#删除缺失值" class="headerlink" title="删除缺失值"></a>删除缺失值</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">DataFrame.dropna(axis=<span class="hljs-number">0</span>, how=<span class="hljs-string">&#x27;any&#x27;</span>, thresh=<span class="hljs-literal">None</span>, subset=<span class="hljs-literal">None</span>, inplace=<span class="hljs-literal">False</span>)<br></code></pre></td></tr></table></figure><ul><li><code>axis</code>: 决定是删除行(0)还是删除列(1)。</li><li><code>how</code>: 决定删除包含任意缺失值的行&#x2F;列(<code>&#39;any&#39;</code>)还是只删除包含全部缺失值的行&#x2F;列(<code>&#39;all&#39;</code>)。</li><li><code>thresh</code>: 设置行&#x2F;列中至少需要有多少个非缺失值才能被保留。</li><li><code>subset</code>: 指定需要检查缺失值的特定列。</li><li><code>inplace</code>: 如果设为 <code>True</code>,则直接修改原有的 DataFrame,否则返回一个新的 DataFrame。</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">df.dropna() <span class="hljs-comment"># 删除缺失值</span><br></code></pre></td></tr></table></figure><h3 id="数据清洗"><a href="#数据清洗" class="headerlink" title="数据清洗"></a>数据清洗</h3><h4 id="缺失值处理"><a href="#缺失值处理" class="headerlink" title="缺失值处理"></a>缺失值处理</h4><blockquote><p>删除缺失值</p></blockquote><ul><li>dropna()</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">DataFrame.dropna(axis=<span class="hljs-number">0</span>, how=<span class="hljs-string">&#x27;any&#x27;</span>, thresh=<span class="hljs-literal">None</span>, subset=<span class="hljs-literal">None</span>, inplace=<span class="hljs-literal">False</span>)<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><br>data = &#123;<br>    <span class="hljs-string">&quot;A&quot;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>],<br>    <span class="hljs-string">&quot;B&quot;</span>: [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, np.nan],<br>    <span class="hljs-string">&quot;C&quot;</span>: [<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;D&#x27;</span>]<br>&#125;<br>df = pd.DataFrame(data)<br><span class="hljs-built_in">print</span>(df)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;-&#x27;</span> * <span class="hljs-number">30</span>)<br><span class="hljs-built_in">print</span>(df.dropna(axis=<span class="hljs-string">&#x27;columns&#x27;</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;-&#x27;</span> * <span class="hljs-number">30</span>)<br><span class="hljs-built_in">print</span>(df.dropna(axis=<span class="hljs-string">&#x27;rows&#x27;</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;-&#x27;</span> * <span class="hljs-number">30</span>)<br><span class="hljs-built_in">print</span>(df.dropna(axis=<span class="hljs-string">&#x27;index&#x27;</span>))<br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_6b227501abbb8210cdeb1b6af4a8603f.png"></p><blockquote><p>数据填充</p></blockquote><ul><li>fillna</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">DataFrame.fillna(value=<span class="hljs-literal">None</span>, *, method=<span class="hljs-literal">None</span>, axis=<span class="hljs-literal">None</span>, inplace=<span class="hljs-literal">False</span>, limit=<span class="hljs-literal">None</span>, downcast=_NoDefault.no_default)<br><br>method&#123;‘backfill’, ‘bfill’, ‘ffill’, <span class="hljs-literal">None</span>&#125;, default <span class="hljs-literal">None</span><br>Method to use <span class="hljs-keyword">for</span> filling holes <span class="hljs-keyword">in</span> reindexed Series:<br><br>ffill: propagate last valid observation forward to <span class="hljs-built_in">next</span> valid.<br><br>backfill / bfill: use <span class="hljs-built_in">next</span> valid observation to fill gap.<br><br>Deprecated since version <span class="hljs-number">2.1</span><span class="hljs-number">.0</span>: Use ffill <span class="hljs-keyword">or</span> bfill instead.<br><br>axis&#123;<span class="hljs-number">0</span> <span class="hljs-keyword">or</span> ‘index’&#125; <span class="hljs-keyword">for</span> Series, &#123;<span class="hljs-number">0</span> <span class="hljs-keyword">or</span> ‘index’, <span class="hljs-number">1</span> <span class="hljs-keyword">or</span> ‘columns’&#125; <span class="hljs-keyword">for</span> DataFrame<br>Axis along which to fill missing values. For Series this parameter <span class="hljs-keyword">is</span> unused <span class="hljs-keyword">and</span> defaults to <span class="hljs-number">0.</span><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><br>data = &#123;<br>    <span class="hljs-string">&quot;A&quot;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>],<br>    <span class="hljs-string">&quot;B&quot;</span>: [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, np.nan],<br>    <span class="hljs-string">&quot;C&quot;</span>: [<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;C&#x27;</span>, <span class="hljs-string">&#x27;D&#x27;</span>]<br>&#125;<br>df = pd.DataFrame(data)<br><span class="hljs-built_in">print</span>(df)<br><span class="hljs-comment"># print(&#x27;-&#x27; * 30)</span><br><span class="hljs-comment"># print(df.dropna(axis=&#x27;columns&#x27;))</span><br><span class="hljs-comment"># print(&#x27;-&#x27; * 30)</span><br><span class="hljs-comment"># print(df.dropna(axis=&#x27;rows&#x27;))</span><br><span class="hljs-comment"># print(&#x27;-&#x27; * 30)</span><br><span class="hljs-comment"># print(df.dropna(axis=&#x27;index&#x27;))</span><br><br><span class="hljs-built_in">print</span>(df.fillna(value=<span class="hljs-number">0</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;-&#x27;</span> * <span class="hljs-number">30</span>)<br><span class="hljs-built_in">print</span>(df.fillna(value=<span class="hljs-number">1</span>))<br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_1ed2c03deaf706fe99f41eea1706305b.png"></p><blockquote><p>重复值处理</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">duplicated()<br>drop_duplicates()<br>DataFrame.drop_duplicates(subset=<span class="hljs-literal">None</span>, *, keep=<span class="hljs-string">&#x27;first&#x27;</span>, inplace=<span class="hljs-literal">False</span>, ignore_index=<span class="hljs-literal">False</span>)<br>Return DataFrame <span class="hljs-keyword">with</span> duplicate rows removed.<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>df = pd.DataFrame(&#123;<br><span class="hljs-meta">... </span>    <span class="hljs-string">&#x27;brand&#x27;</span>: [<span class="hljs-string">&#x27;Yum Yum&#x27;</span>, <span class="hljs-string">&#x27;Yum Yum&#x27;</span>, <span class="hljs-string">&#x27;Indomie&#x27;</span>, <span class="hljs-string">&#x27;Indomie&#x27;</span>, <span class="hljs-string">&#x27;Indomie&#x27;</span>],<br><span class="hljs-meta">... </span>    <span class="hljs-string">&#x27;style&#x27;</span>: [<span class="hljs-string">&#x27;cup&#x27;</span>, <span class="hljs-string">&#x27;cup&#x27;</span>, <span class="hljs-string">&#x27;cup&#x27;</span>, <span class="hljs-string">&#x27;pack&#x27;</span>, <span class="hljs-string">&#x27;pack&#x27;</span>],<br><span class="hljs-meta">... </span>    <span class="hljs-string">&#x27;rating&#x27;</span>: [<span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3.5</span>, <span class="hljs-number">15</span>, <span class="hljs-number">5</span>]<br><span class="hljs-meta">... </span>&#125;)<br><span class="hljs-meta">&gt;&gt;&gt; </span>df<br>    brand style  rating<br><span class="hljs-number">0</span>  Yum Yum   cup     <span class="hljs-number">4.0</span><br><span class="hljs-number">1</span>  Yum Yum   cup     <span class="hljs-number">4.0</span><br><span class="hljs-number">2</span>  Indomie   cup     <span class="hljs-number">3.5</span><br><span class="hljs-number">3</span>  Indomie  pack    <span class="hljs-number">15.0</span><br><span class="hljs-number">4</span>  Indomie  pack     <span class="hljs-number">5.0</span><br><br><span class="hljs-meta">&gt;&gt;&gt; </span>df.drop_duplicates()<br>    brand style  rating<br><span class="hljs-number">0</span>  Yum Yum   cup     <span class="hljs-number">4.0</span><br><span class="hljs-number">2</span>  Indomie   cup     <span class="hljs-number">3.5</span><br><span class="hljs-number">3</span>  Indomie  pack    <span class="hljs-number">15.0</span><br><span class="hljs-number">4</span>  Indomie  pack     <span class="hljs-number">5.0</span><br><br><span class="hljs-meta">&gt;&gt;&gt; </span>df.drop_duplicates(subset=[<span class="hljs-string">&#x27;brand&#x27;</span>])<br>    brand style  rating<br><span class="hljs-number">0</span>  Yum Yum   cup     <span class="hljs-number">4.0</span><br><span class="hljs-number">2</span>  Indomie   cup     <span class="hljs-number">3.5</span><br><br><span class="hljs-meta">&gt;&gt;&gt; </span>df.drop_duplicates(subset=[<span class="hljs-string">&#x27;brand&#x27;</span>, <span class="hljs-string">&#x27;style&#x27;</span>], keep=<span class="hljs-string">&#x27;last&#x27;</span>)<br>    brand style  rating<br><span class="hljs-number">1</span>  Yum Yum   cup     <span class="hljs-number">4.0</span><br><span class="hljs-number">2</span>  Indomie   cup     <span class="hljs-number">3.5</span><br><span class="hljs-number">4</span>  Indomie  pack     <span class="hljs-number">5.0</span><br></code></pre></td></tr></table></figure><h4 id="设置某列为行索引"><a href="#设置某列为行索引" class="headerlink" title="设置某列为行索引"></a>设置某列为行索引</h4><p>设置某列为行索引主要使用set_index()方法。如果在set_index()方法中传入参数drop&#x3D;True，则会删除”设置的索引列名”；如果传入drop&#x3D;False，则会保留设置的索引列。默认为False。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">df2=df.dropna().reset_index(drop=<span class="hljs-literal">True</span>) <span class="hljs-comment"># 删除NaN值后重新设置索引</span><br></code></pre></td></tr></table></figure><h4 id="数据排序"><a href="#数据排序" class="headerlink" title="数据排序"></a>数据排序</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">DataFrame.sort_values(by,axis=<span class="hljs-number">0</span>,ascending=<span class="hljs-literal">True</span>,inplace=<span class="hljs-literal">False</span>,kind=<span class="hljs-string">&#x27;quicksort&#x27;</span>,na_position=<span class="hljs-string">&#x27;l</span><br><span class="hljs-string">index=False)</span><br><span class="hljs-string"></span><br><span class="hljs-string">by：要排序的名称列表。</span><br><span class="hljs-string">axis：轴，axis=0表示行，axis=1表示列。默认值为0，即按行排序。</span><br><span class="hljs-string">ascending：升序或降序排序，布尔值，指定多个排序可以使用布尔值列表。默认值为True。</span><br><span class="hljs-string">inplace：布尔值，默认值为False，如果值为True，则就地排序。</span><br><span class="hljs-string">kind：指定排序算法，值为quicksort（快速排序）、mergesort（混合排序）或heapsort（堆排），默认值为quicksort。</span><br><span class="hljs-string">na_position：空值（NaN）的位置，值为first空值在数据开头，值为last空值在数据最后，默认值为last。</span><br><span class="hljs-string">ignore_index：布尔值，是否忽略索引，值为True标记索引（从0开始按顺序的整数值），值为False则忽略索引。</span><br></code></pre></td></tr></table></figure><h4 id="分组统计"><a href="#分组统计" class="headerlink" title="分组统计"></a>分组统计</h4><p>group_by</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">DataFrame.groupby(by=<span class="hljs-literal">None</span>,axis=<span class="hljs-number">0</span>,level=<span class="hljs-literal">None</span>,as_index=<span class="hljs-literal">True</span>,sort=<span class="hljs-literal">True</span>,group_keys=<span class="hljs-literal">True</span>,squeeze=<br>observed=<span class="hljs-literal">False</span>)<br></code></pre></td></tr></table></figure><p>by：映射、字典或Series对象、数组、标签或标签列表。如果by是一个函数，则对象索引的每个</p><p>值都调用它；如果传递了一个字典或Series对象，则使用该字典或Series对象值来确定组；如果传</p><p>递了数组ndarray，则按原样使用这些值来确定组。</p><p>axis：axis&#x3D;1表示行，axis&#x3D;0表示列。默认值为0。</p><p>level：表示索引层级，默认值为None（无）。</p><p>as_index：布尔型，默认值为True，返回以组标签为索引的对象。</p><p>sort：对组进行排序，布尔型，默认值为True。</p><p>group_keys：布尔型，默认值为True，调用apply()函数时，将分组的键添加到索引以标识片段。</p><p>squeeze：布尔型，默认值为False。如果可能，减少返回类型的维度；否则返回一致类型。</p><p>observed：当以石斑鱼为分类时，才会使用该参数。如果参数值为True，则仅显示分类石斑鱼的观测值；如果参数值为False，则显示分类石斑鱼的所有值。</p><p>返回值：返回DataFrameGroupBy，返回包含有关组的信息的groupby对象。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><br><span class="hljs-comment"># 导入示例数据</span><br>data = sns.load_dataset(<span class="hljs-string">&quot;iris&quot;</span>)<br><span class="hljs-built_in">print</span>(data.head())<br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_e4f4b05f04c9a9a0ef0e7fa2c6d59009.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(data.groupby(<span class="hljs-string">&#x27;species&#x27;</span>).<span class="hljs-built_in">sum</span>()) <span class="hljs-comment"># 单分组统计</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;-&#x27;</span> * <span class="hljs-number">40</span>)<br><span class="hljs-built_in">print</span>(data.groupby(by=[<span class="hljs-string">&#x27;species&#x27;</span>, <span class="hljs-string">&#x27;petal_width&#x27;</span>]).<span class="hljs-built_in">sum</span>()) <span class="hljs-comment"># 多分组统计</span><br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_7cb2eb9d739f181a31ac8e3853c7684d.png"></p><blockquote><p>分组并按照指定的列进行统计</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(data.groupby(by=<span class="hljs-string">&quot;species&quot;</span>)[<span class="hljs-string">&#x27;petal_width&#x27;</span>].<span class="hljs-built_in">sum</span>())<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;-&quot;</span> * <span class="hljs-number">50</span>)<br><span class="hljs-built_in">print</span>(data[<span class="hljs-string">&#x27;species&#x27;</span>].unique())<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;-&quot;</span> * <span class="hljs-number">50</span>)<br><span class="hljs-built_in">print</span>(data[[<span class="hljs-string">&#x27;petal_width&#x27;</span>, <span class="hljs-string">&#x27;species&#x27;</span>]].groupby(by=<span class="hljs-string">&quot;species&quot;</span>).<span class="hljs-built_in">sum</span>())<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;-&quot;</span> * <span class="hljs-number">50</span>)<br><span class="hljs-built_in">print</span>(data.loc[:, [<span class="hljs-string">&#x27;species&#x27;</span>, <span class="hljs-string">&#x27;petal_width&#x27;</span>]].groupby(<span class="hljs-string">&#x27;species&#x27;</span>).<span class="hljs-built_in">sum</span>())<br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_c2fb408eaa019daf70b066379bfc73c8.png"></p><blockquote><p>对分组数据进行迭代</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> name, age <span class="hljs-keyword">in</span> data.groupby(<span class="hljs-string">&#x27;species&#x27;</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;name&quot;</span>)<br>    <span class="hljs-built_in">print</span>(name)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;-&#x27;</span> * <span class="hljs-number">60</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;age&quot;</span>)<br>    <span class="hljs-built_in">print</span>(age.head(n=<span class="hljs-number">3</span>))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;*&quot;</span> * <span class="hljs-number">60</span>)<br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_fdfe0d5e40e775b5c3baed6a88102df7.png"></p><blockquote><p>多分组数据进行分析</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> (key1, key2), group <span class="hljs-keyword">in</span> data.groupby(by=[<span class="hljs-string">&#x27;species&#x27;</span>, <span class="hljs-string">&#x27;petal_width&#x27;</span>]):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;1&quot;</span> * <span class="hljs-number">60</span>)<br>    <span class="hljs-built_in">print</span>(key1)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;2&quot;</span> * <span class="hljs-number">60</span>)<br>    <span class="hljs-built_in">print</span>(key2)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;3&quot;</span> * <span class="hljs-number">60</span>)<br>    <span class="hljs-built_in">print</span>(group.head(n=<span class="hljs-number">2</span>))<br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_018d68b5bbf37628e580670e6840958d.png"></p><h4 id="对分组的某列或多列使用聚合函数（-agg-函数）"><a href="#对分组的某列或多列使用聚合函数（-agg-函数）" class="headerlink" title="对分组的某列或多列使用聚合函数（**agg()**函数）"></a>对分组的某列或多列使用聚合函数（**agg()**函数）</h4><p>Python也可以实现像SQL中的分组聚合运算操作，主要通过groupby()函数与agg()函数实现。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><br>dataset = sns.get_dataset_names()<br><span class="hljs-built_in">print</span>(dataset)<br><span class="hljs-comment">#[&#x27;anagrams&#x27;, &#x27;anscombe&#x27;, &#x27;attention&#x27;, &#x27;brain_networks&#x27;, &#x27;car_crashes&#x27;, &#x27;diamonds&#x27;, &#x27;dots&#x27;, &#x27;dowjones&#x27;, &#x27;exercise&#x27;, &#x27;flights&#x27;, &#x27;fmri&#x27;, &#x27;geyser&#x27;, &#x27;glue&#x27;, &#x27;healthexp&#x27;, &#x27;iris&#x27;, &#x27;mpg&#x27;, &#x27;penguins&#x27;, &#x27;planets&#x27;, &#x27;seaice&#x27;, &#x27;taxis&#x27;, &#x27;tips&#x27;, &#x27;titanic&#x27;]</span><br><span class="hljs-comment"># 使用seaborn中的mpg数据集</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>pandas</category>
      
    </categories>
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RNA速率</title>
    <link href="/2024/05/31/RNA%E9%80%9F%E7%8E%87/"/>
    <url>/2024/05/31/RNA%E9%80%9F%E7%8E%87/</url>
    
    <content type="html"><![CDATA[<h2 id="RNA速率分析"><a href="#RNA速率分析" class="headerlink" title="RNA速率分析"></a>RNA速率分析</h2><blockquote><p>部分代码来自微信公众号：KS科研与服务</p></blockquote><h3 id="R语言版本"><a href="#R语言版本" class="headerlink" title="R语言版本"></a>R语言版本</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># sudo apt-get install libboost-filesystem-dev</span><br><span class="hljs-comment"># sudo apt-get install libboost-system-dev</span><br><span class="hljs-comment">#library(velocyto.R)</span><br>library<span class="hljs-punctuation">(</span>pcaMethods<span class="hljs-punctuation">,</span>lib.loc <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;/root/wangje/miniconda3/lib/R/library&#x27;</span><span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>velocyto.R<span class="hljs-punctuation">,</span>lib.loc <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;/root/wangje/R/x86_64-conda-linux-gnu-library/4.2&#x27;</span><span class="hljs-punctuation">)</span><br><span class="hljs-comment"># remotes::install_github(&quot;satijalab/seurat-wrappers&quot;)</span><br>library<span class="hljs-punctuation">(</span>SeuratWrappers<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>Seurat<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>dplyr<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>ggplot2<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>SCP<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>dittoSeq<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>qs<span class="hljs-punctuation">)</span><br>set.seed<span class="hljs-punctuation">(</span><span class="hljs-number">123</span><span class="hljs-punctuation">)</span><br>stewd<span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;/root/wangje/Project/&#x27;</span><span class="hljs-punctuation">)</span><br><span class="hljs-comment">###读入数据*************************************************************</span><br>scRNA <span class="hljs-operator">&lt;-</span> qread<span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;./test.qs&#x27;</span><span class="hljs-punctuation">)</span><br>scRNA<br><span class="hljs-comment"># An object of class Seurat</span><br><span class="hljs-comment"># 41071 features across 14846 samples within 3 assays</span><br><span class="hljs-comment"># Active assay: RNA (37071 features, 2000 variable features)</span><br><span class="hljs-comment">#  2 layers present: counts, data</span><br><span class="hljs-comment">#  2 other assays present: scVIcorrected, ComBatcorrected</span><br><span class="hljs-comment">#  13 dimensional reductions calculated: BBKNNpca, BBKNNUMAP2D, BBKNNUMAP3D,</span><br><br>DefaultAssay<span class="hljs-punctuation">(</span>scRNA<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-string">&#x27;RNA&#x27;</span><br>Idents<span class="hljs-punctuation">(</span>scRNA<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> scRNA<span class="hljs-operator">$</span>celltype2<br><br><span class="hljs-comment">### 加载loom文件********************************************************</span><br>ldat <span class="hljs-operator">&lt;-</span> ReadVelocity<span class="hljs-punctuation">(</span>file <span class="hljs-operator">=</span> <span class="hljs-string">&quot;~/data_analysis/RNA速率/uterus.loom&quot;</span><span class="hljs-punctuation">)</span><br><span class="hljs-built_in">names</span><span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> ldat<span class="hljs-punctuation">)</span><br><span class="hljs-comment"># &quot;spliced&quot;   &quot;unspliced&quot; &quot;ambiguous&quot;</span><br>lapply<span class="hljs-punctuation">(</span><span class="hljs-built_in">names</span><span class="hljs-punctuation">(</span>ldat<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>FUN <span class="hljs-operator">=</span> <span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">)</span>head<span class="hljs-punctuation">(</span>colnames<span class="hljs-punctuation">(</span>ldat<span class="hljs-punctuation">[[</span>x<span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><span class="hljs-comment"># [[1]]</span><br><span class="hljs-comment"># [1] &quot;CJME_0707:AAACATCGAGTCACTAAAGACGGAx&quot; &quot;CJME_0707:AAACATCGAACGCTTACGAACTTAx&quot; &quot;CJME_0707:AAACATCGAATGTTGCACAGCAGAx&quot;</span><br><span class="hljs-comment"># [4] &quot;CJME_0707:AAACATCGAGCACCTCGCGAGTAAx&quot; &quot;CJME_0707:AAACATCGAACTCACCCCGACAACx&quot; &quot;CJME_0707:AAACATCGAGCAGGAAAATGTTGCx&quot;</span><br><br><span class="hljs-comment"># [[2]]</span><br><span class="hljs-comment"># [1] &quot;CJME_0707:AAACATCGAGTCACTAAAGACGGAx&quot; &quot;CJME_0707:AAACATCGAACGCTTACGAACTTAx&quot; &quot;CJME_0707:AAACATCGAATGTTGCACAGCAGAx&quot;</span><br><span class="hljs-comment"># [4] &quot;CJME_0707:AAACATCGAGCACCTCGCGAGTAAx&quot; &quot;CJME_0707:AAACATCGAACTCACCCCGACAACx&quot; &quot;CJME_0707:AAACATCGAGCAGGAAAATGTTGCx&quot;</span><br><br><span class="hljs-comment"># [[3]]</span><br><span class="hljs-comment"># [1] &quot;CJME_0707:AAACATCGAGTCACTAAAGACGGAx&quot; &quot;CJME_0707:AAACATCGAACGCTTACGAACTTAx&quot; &quot;CJME_0707:AAACATCGAATGTTGCACAGCAGAx&quot;</span><br><span class="hljs-comment"># [4] &quot;CJME_0707:AAACATCGAGCACCTCGCGAGTAAx&quot; &quot;CJME_0707:AAACATCGAACTCACCCCGACAACx&quot; &quot;CJME_0707:AAACATCGAGCAGGAAAATGTTGCx&quot;</span><br>head<span class="hljs-punctuation">(</span>rownames<span class="hljs-punctuation">(</span>scRNA<span class="hljs-operator">@</span>meta.data<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><span class="hljs-comment"># [1] &quot;CJME_0707_TGGAACAAGAGCTGAACTGGCATA&quot; &quot;CJME_0707_AAGAGATCCACTTCGAATCATTCC&quot; &quot;CJME_0707_AATCCGTCAATCCGTCCAACCACA&quot; &quot;CJME_0707_ACAAGCTACGACACACCAACCACA&quot;</span><br><span class="hljs-comment"># [5] &quot;CJME_0707_ACCACTGTACAGCAGATATCAGCA&quot; &quot;CJME_0707_ACCACTGTTGGCTTCACACTTCGA&quot;</span><br>       <br><span class="hljs-comment">#两个数据集的cell id不同，为了下面的数据合并，需要将两个数据集的id修改成一致</span><br><span class="hljs-keyword">for</span> <span class="hljs-punctuation">(</span>i <span class="hljs-keyword">in</span> <span class="hljs-built_in">names</span><span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> ldat<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br> assay <span class="hljs-operator">&lt;-</span> ldat<span class="hljs-punctuation">[[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><br> colnames<span class="hljs-punctuation">(</span>assay<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> gsub<span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;:&#x27;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&#x27;_&#x27;</span><span class="hljs-punctuation">,</span> colnames<span class="hljs-punctuation">(</span>assay<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br> colnames<span class="hljs-punctuation">(</span>assay<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> gsub<span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;x&#x27;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&#x27;&#x27;</span><span class="hljs-punctuation">,</span> colnames<span class="hljs-punctuation">(</span>assay<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br> colnames<span class="hljs-punctuation">(</span>assay<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> gsub<span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;-&#x27;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&#x27;_&#x27;</span><span class="hljs-punctuation">,</span> colnames<span class="hljs-punctuation">(</span>assay<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br> assay <span class="hljs-operator">&lt;-</span> assay<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span>colnames<span class="hljs-punctuation">(</span>scRNA<span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br> scRNA<span class="hljs-punctuation">[[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> CreateAssayObject<span class="hljs-punctuation">(</span>counts <span class="hljs-operator">=</span> assay<span class="hljs-punctuation">)</span><br> <span class="hljs-punctuation">&#125;</span>       <br>tail<span class="hljs-punctuation">(</span>colnames<span class="hljs-punctuation">(</span>scRNA<span class="hljs-operator">@</span>meta.data<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><span class="hljs-comment">#[1] &quot;nCount_spliced&quot;     &quot;nFeature_spliced&quot;   &quot;nCount_unspliced&quot;   &quot;nFeature_unspliced&quot; &quot;nCount_ambiguous&quot;   &quot;nFeature_ambiguous&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_23bda54f50cbb4ca07a0066500da6feb.png"></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">##运行RNA速率</span><br>sce_Velocity <span class="hljs-operator">&lt;-</span> RunVelocity<span class="hljs-punctuation">(</span>object <span class="hljs-operator">=</span> scRNA<span class="hljs-punctuation">,</span> <span class="hljs-comment">#seurat对象，但是包含我们前面整合的RNA速率loom</span><br>                            deltaT <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span><br>                            kCells <span class="hljs-operator">=</span> <span class="hljs-number">25</span><span class="hljs-punctuation">,</span><br>                            reduction <span class="hljs-operator">=</span> <span class="hljs-string">&quot;scVIUMAP2D&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">#降维信息                        </span><br>                            fit.quantile <span class="hljs-operator">=</span> <span class="hljs-number">0.02</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_516574b7e00bd1af09a85d5e0cc2d5d6.png"></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs R"> emb <span class="hljs-operator">=</span> Embeddings<span class="hljs-punctuation">(</span>object <span class="hljs-operator">=</span> scRNA<span class="hljs-punctuation">,</span> reduction <span class="hljs-operator">=</span> <span class="hljs-string">&quot;scVIUMAP2D&quot;</span><span class="hljs-punctuation">)</span><br> p <span class="hljs-operator">&lt;-</span> DimPlot<span class="hljs-punctuation">(</span>scRNA<span class="hljs-punctuation">,</span>reduction<span class="hljs-operator">=</span><span class="hljs-string">&quot;scVIUMAP2D&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span>scale_color_manual<span class="hljs-punctuation">(</span>values <span class="hljs-operator">=</span> dittoColors<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span>theme_blank<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br> colors <span class="hljs-operator">&lt;-</span> as.list<span class="hljs-punctuation">(</span>ggplot_build<span class="hljs-punctuation">(</span>p<span class="hljs-punctuation">)</span><span class="hljs-operator">$</span>data<span class="hljs-punctuation">[[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-operator">$</span>colour<span class="hljs-punctuation">)</span><span class="hljs-comment">#提取细胞颜色</span><br> <span class="hljs-built_in">names</span><span class="hljs-punctuation">(</span>colors<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> rownames<span class="hljs-punctuation">(</span>emb<span class="hljs-punctuation">)</span><span class="hljs-comment">#将颜色与细胞坐标匹配</span><br> <span class="hljs-comment">#定义一个函数，用来添加cell type名称,实质是获取细胞坐标，计算每个组的中心点 </span><br> label_clusters <span class="hljs-operator">&lt;-</span> <span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span>labels<span class="hljs-punctuation">,</span> coords<span class="hljs-punctuation">,</span> ...<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br> df <span class="hljs-operator">&lt;-</span> tibble<span class="hljs-punctuation">(</span>label <span class="hljs-operator">=</span> labels<span class="hljs-punctuation">,</span> x <span class="hljs-operator">=</span> coords<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> coords<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><br> df <span class="hljs-operator">&lt;-</span> df <span class="hljs-operator">%&gt;%</span><br> group_by<span class="hljs-punctuation">(</span>label<span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span><br> summarize<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> median<span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> median<span class="hljs-punctuation">(</span>y<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br> text<span class="hljs-punctuation">(</span>df<span class="hljs-operator">$</span>x<span class="hljs-punctuation">,</span> df<span class="hljs-operator">$</span>y<span class="hljs-punctuation">,</span> df<span class="hljs-operator">$</span>label<span class="hljs-punctuation">,</span> ...<span class="hljs-punctuation">)</span><br> <span class="hljs-punctuation">&#125;</span><br><span class="hljs-comment">#绘图</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>scRNA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Seurat聚类</title>
    <link href="/2024/05/31/Seurat%E8%81%9A%E7%B1%BB/"/>
    <url>/2024/05/31/Seurat%E8%81%9A%E7%B1%BB/</url>
    
    <content type="html"><![CDATA[<h2 id="Seurat-CCA进行聚类"><a href="#Seurat-CCA进行聚类" class="headerlink" title="Seurat CCA进行聚类"></a>Seurat CCA进行聚类</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs R">library<span class="hljs-punctuation">(</span>Seurat<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>dplyr<span class="hljs-punctuation">)</span><br>librar<span class="hljs-punctuation">(</span>qs<span class="hljs-punctuation">)</span><br>fileNames <span class="hljs-operator">&lt;-</span> <span class="hljs-string">&quot;./test.qs&quot;</span><br>scRNAlist <span class="hljs-operator">&lt;-</span> qread<span class="hljs-punctuation">(</span>fileName<span class="hljs-punctuation">)</span><br><span class="hljs-comment">#seurat list标准化及高变基因筛选</span><br><span class="hljs-keyword">for</span> <span class="hljs-punctuation">(</span>i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>obj_list<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>    obj_list<span class="hljs-punctuation">[[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> NormalizeData<span class="hljs-punctuation">(</span>obj_list<span class="hljs-punctuation">[[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> verbose <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span><br>    obj_list<span class="hljs-punctuation">[[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> FindVariableFeatures<span class="hljs-punctuation">(</span>obj_list<span class="hljs-punctuation">[[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> selection.method <span class="hljs-operator">=</span> <span class="hljs-string">&quot;vst&quot;</span><span class="hljs-punctuation">,</span> <br>        nfeatures <span class="hljs-operator">=</span> <span class="hljs-number">2000</span><span class="hljs-punctuation">,</span> verbose <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br><span class="hljs-comment">#find anchor</span><br>anchors <span class="hljs-operator">=</span> FindIntegrationAnchors<span class="hljs-punctuation">(</span>obj_list<span class="hljs-punctuation">,</span> dims<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-punctuation">)</span><br>integrated <span class="hljs-operator">=</span> IntegrateData<span class="hljs-punctuation">(</span>anchors<span class="hljs-punctuation">,</span> dims<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-punctuation">)</span><br><br>DefaultAssay<span class="hljs-punctuation">(</span>integrated<span class="hljs-punctuation">)</span><span class="hljs-operator">&lt;-</span> <span class="hljs-string">&quot;integrated&quot;</span><br><br>integrated <span class="hljs-operator">&lt;-</span> ScaleData<span class="hljs-punctuation">(</span>integrated<span class="hljs-punctuation">)</span><br>integrated <span class="hljs-operator">&lt;-</span> RunPCA<span class="hljs-punctuation">(</span>integrated<span class="hljs-punctuation">,</span> npcs<span class="hljs-operator">=</span><span class="hljs-number">40</span><span class="hljs-punctuation">)</span><br>integrated <span class="hljs-operator">&lt;-</span> RunUMAP<span class="hljs-punctuation">(</span>integrated<span class="hljs-punctuation">,</span> reduction<span class="hljs-operator">=</span><span class="hljs-string">&quot;pca&quot;</span><span class="hljs-punctuation">,</span>dims<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">20</span><span class="hljs-punctuation">)</span><br><br>integrated <span class="hljs-operator">=</span> FindNeighbors<span class="hljs-punctuation">(</span>integrated<span class="hljs-punctuation">,</span> dims<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">20</span><span class="hljs-punctuation">)</span><br>integrated <span class="hljs-operator">=</span> FindClusters<span class="hljs-punctuation">(</span>integrated<span class="hljs-punctuation">,</span> resolution <span class="hljs-operator">=</span> <span class="hljs-number">0.3</span><span class="hljs-punctuation">)</span><br>folder <span class="hljs-operator">&lt;-</span> <span class="hljs-string">&quot;./&quot;</span><br>version <span class="hljs-operator">&lt;-</span> <span class="hljs-string">&quot;SeuratV4&quot;</span><br>pdf<span class="hljs-punctuation">(</span>paste0<span class="hljs-punctuation">(</span>folder<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;_&quot;</span><span class="hljs-punctuation">,</span>version<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;_clusters.pdf&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>height<span class="hljs-operator">=</span><span class="hljs-number">8.5</span><span class="hljs-punctuation">,</span>width<span class="hljs-operator">=</span><span class="hljs-number">11</span><span class="hljs-punctuation">)</span><br>DimPlot<span class="hljs-punctuation">(</span>integrated<span class="hljs-punctuation">,</span> pt.size<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span>label<span class="hljs-operator">=</span><span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><br>dev.off<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><br>pdf<span class="hljs-punctuation">(</span>paste0<span class="hljs-punctuation">(</span>folder<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;_&quot;</span><span class="hljs-punctuation">,</span>version<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;_batch.pdf&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>height<span class="hljs-operator">=</span><span class="hljs-number">8.5</span><span class="hljs-punctuation">,</span>width<span class="hljs-operator">=</span><span class="hljs-number">11</span><span class="hljs-punctuation">)</span><br>DimPlot<span class="hljs-punctuation">(</span>integrated<span class="hljs-punctuation">,</span> pt.size<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span>group.by<span class="hljs-operator">=</span><span class="hljs-string">&quot;orig.ident&quot;</span><span class="hljs-punctuation">,</span>label<span class="hljs-operator">=</span><span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><br>dev.off<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><span class="hljs-comment">#save file</span><br>qsave<span class="hljs-punctuation">(</span>integrated<span class="hljs-punctuation">,</span> file<span class="hljs-operator">=</span>paste0<span class="hljs-punctuation">(</span>folder<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;_&quot;</span><span class="hljs-punctuation">,</span>version<span class="hljs-punctuation">,</span><span class="hljs-string">&quot;.qs&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>scRNA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>javascript基础01</title>
    <link href="/2024/05/30/javascript%E5%9F%BA%E7%A1%8001/"/>
    <url>/2024/05/30/javascript%E5%9F%BA%E7%A1%8001/</url>
    
    <content type="html"><![CDATA[<h1 id="javascript中的基础数据类型01"><a href="#javascript中的基础数据类型01" class="headerlink" title="javascript中的基础数据类型01"></a>javascript中的基础数据类型01</h1><h2 id="数值"><a href="#数值" class="headerlink" title="数值"></a>数值</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>javascript中数值只有一种类型，没有细分出浮点型和整型。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> num1 = <span class="hljs-number">123</span><br><span class="hljs-keyword">let</span>  num2 = <span class="hljs-number">123.5</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">typeof</span> num1,<span class="hljs-string">&#x27;\t&#x27;</span>,<span class="hljs-keyword">typeof</span> num2)<br><span class="hljs-comment">//输出内容：number number</span><br></code></pre></td></tr></table></figure><h3 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h3><h4 id="算术运算"><a href="#算术运算" class="headerlink" title="算术运算"></a>算术运算</h4><blockquote><p>注意区分++a 和 a++的区别，一个是先运算再赋值，一个是先赋值再运算。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"># 加 + 减 - 乘 * 除 / 求余 % 自增++ 自减 --<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num1 + num2)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num1 - num2)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num1 * num2)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num1 / num2)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num1 % num2)<br><br><span class="hljs-comment">//246.5</span><br><span class="hljs-comment">//-0.5</span><br><span class="hljs-comment">//15190.5</span><br><span class="hljs-comment">//0.9959514170040485</span><br><span class="hljs-comment">//123</span><br></code></pre></td></tr></table></figure><h4 id="比较运算"><a href="#比较运算" class="headerlink" title="比较运算"></a>比较运算</h4><ul><li>等于 (<code>==</code>)：值相等</li><li>全等 (<code>===</code>) : 值相同，同时类型也相同</li><li>不等于 (<code>!=</code>)：值不相等</li><li>不全等 (<code>!==</code>)：值不相同同时类型也不相同</li><li>大于 (<code>&gt;</code>)</li><li>小于 (<code>&lt;</code>)</li><li>大于等于 (<code>&gt;=</code>)</li><li>小于等于 (<code>&lt;=</code>)</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> num3 = <span class="hljs-number">123</span><br><span class="hljs-keyword">let</span> num4 = <span class="hljs-number">123.00</span><br>result = num3 === num4 ? <span class="hljs-string">&quot;全等&quot;</span>:<span class="hljs-string">&quot;不全等&quot;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result)<br><span class="hljs-comment">// 全等</span><br></code></pre></td></tr></table></figure><h4 id="赋值运算"><a href="#赋值运算" class="headerlink" title="赋值运算"></a>赋值运算</h4><ul><li>赋值 (<code>=</code>)</li><li>加等于 (<code>+=</code>)</li><li>减等于 (<code>-=</code>)</li><li>乘等于 (<code>*=</code>)</li><li>除等于 (<code>/=</code>)</li><li>取余等于 (<code>%=</code>)</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num1 += num1)<br><span class="hljs-comment">//246</span><br></code></pre></td></tr></table></figure><h4 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h4><ul><li>Number()构造函数，<code>Number</code> 构造函数也可以用来将其他类型的值转换为数值</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str1 = <span class="hljs-string">&quot;BSS&quot;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Number</span>(str1)) <span class="hljs-comment">// NaN</span><br><span class="hljs-keyword">let</span> str2 = <span class="hljs-string">&quot;1234n&quot;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Number</span>(str2)) <span class="hljs-comment">// NaN</span><br><span class="hljs-keyword">let</span> <span class="hljs-title class_">Num1</span> = <span class="hljs-string">&quot;123&quot;</span> <br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Number</span>(<span class="hljs-title class_">Num1</span>)) <span class="hljs-comment">// 123</span><br><span class="hljs-keyword">let</span> <span class="hljs-title class_">Num2</span> = <span class="hljs-number">123213423414123432n</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Number</span>(<span class="hljs-title class_">Num2</span>)) <span class="hljs-comment">//123213423414123420</span><br></code></pre></td></tr></table></figure><ul><li><code>parseInt()</code>和<code>parseFloat()</code>进行字符串到整数或浮点数的转换，注意如果字符串开头不是数字，则直接返回NaN，不会对下面的数据进行检查。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> <span class="hljs-title class_">Str1</span> = <span class="hljs-string">&quot;12312334ab&quot;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-built_in">parseInt</span>(<span class="hljs-title class_">Str1</span>)) <span class="hljs-comment">//12312334</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-built_in">parseFloat</span>(<span class="hljs-title class_">Str1</span>)) <span class="hljs-comment">//12312334</span><br><br><span class="hljs-keyword">let</span> <span class="hljs-title class_">Str2</span> = <span class="hljs-string">&quot;ab12312334&quot;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-built_in">parseInt</span>(<span class="hljs-title class_">Str2</span>)) <span class="hljs-comment">//NaN</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-built_in">parseFloat</span>(<span class="hljs-title class_">Str2</span>)) <span class="hljs-comment">//NaN</span><br></code></pre></td></tr></table></figure><h4 id="数学函数"><a href="#数学函数" class="headerlink" title="数学函数"></a>数学函数</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(-<span class="hljs-number">1</span>)) <span class="hljs-comment">//1</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">exp</span>(<span class="hljs-number">10</span>)) <span class="hljs-comment">//22026.465794806718</span><br><span class="hljs-comment">//Math.round()等</span><br></code></pre></td></tr></table></figure><h4 id="其他函数"><a href="#其他函数" class="headerlink" title="其他函数"></a>其他函数</h4><ul><li><code>toString()</code> 主要是用于将数字转换为字符串（可以是任何进制），而 <code>toFixed()</code> 是用于将数字格式化为具有指定小数位数的字符串。</li><li><strong>四舍五入</strong>：<code>toString()</code> 不会进行四舍五入，它只是简单地将数字转换为字符串。而 <code>toFixed()</code> 会根据指定的小数位数对数字进行四舍五入。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> <span class="hljs-variable constant_">H1</span> = <span class="hljs-number">123</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable constant_">H1</span>.<span class="hljs-title function_">toString</span>()) <span class="hljs-comment">//123</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable constant_">H1</span>.<span class="hljs-title function_">toFixed</span>()) <span class="hljs-comment">//123</span><br><br><span class="hljs-keyword">let</span> num = <span class="hljs-number">123</span>;  <br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num.<span class="hljs-title function_">toString</span>()); <span class="hljs-comment">// 输出: &quot;123&quot;  </span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num.<span class="hljs-title function_">toString</span>(<span class="hljs-number">2</span>)); <span class="hljs-comment">// 输出: &quot;1111011&quot; (二进制)  </span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num.<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>)); <span class="hljs-comment">// 输出: &quot;7b&quot; (十六进制)</span><br><br><span class="hljs-keyword">let</span> num = <span class="hljs-number">123.456789</span>;  <br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num.<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">2</span>)); <span class="hljs-comment">// 输出: &quot;123.46&quot;  </span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num.<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">4</span>)); <span class="hljs-comment">// 输出: &quot;123.4568&quot;</span><br></code></pre></td></tr></table></figure><h2 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h2><p>在 JavaScript 中，你可以选择单引号（<code>&#39;</code>）、双引号（<code>&quot;</code>）或反引号（&#96;&#96;&#96;）来包裹字符串。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> single = <span class="hljs-string">&#x27;单引号&#x27;</span><br><span class="hljs-keyword">const</span> double = <span class="hljs-string">&quot;双引号&quot;</span><br><span class="hljs-keyword">const</span> backtick = <span class="hljs-string">`反引号`</span><br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(single)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(double)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(backtick)<br></code></pre></td></tr></table></figure><h3 id="模版字面量"><a href="#模版字面量" class="headerlink" title="模版字面量"></a>模版字面量</h3><p>javascript中也有类似shell脚本中的模版字面量，使用${}</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> <span class="hljs-title class_">Str3</span> = <span class="hljs-string">&quot;ABC&quot;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`this is a <span class="hljs-subst">$&#123;Str3&#125;</span>`</span>) <span class="hljs-comment">//this is a ABC</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`this result is <span class="hljs-subst">$&#123;(<span class="hljs-number">1</span>+<span class="hljs-number">2</span>+<span class="hljs-string">&quot;123&quot;</span>)&#125;</span>`</span>) <span class="hljs-comment">// this result is 3123</span><br></code></pre></td></tr></table></figure><h3 id="大小写转换"><a href="#大小写转换" class="headerlink" title="大小写转换"></a>大小写转换</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Str3</span>.<span class="hljs-title function_">toLowerCase</span>()) <span class="hljs-comment">//abc</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Str3</span>.<span class="hljs-title function_">toUpperCase</span>()) <span class="hljs-comment">//ABC</span><br></code></pre></td></tr></table></figure><h3 id="字符串长度"><a href="#字符串长度" class="headerlink" title="字符串长度"></a>字符串长度</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Str3</span>.<span class="hljs-property">length</span>) <span class="hljs-comment">//3</span><br></code></pre></td></tr></table></figure><h3 id="字符串分割"><a href="#字符串分割" class="headerlink" title="字符串分割"></a>字符串分割</h3><p>字符串切割返回的结果是数据类型。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Str3</span>.<span class="hljs-title function_">split</span>(<span class="hljs-string">&quot;&quot;</span>)) <span class="hljs-comment">//[ &#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27; ] </span><br><span class="hljs-keyword">let</span> <span class="hljs-title class_">Str4</span> = <span class="hljs-string">&quot;A|B|C&quot;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Str4</span>.<span class="hljs-title function_">split</span>(<span class="hljs-string">&quot;|&quot;</span>))<span class="hljs-comment">//[ &#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27; ] </span><br></code></pre></td></tr></table></figure><h3 id="字符串拼接"><a href="#字符串拼接" class="headerlink" title="字符串拼接"></a>字符串拼接</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Str3</span> + <span class="hljs-string">&#x27;_&#x27;</span>+  <span class="hljs-title class_">Str4</span>) <span class="hljs-comment">//ABC_A|B|C</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Str3</span>.<span class="hljs-title function_">concat</span>(<span class="hljs-title class_">Str4</span>)) <span class="hljs-comment">//ABCA|B|C</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Str3</span>.<span class="hljs-title function_">concat</span>(<span class="hljs-title class_">Str4</span>,<span class="hljs-title class_">Str4</span>,str1)) <span class="hljs-comment">//ABCA|B|CA|B|CBSS</span><br></code></pre></td></tr></table></figure><h3 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h3><ul><li><code>slice(start, end)</code>: 返回从 <code>start</code> 到 <code>end</code>（不包括 <code>end</code>）的字符串部分。</li><li><code>substring(start, end)</code>: 与 <code>slice()</code> 类似，但不接受负索引。</li><li><code>substr(start, length)</code>: 返回从 <code>start</code> 开始的，长度为 <code>length</code> 的字符串部分。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;Hello&quot;</span>;  <br><span class="hljs-keyword">let</span> firstChar = str[<span class="hljs-number">0</span>]; <span class="hljs-comment">// &quot;H&quot;</span><br><br><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;Hello, world!&quot;</span>;  <br><span class="hljs-keyword">let</span> sliced = str.<span class="hljs-title function_">slice</span>(<span class="hljs-number">7</span>, <span class="hljs-number">12</span>); <span class="hljs-comment">// &quot;world&quot;</span><br><br><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;Hello, world!&quot;</span>;  <br><span class="hljs-keyword">let</span> replaced = str.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&quot;world&quot;</span>, <span class="hljs-string">&quot;JavaScript&quot;</span>); <span class="hljs-comment">// &quot;Hello, JavaScript!&quot;</span><br></code></pre></td></tr></table></figure><h3 id="搜索"><a href="#搜索" class="headerlink" title="搜索"></a>搜索</h3><ul><li><code>indexOf(searchString, position)</code>: 返回指定字符串值在字符串中<strong>首次出现的位置</strong>，从指定的位置开始搜索。</li><li><code>lastIndexOf(searchString, position)</code>: 返回指定字符串值在字符串中<strong>最后出现的位置</strong>，从指定的位置开始反向搜索。</li><li><code>includes(searchString, position)</code>: 判断字符串是否包含指定的子串，返回布尔值。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> <span class="hljs-title class_">Str5</span> = <span class="hljs-string">&quot;hello world I use javascript&quot;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Str5</span>.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&quot;I&quot;</span>)) <span class="hljs-comment">// 12</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Str5</span>.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&quot;java&quot;</span>))<span class="hljs-comment">//18</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Str5</span>.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&quot;java&quot;</span>))<span class="hljs-comment">//true</span><br></code></pre></td></tr></table></figure><h3 id="字符串去除空格"><a href="#字符串去除空格" class="headerlink" title="字符串去除空格"></a>字符串去除空格</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> <span class="hljs-title class_">Str6</span> = <span class="hljs-string">&quot; ACD  &quot;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Str6</span>.<span class="hljs-title function_">trim</span>())<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Str6</span>.<span class="hljs-title function_">trimStart</span>())<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Str6</span>.<span class="hljs-title function_">trimEnd</span>())<br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_105e49d794f3fa840a32979b7314d708.png"> </p><h3 id="判断开头和结尾"><a href="#判断开头和结尾" class="headerlink" title="判断开头和结尾"></a>判断开头和结尾</h3><p>startsWith()和endsWith()返回布尔值</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Str5</span>.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">&quot;hello&quot;</span>))<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Str5</span>.<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">&quot;hello&quot;</span>))<br></code></pre></td></tr></table></figure><h2 id="布尔值"><a href="#布尔值" class="headerlink" title="布尔值"></a>布尔值</h2><p>javascript中的布尔值只有两个，分布是true和false，全是小写字母</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">if</span> (<span class="hljs-literal">true</span>)&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;test1&quot;</span>)<br>&#125; <span class="hljs-comment">//test1</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>javascript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>hdWGCNA中ModuleFeaturePlot分组进行绘图</title>
    <link href="/2024/05/30/hdWGCNA%E4%B8%ADModuleFeaturePlot%E5%88%86%E7%BB%84%E8%BF%9B%E8%A1%8C%E7%BB%98%E5%9B%BE-1/"/>
    <url>/2024/05/30/hdWGCNA%E4%B8%ADModuleFeaturePlot%E5%88%86%E7%BB%84%E8%BF%9B%E8%A1%8C%E7%BB%98%E5%9B%BE-1/</url>
    
    <content type="html"><![CDATA[<h2 id="hdWGCNA中ModuleFeaturePlot分组进行绘图"><a href="#hdWGCNA中ModuleFeaturePlot分组进行绘图" class="headerlink" title="hdWGCNA中ModuleFeaturePlot分组进行绘图"></a>hdWGCNA中ModuleFeaturePlot分组进行绘图</h2><h3 id="提取数据绘图"><a href="#提取数据绘图" class="headerlink" title="提取数据绘图"></a>提取数据绘图</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs R">plot_score <span class="hljs-operator">&lt;-</span> ModuleFeaturePlot<span class="hljs-punctuation">(</span><br>    scRNA<span class="hljs-punctuation">,</span><br>    reduction <span class="hljs-operator">=</span> <span class="hljs-string">&quot;umap&quot;</span><span class="hljs-punctuation">,</span><br>    features<span class="hljs-operator">=</span><span class="hljs-string">&#x27;hMEs&#x27;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment"># plot the hMEs</span><br>    order<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span><span class="hljs-comment"># order so the points with highest hMEs are on top</span><br>    raster <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">,</span><br>    ucell <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><br><span class="hljs-punctuation">)</span><br><span class="hljs-comment"># [1] &quot;M1&quot;</span><br><span class="hljs-comment"># [1] &quot;M2&quot;</span><br><span class="hljs-comment"># [1] &quot;M3&quot;</span><br><span class="hljs-comment"># [1] &quot;M4&quot;</span><br><span class="hljs-comment"># [1] &quot;M5&quot;</span><br><span class="hljs-comment"># [1] &quot;M6&quot;</span><br><span class="hljs-comment"># [1] &quot;M7&quot;</span><br><span class="hljs-comment"># [1] &quot;M8&quot;</span><br><span class="hljs-comment"># [1] &quot;M9&quot;</span><br></code></pre></td></tr></table></figure><p>查看输出结果plot_score的结构</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs R">str<span class="hljs-punctuation">(</span>plot_score<span class="hljs-punctuation">,</span>max.level<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p>存放绘图数据的位置：</p><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_cbdf0dd5f508cab46d4d67a75eb874dc.png"></p><p>查看数据格式</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs R">head<span class="hljs-punctuation">(</span>plot_score<span class="hljs-operator">$</span>M1<span class="hljs-operator">$</span>data<span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_74dac19c986cadaf9ed8bc54f50ba946.png"></p><p>数据格式中rowname是细胞barcode，可以根据barcode信息添加在数据中添加其他的分组信息，以Seurat对象中的seurat_clusters为例。</p><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_d8cb60099441f080ae4298f411f58569.png"></p><p>合并meta.data中的seurat_clusters和plot_score$M1$data数据</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># 提取ModuleFeaturePlot绘图数据</span><br>test_data <span class="hljs-operator">&lt;-</span> as.data.frame<span class="hljs-punctuation">(</span>plot_score<span class="hljs-operator">$</span>M1<span class="hljs-operator">$</span>data<span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> <br>tibble<span class="hljs-operator">::</span>rownames_to_column<span class="hljs-punctuation">(</span>var <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;cells&#x27;</span><span class="hljs-punctuation">)</span> <span class="hljs-comment">#提取数据，将rownames改成列信息</span><br>head<span class="hljs-punctuation">(</span>test_data<span class="hljs-punctuation">)</span><br><span class="hljs-comment">#                  cells    UMAP_1     UMAP_2       val</span><br><span class="hljs-comment"># 1 GCAACCGCACATGGTT-1_3 -3.200459 -11.816769 -21.05015</span><br><span class="hljs-comment"># 2 GTTTGGAGTCCCAAAT-1_3 -8.262880  -3.907730 -20.83909</span><br><span class="hljs-comment"># 3 CCTCACAAGTCGAATA-1_3 -8.832568  -3.866324 -20.35668</span><br><span class="hljs-comment"># 4 GACCGTGTCTTCCCAG-1_3 -6.792917   5.364767 -20.29601</span><br><span class="hljs-comment"># 5 TGCGGCATCGTGCAGC-1_3 -8.499278  -4.433219 -20.13161</span><br><span class="hljs-comment"># 6 GGCAGTCTCTGAGGCC-1_3 -8.477210  -3.853339 -20.11608</span><br><br><span class="hljs-comment"># 提取分组信息</span><br>group_data <span class="hljs-operator">&lt;-</span> as.data.frame<span class="hljs-punctuation">(</span>scRNA<span class="hljs-operator">@</span>meta.data<span class="hljs-punctuation">[</span><span class="hljs-string">&#x27;seurat_clusters&#x27;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> <br>tibble<span class="hljs-operator">::</span>rownames_to_column<span class="hljs-punctuation">(</span>var <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;cells&#x27;</span><span class="hljs-punctuation">)</span><br>head<span class="hljs-punctuation">(</span>group_data<span class="hljs-punctuation">)</span><br><span class="hljs-comment">#                  cells seurat_clusters</span><br><span class="hljs-comment"># 1 AAACCCAAGGGTGAAA-1_1               7</span><br><span class="hljs-comment"># 2 AAACCCAAGGTGATAT-1_1              12</span><br><span class="hljs-comment"># 3 AAACCCAGTGCAATGG-1_1               5</span><br><span class="hljs-comment"># 4 AAACCCAGTTGAGTCT-1_1               2</span><br><span class="hljs-comment"># 5 AAACCCATCAGTCTTT-1_1               0</span><br><span class="hljs-comment"># 6 AAACGAAAGAAGGCTC-1_1              13</span><br><br><span class="hljs-comment"># 合并绘图数据和分组信息</span><br>test_data <span class="hljs-operator">&lt;-</span> test_data <span class="hljs-operator">%&gt;%</span> dplyr<span class="hljs-operator">::</span>left_join<span class="hljs-punctuation">(</span>group_data<span class="hljs-punctuation">,</span>by<span class="hljs-operator">=</span><span class="hljs-string">&quot;cells&quot;</span><span class="hljs-punctuation">)</span><br>head<span class="hljs-punctuation">(</span>test_data<span class="hljs-punctuation">)</span><br><span class="hljs-comment">#                  cells    UMAP_1     UMAP_2       val seurat_clusters</span><br><span class="hljs-comment"># 1 GCAACCGCACATGGTT-1_3 -3.200459 -11.816769 -21.05015               1</span><br><span class="hljs-comment"># 2 GTTTGGAGTCCCAAAT-1_3 -8.262880  -3.907730 -20.83909               2</span><br><span class="hljs-comment"># 3 CCTCACAAGTCGAATA-1_3 -8.832568  -3.866324 -20.35668               2</span><br><span class="hljs-comment"># 4 GACCGTGTCTTCCCAG-1_3 -6.792917   5.364767 -20.29601               0</span><br><span class="hljs-comment"># 5 TGCGGCATCGTGCAGC-1_3 -8.499278  -4.433219 -20.13161               2</span><br><span class="hljs-comment"># 6 GGCAGTCTCTGAGGCC-1_3 -8.477210  -3.853339 -20.11608               2</span><br></code></pre></td></tr></table></figure><p>绘图</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># 设置颜色范围</span><br>restrict_range <span class="hljs-operator">&lt;-</span> <span class="hljs-literal">TRUE</span><br>plot_range <span class="hljs-operator">&lt;-</span> test_data<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&#x27;val&#x27;</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">%&gt;%</span> <span class="hljs-built_in">range</span><br><span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span>restrict_range<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span><span class="hljs-built_in">abs</span><span class="hljs-punctuation">(</span>plot_range<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-built_in">abs</span><span class="hljs-punctuation">(</span>plot_range<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>        plot_range<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-operator">-</span><span class="hljs-number">1</span> <span class="hljs-operator">*</span> plot_range<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><br>    <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-keyword">else</span> <span class="hljs-punctuation">&#123;</span><br>        plot_range<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-operator">-</span><span class="hljs-number">1</span> <span class="hljs-operator">*</span> plot_range<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><br>    <span class="hljs-punctuation">&#125;</span><br>    test_data<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&#x27;val&#x27;</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> ifelse<span class="hljs-punctuation">(</span>test_data<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&#x27;val&#x27;</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&gt;</span><br>        plot_range<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> plot_range<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> test_data<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&#x27;val&#x27;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><br>    test_data<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&#x27;val&#x27;</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> ifelse<span class="hljs-punctuation">(</span>test_data<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&#x27;val&#x27;</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;</span><br>        plot_range<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> plot_range<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> test_data<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&#x27;val&#x27;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br><br><span class="hljs-comment"># 绘图</span><br>test_data <span class="hljs-operator">%&gt;%</span> ggplot<span class="hljs-punctuation">(</span>aes_string<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;UMAP_1&#x27;</span><span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;UMAP_2&#x27;</span><span class="hljs-punctuation">,</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;val&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>        geom_point<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">0.1</span><span class="hljs-punctuation">,</span> alpha <span class="hljs-operator">=</span> <span class="hljs-number">0.6</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>        theme_classic<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> labs<span class="hljs-punctuation">(</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>        ggtitle<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;test Model&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> <br>        scale_color_gradient<span class="hljs-punctuation">(</span>low <span class="hljs-operator">=</span> <span class="hljs-string">&quot;grey95&quot;</span><span class="hljs-punctuation">,</span> high <span class="hljs-operator">=</span> <span class="hljs-string">&quot;red&quot;</span><span class="hljs-punctuation">,</span><br>                breaks <span class="hljs-operator">=</span> plot_range<span class="hljs-punctuation">,</span> labels <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;0&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;+&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>                guide <span class="hljs-operator">=</span> guide_colorbar<span class="hljs-punctuation">(</span>ticks <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">,</span><br>                barwidth <span class="hljs-operator">=</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> barheight <span class="hljs-operator">=</span> <span class="hljs-number">4</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-operator">+</span><br>facet_wrap<span class="hljs-punctuation">(</span>.<span class="hljs-operator">~</span>seurat_clusters<span class="hljs-punctuation">,</span>ncol <span class="hljs-operator">=</span> <span class="hljs-number">8</span><span class="hljs-punctuation">,</span>scales <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;free&#x27;</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_f5eeaa30c8d4668a513cac062c398843.png"></p><h3 id="修改原函数"><a href="#修改原函数" class="headerlink" title="修改原函数"></a>修改原函数</h3><p>对R包原绘图函数进行修改，修该如下：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><code class="hljs R">ModuleFeaturePlot_02 <span class="hljs-operator">&lt;-</span> <span class="hljs-keyword">function</span> <span class="hljs-punctuation">(</span>seurat_obj<span class="hljs-punctuation">,</span> module_names <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span> wgcna_name <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span><br>    reduction <span class="hljs-operator">=</span> <span class="hljs-string">&quot;umap&quot;</span><span class="hljs-punctuation">,</span> features <span class="hljs-operator">=</span> <span class="hljs-string">&quot;hMEs&quot;</span><span class="hljs-punctuation">,</span> order_points <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span><br>    restrict_range <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> point_size <span class="hljs-operator">=</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> alpha <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> label_legend <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">,</span><br>    ucell <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">,</span> raster <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">,</span> raster_dpi <span class="hljs-operator">=</span> <span class="hljs-number">500</span><span class="hljs-punctuation">,</span> raster_scale <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span><br>    plot_ratio <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> title <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> split.by<span class="hljs-operator">=</span><span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span>ncol<span class="hljs-operator">=</span><span class="hljs-number">8</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span><span class="hljs-built_in">is.null</span><span class="hljs-punctuation">(</span>wgcna_name<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>        wgcna_name <span class="hljs-operator">&lt;-</span> seurat_obj<span class="hljs-operator">@</span>misc<span class="hljs-operator">$</span>active_wgcna<br>    <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span>features <span class="hljs-operator">==</span> <span class="hljs-string">&quot;hMEs&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>        MEs <span class="hljs-operator">&lt;-</span> GetMEs<span class="hljs-punctuation">(</span>seurat_obj<span class="hljs-punctuation">,</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> wgcna_name<span class="hljs-punctuation">)</span><br>    <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span>features <span class="hljs-operator">==</span> <span class="hljs-string">&quot;MEs&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>        MEs <span class="hljs-operator">&lt;-</span> GetMEs<span class="hljs-punctuation">(</span>seurat_obj<span class="hljs-punctuation">,</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">,</span> wgcna_name<span class="hljs-punctuation">)</span><br>    <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span>features <span class="hljs-operator">==</span> <span class="hljs-string">&quot;scores&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>        MEs <span class="hljs-operator">&lt;-</span> GetModuleScores<span class="hljs-punctuation">(</span>seurat_obj<span class="hljs-punctuation">,</span> wgcna_name<span class="hljs-punctuation">)</span><br>    <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span>features <span class="hljs-operator">==</span> <span class="hljs-string">&quot;average&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>        MEs <span class="hljs-operator">&lt;-</span> GetAvgModuleExpr<span class="hljs-punctuation">(</span>seurat_obj<span class="hljs-punctuation">,</span> wgcna_name<span class="hljs-punctuation">)</span><br>        restrict_range <span class="hljs-operator">&lt;-</span> <span class="hljs-literal">FALSE</span><br>    <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-keyword">else</span> <span class="hljs-punctuation">(</span>stop<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Invalid feature selection. Valid choices: hMEs, MEs, scores, average&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span>ucell<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>        restrict_range <span class="hljs-operator">&lt;-</span> <span class="hljs-literal">FALSE</span><br>    <span class="hljs-punctuation">&#125;</span><br>    modules <span class="hljs-operator">&lt;-</span> GetModules<span class="hljs-punctuation">(</span>seurat_obj<span class="hljs-punctuation">,</span> wgcna_name<span class="hljs-punctuation">)</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span><span class="hljs-built_in">is.null</span><span class="hljs-punctuation">(</span>module_names<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>        module_names <span class="hljs-operator">&lt;-</span> levels<span class="hljs-punctuation">(</span>modules<span class="hljs-operator">$</span>module<span class="hljs-punctuation">)</span><br>        module_names <span class="hljs-operator">&lt;-</span> module_names<span class="hljs-punctuation">[</span>module_names <span class="hljs-operator">!=</span> <span class="hljs-string">&quot;grey&quot;</span><span class="hljs-punctuation">]</span><br>    <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-keyword">if</span><span class="hljs-punctuation">(</span><span class="hljs-built_in">is.null</span><span class="hljs-punctuation">(</span>split.by<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>            umap <span class="hljs-operator">&lt;-</span> seurat_obj<span class="hljs-operator">@</span>reductions<span class="hljs-punctuation">[[</span>reduction<span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-operator">@</span>cell.embeddings<br>            x_name <span class="hljs-operator">&lt;-</span> colnames<span class="hljs-punctuation">(</span>umap<span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><br>            y_name <span class="hljs-operator">&lt;-</span> colnames<span class="hljs-punctuation">(</span>umap<span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><br>            plot_df <span class="hljs-operator">&lt;-</span> cbind<span class="hljs-punctuation">(</span>umap<span class="hljs-punctuation">,</span> MEs<span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> as.data.frame<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>            print<span class="hljs-punctuation">(</span>head<span class="hljs-punctuation">(</span>plot_df<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-keyword">else</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-keyword">if</span><span class="hljs-punctuation">(</span>split.by <span class="hljs-operator">%in%</span> colnames<span class="hljs-punctuation">(</span>seurat_obj<span class="hljs-operator">@</span>meta.data<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>            umap <span class="hljs-operator">&lt;-</span> seurat_obj<span class="hljs-operator">@</span>reductions<span class="hljs-punctuation">[[</span>reduction<span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-operator">@</span>cell.embeddings<br>            x_name <span class="hljs-operator">&lt;-</span> colnames<span class="hljs-punctuation">(</span>umap<span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><br>            y_name <span class="hljs-operator">&lt;-</span> colnames<span class="hljs-punctuation">(</span>umap<span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><br>            plot_df <span class="hljs-operator">&lt;-</span> cbind<span class="hljs-punctuation">(</span>umap<span class="hljs-punctuation">,</span> MEs<span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> as.data.frame<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>            plot_df <span class="hljs-operator">&lt;-</span> plot_df<span class="hljs-punctuation">[</span>rownames<span class="hljs-punctuation">(</span>seurat_obj<span class="hljs-operator">@</span>meta.data<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>            plot_df <span class="hljs-operator">&lt;-</span> cbind<span class="hljs-punctuation">(</span>plot_df<span class="hljs-punctuation">,</span>seurat_obj<span class="hljs-operator">@</span>meta.data<span class="hljs-punctuation">[</span>split.by<span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><br>        <span class="hljs-punctuation">&#125;</span><span class="hljs-keyword">else</span> <span class="hljs-punctuation">&#123;</span><br>           stop<span class="hljs-punctuation">(</span>sprintf<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Column %s is not in Seurat Object,check again!&quot;</span><span class="hljs-punctuation">,</span>split.by<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>        <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">&#125;</span><br>    plot_list <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">list</span><span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>    <span class="hljs-keyword">for</span> <span class="hljs-punctuation">(</span>cur_mod <span class="hljs-keyword">in</span> module_names<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>        print<span class="hljs-punctuation">(</span>cur_mod<span class="hljs-punctuation">)</span><br>        cur_color <span class="hljs-operator">&lt;-</span> modules <span class="hljs-operator">%&gt;%</span> subset<span class="hljs-punctuation">(</span>module <span class="hljs-operator">==</span> cur_mod<span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span><br>            .<span class="hljs-operator">$</span>color <span class="hljs-operator">%&gt;%</span> unique<br>        plot_range <span class="hljs-operator">&lt;-</span> plot_df<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span> cur_mod<span class="hljs-punctuation">]</span> <span class="hljs-operator">%&gt;%</span> <span class="hljs-built_in">range</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span>restrict_range<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span><span class="hljs-built_in">abs</span><span class="hljs-punctuation">(</span>plot_range<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">&gt;</span> <span class="hljs-built_in">abs</span><span class="hljs-punctuation">(</span>plot_range<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>                plot_range<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-operator">-</span><span class="hljs-number">1</span> <span class="hljs-operator">*</span> plot_range<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><br>            <span class="hljs-punctuation">&#125;</span><br>            <span class="hljs-keyword">else</span> <span class="hljs-punctuation">&#123;</span><br>                plot_range<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-operator">-</span><span class="hljs-number">1</span> <span class="hljs-operator">*</span> plot_range<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><br>            <span class="hljs-punctuation">&#125;</span><br>            plot_df<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span> cur_mod<span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> ifelse<span class="hljs-punctuation">(</span>plot_df<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span> cur_mod<span class="hljs-punctuation">]</span> <span class="hljs-operator">&gt;</span><br>                plot_range<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> plot_range<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> plot_df<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span> cur_mod<span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><br>            plot_df<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span> cur_mod<span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> ifelse<span class="hljs-punctuation">(</span>plot_df<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span> cur_mod<span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;</span><br>                plot_range<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> plot_range<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> plot_df<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span> cur_mod<span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><br>        <span class="hljs-punctuation">&#125;</span><br>        cur_plot_df <span class="hljs-operator">&lt;-</span> plot_df<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span>colnames<span class="hljs-punctuation">(</span>umap<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> cur_mod<span class="hljs-punctuation">,</span> split.by<span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>        colnames<span class="hljs-punctuation">(</span>cur_plot_df<span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-string">&quot;val&quot;</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span>order_points <span class="hljs-operator">==</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>            cur_plot_df <span class="hljs-operator">&lt;-</span> cur_plot_df <span class="hljs-operator">%&gt;%</span> dplyr<span class="hljs-operator">::</span>arrange<span class="hljs-punctuation">(</span>val<span class="hljs-punctuation">)</span><br>        <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span>order_points <span class="hljs-operator">==</span> <span class="hljs-string">&quot;shuffle&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>            cur_plot_df <span class="hljs-operator">&lt;-</span> cur_plot_df<span class="hljs-punctuation">[</span>sample<span class="hljs-punctuation">(</span>nrow<span class="hljs-punctuation">(</span>cur_plot_df<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">]</span><br>        <span class="hljs-punctuation">&#125;</span><br>        p <span class="hljs-operator">&lt;-</span> cur_plot_df <span class="hljs-operator">%&gt;%</span> ggplot<span class="hljs-punctuation">(</span>aes_string<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> x_name<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> y_name<span class="hljs-punctuation">,</span><br>            color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;val&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span>raster<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>            p <span class="hljs-operator">&lt;-</span> p <span class="hljs-operator">+</span> ggrastr<span class="hljs-operator">::</span>rasterise<span class="hljs-punctuation">(</span>geom_point<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> point_size<span class="hljs-punctuation">,</span><br>                alpha <span class="hljs-operator">=</span> alpha<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> dpi <span class="hljs-operator">=</span> raster_dpi<span class="hljs-punctuation">,</span> scale <span class="hljs-operator">=</span> raster_scale<span class="hljs-punctuation">)</span><br>        <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-punctuation">&#123;</span><br>            p <span class="hljs-operator">&lt;-</span> p <span class="hljs-operator">+</span> geom_point<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> point_size<span class="hljs-punctuation">,</span> alpha <span class="hljs-operator">=</span> alpha<span class="hljs-punctuation">)</span><br>        <span class="hljs-punctuation">&#125;</span><br>        p <span class="hljs-operator">&lt;-</span> p <span class="hljs-operator">+</span> umap_theme<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> labs<span class="hljs-punctuation">(</span>color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">)</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span>title<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>            p <span class="hljs-operator">&lt;-</span> p <span class="hljs-operator">+</span> ggtitle<span class="hljs-punctuation">(</span>cur_mod<span class="hljs-punctuation">)</span><br>        <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span><span class="hljs-built_in">is.numeric</span><span class="hljs-punctuation">(</span>plot_ratio<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>            p <span class="hljs-operator">&lt;-</span> p <span class="hljs-operator">+</span> coord_fixed<span class="hljs-punctuation">(</span>ratio <span class="hljs-operator">=</span> plot_ratio<span class="hljs-punctuation">)</span><br>        <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span><span class="hljs-operator">!</span>ucell<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>            p <span class="hljs-operator">&lt;-</span> p <span class="hljs-operator">+</span> scale_color_gradient2<span class="hljs-punctuation">(</span>low <span class="hljs-operator">=</span> <span class="hljs-string">&quot;grey75&quot;</span><span class="hljs-punctuation">,</span> mid <span class="hljs-operator">=</span> <span class="hljs-string">&quot;grey95&quot;</span><span class="hljs-punctuation">,</span><br>                high <span class="hljs-operator">=</span> cur_color<span class="hljs-punctuation">,</span> breaks <span class="hljs-operator">=</span> plot_range<span class="hljs-punctuation">,</span> labels <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;-&quot;</span><span class="hljs-punctuation">,</span><br>                  <span class="hljs-string">&quot;+&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> guide <span class="hljs-operator">=</span> guide_colorbar<span class="hljs-punctuation">(</span>ticks <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">,</span><br>                  barwidth <span class="hljs-operator">=</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> barheight <span class="hljs-operator">=</span> <span class="hljs-number">4</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>        <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-punctuation">&#123;</span><br>            p <span class="hljs-operator">&lt;-</span> p <span class="hljs-operator">+</span> scale_color_gradient<span class="hljs-punctuation">(</span>low <span class="hljs-operator">=</span> <span class="hljs-string">&quot;grey95&quot;</span><span class="hljs-punctuation">,</span> high <span class="hljs-operator">=</span> cur_color<span class="hljs-punctuation">,</span><br>                breaks <span class="hljs-operator">=</span> plot_range<span class="hljs-punctuation">,</span> labels <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;0&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;+&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> guide <span class="hljs-operator">=</span> guide_colorbar<span class="hljs-punctuation">(</span>ticks <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">,</span><br>                  barwidth <span class="hljs-operator">=</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> barheight <span class="hljs-operator">=</span> <span class="hljs-number">4</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>        <span class="hljs-punctuation">&#125;</span><br>          <span class="hljs-keyword">if</span><span class="hljs-punctuation">(</span><span class="hljs-operator">!</span><span class="hljs-built_in">is.null</span><span class="hljs-punctuation">(</span>split.by<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-keyword">if</span><span class="hljs-punctuation">(</span><span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>split.by<span class="hljs-punctuation">)</span><span class="hljs-operator">==</span><span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>            p <span class="hljs-operator">&lt;-</span> p <span class="hljs-operator">+</span>theme_test<span class="hljs-punctuation">(</span>base_line_size <span class="hljs-operator">=</span> <span class="hljs-number">0.8</span><span class="hljs-punctuation">,</span>base_rect_size <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span>ggplot2<span class="hljs-operator">::</span>facet_wrap<span class="hljs-punctuation">(</span>formula<span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;~&quot;</span><span class="hljs-punctuation">,</span>split.by<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>ncol <span class="hljs-operator">=</span> ncol<span class="hljs-punctuation">)</span><br>            <span class="hljs-punctuation">&#125;</span><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span><span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>split.by<span class="hljs-punctuation">)</span><span class="hljs-operator">==</span><span class="hljs-number">2</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>                p <span class="hljs-operator">&lt;-</span> p <span class="hljs-operator">+</span>theme_test<span class="hljs-punctuation">(</span>base_line_size <span class="hljs-operator">=</span> <span class="hljs-number">0.8</span><span class="hljs-punctuation">,</span>base_rect_size <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span>ggplot2<span class="hljs-operator">::</span>facet_wrap<span class="hljs-punctuation">(</span>formula<span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span>split.by<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;~&quot;</span><span class="hljs-punctuation">,</span>split.by<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>ncol <span class="hljs-operator">=</span> ncol<span class="hljs-punctuation">)</span><br>            <span class="hljs-punctuation">&#125;</span> <br>        <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-comment"># print(p)</span><br>        plot_list<span class="hljs-punctuation">[[</span>cur_mod<span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> p<br>    <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span><span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>plot_list<span class="hljs-punctuation">)</span> <span class="hljs-operator">==</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>        p <span class="hljs-operator">&lt;-</span> plot_list<span class="hljs-punctuation">[[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><br>    <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-keyword">else</span> <span class="hljs-punctuation">&#123;</span><br>        p <span class="hljs-operator">&lt;-</span> plot_list<br>    <span class="hljs-punctuation">&#125;</span><br>    p<br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>使用该函数进行绘图</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs R">plot_result <span class="hljs-operator">&lt;-</span> ModuleFeaturePlot_02<span class="hljs-punctuation">(</span><br>    scRNA<span class="hljs-punctuation">,</span><br>    reduction <span class="hljs-operator">=</span> <span class="hljs-string">&quot;umap&quot;</span><span class="hljs-punctuation">,</span><br>    features<span class="hljs-operator">=</span><span class="hljs-string">&#x27;hMEs&#x27;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment"># plot the hMEs</span><br>    order<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span><span class="hljs-comment"># order so the points with highest hMEs are on top</span><br>    raster <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">,</span><br>    ucell <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">,</span><br>    split.by<span class="hljs-operator">=</span><span class="hljs-string">&#x27;seurat_clusters&#x27;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment"># 分组依据</span><br>    ncol<span class="hljs-operator">=</span><span class="hljs-number">8</span> <span class="hljs-comment"># 分面图列数</span><br><span class="hljs-punctuation">)</span><br><span class="hljs-built_in">names</span><span class="hljs-punctuation">(</span>plot_result<span class="hljs-punctuation">)</span><br><span class="hljs-comment"># [1] &quot;M1&quot; &quot;M2&quot; &quot;M3&quot; &quot;M4&quot; &quot;M5&quot; &quot;M6&quot; &quot;M7&quot; &quot;M8&quot; &quot;M9&quot;</span><br>plot_result<span class="hljs-punctuation">[[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_2437b624568c0c3f012d8309c604c3f7.png"></p>]]></content>
    
    
    
    <tags>
      
      <tag>scRNA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>单细胞hdWGCNA</title>
    <link href="/2024/05/30/%E5%8D%95%E7%BB%86%E8%83%9EhdWGCNA/"/>
    <url>/2024/05/30/%E5%8D%95%E7%BB%86%E8%83%9EhdWGCNA/</url>
    
    <content type="html"><![CDATA[<h1 id="hdWGCNA"><a href="#hdWGCNA" class="headerlink" title="hdWGCNA"></a>hdWGCNA</h1><p>部分流程来自公众号KS科研与服务。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># devtools::install_github(&#x27;smorabit/hdWGCNA&#x27;, ref=&#x27;dev&#x27;) #下载安装</span><br>library<span class="hljs-punctuation">(</span>hdWGCNA<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>WGCNA<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>Seurat<span class="hljs-punctuation">)</span> <br>library<span class="hljs-punctuation">(</span>tidyverse<span class="hljs-punctuation">)</span> <br>library<span class="hljs-punctuation">(</span>igraph<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>cowplot<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>patchwork<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>dplyr<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>ggplot2<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>stringr<span class="hljs-punctuation">)</span><br>theme_set<span class="hljs-punctuation">(</span>theme_cowplot<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>set.seed<span class="hljs-punctuation">(</span><span class="hljs-number">12345</span><span class="hljs-punctuation">)</span><br>enableWGCNAThreads<span class="hljs-punctuation">(</span>nThreads <span class="hljs-operator">=</span> <span class="hljs-number">8</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 读入数据</span><br>load<span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;Bra_rna.RData&#x27;</span><span class="hljs-punctuation">)</span><br>DimPlot<span class="hljs-punctuation">(</span>Bra_rna<span class="hljs-punctuation">,</span> label <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><br>DefaultAssay<span class="hljs-punctuation">(</span>Bra_rna<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-string">&#x27;RNA&#x27;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>scRNA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>区分单细胞数据中真菌数据</title>
    <link href="/2024/05/30/%E5%8C%BA%E5%88%86%E5%8D%95%E7%BB%86%E8%83%9E%E6%95%B0%E6%8D%AE%E4%B8%AD%E7%9C%9F%E8%8F%8C%E6%95%B0%E6%8D%AE/"/>
    <url>/2024/05/30/%E5%8C%BA%E5%88%86%E5%8D%95%E7%BB%86%E8%83%9E%E6%95%B0%E6%8D%AE%E4%B8%AD%E7%9C%9F%E8%8F%8C%E6%95%B0%E6%8D%AE/</url>
    
    <content type="html"><![CDATA[<h1 id="区分出单细胞数据中的细菌污染"><a href="#区分出单细胞数据中的细菌污染" class="headerlink" title="区分出单细胞数据中的细菌污染"></a>区分出单细胞数据中的细菌污染</h1><blockquote><p>博客文章：<a href="https://www.bilibili.com/read/cv24341361/">https://www.bilibili.com/read/cv24341361/</a></p></blockquote><p><strong>SAHMI</strong> 使得从宿主组织的基因组测序中系统地恢复和去噪微生物信号成为可能。该流程包括 R 命令行函数，这些函数执行以下主要步骤。</p><h2 id="Taxonomic-classification"><a href="#Taxonomic-classification" class="headerlink" title="Taxonomic classification"></a>Taxonomic classification</h2><blockquote><p>conda安装</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">mamba search kraken2<br>mamba install -y  kraken2<br><span class="hljs-meta prompt_"># </span><span class="language-bash">检查是否安装成功</span><br>kraken2 --version<br></code></pre></td></tr></table></figure><blockquote><p>kraken2 源码安装</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd /root/wangje/software &amp;&amp; mkdir kraken2 &amp;&amp; cd ./kraken2<br>git clone https://github.com/DerrickWood/kraken2.git<br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_fdf9c2ad4f784a0c1af2f6da05d7b2e9.png"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">mkdir src<br>./install_kraken2.sh ../src<br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_84edf645bb678b7e9f8ef90bef4351b6.png"></p><p>查看编译的src目录中有什么内容。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">tree -hL 2 ./src<br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_fc91a323ca5554a7b2dd13dedd14eed4.png"></p><p>将放有可执行程序的目录添加到环境变量。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd src # 进入到存放<br>echo &quot;export PATH=$(pwd):\$PATH&quot; &gt;&gt; ~/.bashrc &amp;&amp; source ~/.bashrc<br><span class="hljs-meta prompt_">#</span><span class="language-bash">KRAKEN2_DIR=/root/wangje/software/kraken2/src</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-built_in">cp</span> <span class="hljs-variable">$KRAKEN2_DIR</span>/kraken2&#123;,-build,-inspect&#125; <span class="hljs-variable">$HOME</span>/bin</span><br></code></pre></td></tr></table></figure><blockquote><p>标准数据库的构建</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">DBNAME=/root/wangje/software/kraken2/db/2024<br>mkdir -p $DBNAME<br>kraken2-build --standard --threads  --db $DBNAME<br></code></pre></td></tr></table></figure><p>在进行建库的过程中可能会出现如下错误：</p><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_9bb5de1661365ee661c667ca6b3bfbf6.png"></p><p>尝试解决办法：</p><p><a href="https://blog.csdn.net/lanzhoushidabian/article/details/129599041">https://blog.csdn.net/lanzhoushidabian/article/details/129599041</a></p><p>对rsync_from_ncbi.pl文件内容替换成上面博客的内容，出现ftp问题，依然采用博客中的方法。</p><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_452c3c5ea6bbbb8a940acf8fdaa87900.png"></p><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_96faa22438463ea4704ec6da3327aedc.png"></p>]]></content>
    
    
    
    <tags>
      
      <tag>scRNA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>01单细胞文献数据</title>
    <link href="/2024/05/29/01%E5%8D%95%E7%BB%86%E8%83%9E%E6%96%87%E7%8C%AE%E6%95%B0%E6%8D%AE/"/>
    <url>/2024/05/29/01%E5%8D%95%E7%BB%86%E8%83%9E%E6%96%87%E7%8C%AE%E6%95%B0%E6%8D%AE/</url>
    
    <content type="html"><![CDATA[<h1 id="单细胞文章数据使用"><a href="#单细胞文章数据使用" class="headerlink" title="单细胞文章数据使用"></a>单细胞文章数据使用</h1><blockquote><p>文章名: scRNA-seq profiling of breast cancer tumors, BRCA1 mutant pre-neoplastic mammary gland cells and normal mammary gland cells</p><p>文章链接：<a href="https://www.embopress.org/doi/full/10.15252/embj.2020107333">https://www.embopress.org/doi/full/10.15252/embj.2020107333</a></p><p>数据地址：<a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE161529">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE161529</a></p></blockquote><p>样本信息：</p><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_bfd48d0b6a82a75ad25fa0b39f18d152.png"></p><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_1a042b91e7f2ec4f4fee990e31d60c6f.png"></p><h3 id="数据下载"><a href="#数据下载" class="headerlink" title="数据下载"></a>数据下载</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 下载</span><br>wget -O GSE161529_RAW.tar https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE161529 <br>wget -O GSE161529_features.tsv.gz https://www.ncbi.nlm.nih.gov/geo/download/?acc=GSE161529&amp;format=file&amp;file=GSE161529%5Ffeatures%2Etsv%2Egz<br><span class="hljs-comment"># 解包解压</span><br>tar -xvf GSE161529_RAW.tar<br>gunzip GSE161529_features.tsv.gz<br></code></pre></td></tr></table></figure><h3 id="将数据转换成R包Seurat输入格式"><a href="#将数据转换成R包Seurat输入格式" class="headerlink" title="将数据转换成R包Seurat输入格式"></a>将数据转换成R包Seurat输入格式</h3><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_e404480bf9542f14dbc1b12c515a266e.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ls</span> *.gz &gt;&gt; sample.txt<br><span class="hljs-built_in">cd</span> /root/wangje/Project/GSE161529<br>baseDir=/root/wangje/Project/GSE161529<br><span class="hljs-keyword">while</span> IFS= <span class="hljs-built_in">read</span> -r line; <span class="hljs-keyword">do</span><br>  <span class="hljs-built_in">mkdir</span> -p  <span class="hljs-variable">$&#123;<span class="hljs-variable">$&#123;<span class="hljs-variable">$&#123;line&#125;</span>#*_&#125;</span>%-*&#125;</span><br>  pp=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$line</span>&quot;</span> | awk -F <span class="hljs-string">&#x27;-&#x27;</span> <span class="hljs-string">&#x27;&#123;print $NF&#125;&#x27;</span>)<br>  <span class="hljs-built_in">echo</span> <span class="hljs-variable">$pp</span><br>  dir_name=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;line#*_&#125;</span>&quot;</span><br>  dir_name=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;dir_name%-*&#125;</span>&quot;</span><br>  target_dir=<span class="hljs-string">&quot;./<span class="hljs-variable">$&#123;dir_name&#125;</span>&quot;</span><br>  target_link=<span class="hljs-string">&quot;<span class="hljs-variable">$&#123;target_dir&#125;</span>/<span class="hljs-variable">$&#123;pp&#125;</span>&quot;</span><br>  <span class="hljs-built_in">mkdir</span> -p <span class="hljs-string">&quot;<span class="hljs-variable">$target_dir</span>&quot;</span><br>  <span class="hljs-built_in">ln</span> -s <span class="hljs-string">&quot;<span class="hljs-variable">$baseDir</span>/<span class="hljs-variable">$line</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$target_link</span>&quot;</span><br>  <span class="hljs-built_in">ln</span> -s <span class="hljs-string">&quot;<span class="hljs-variable">$baseDir</span>/features.tsv.gz&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$target_dir</span>/features.tsv.gz&quot;</span><br><span class="hljs-keyword">done</span> &lt; <span class="hljs-string">&quot;./sample.txt&quot;</span><br></code></pre></td></tr></table></figure><p>样本数据中包括了样本上皮细胞数据和样本的淋巴结数据，这两个数据可以先不使用。</p><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_8e65ab087ffbddd864c8f490e90b8fe5.png"></p><h3 id="生成Seurat对象数据"><a href="#生成Seurat对象数据" class="headerlink" title="生成Seurat对象数据"></a>生成Seurat对象数据</h3><blockquote><p>这里使用的Seurat Version 4.4.3</p></blockquote><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs R">suppressMessages<span class="hljs-punctuation">(</span>suppressWarnings<span class="hljs-punctuation">(</span><span class="hljs-punctuation">&#123;</span><br>  library<span class="hljs-punctuation">(</span>Seurat<span class="hljs-punctuation">)</span> <span class="hljs-comment"># 4.3</span><br>  library<span class="hljs-punctuation">(</span>dplyr<span class="hljs-punctuation">)</span><br>  library<span class="hljs-punctuation">(</span>ggplot2<span class="hljs-punctuation">)</span><br>  library<span class="hljs-punctuation">(</span>patchwork<span class="hljs-punctuation">)</span><br>  library<span class="hljs-punctuation">(</span>SCP<span class="hljs-punctuation">)</span> <span class="hljs-comment"># plot</span><br>  library<span class="hljs-punctuation">(</span>scCustomize<span class="hljs-punctuation">)</span><br>  library<span class="hljs-punctuation">(</span>ggpubr<span class="hljs-punctuation">)</span><br>  library<span class="hljs-punctuation">(</span>ggsignif<span class="hljs-punctuation">)</span><br>  library<span class="hljs-punctuation">(</span>RColorBrewer<span class="hljs-punctuation">)</span><br>  library<span class="hljs-punctuation">(</span>ComplexHeatmap<span class="hljs-punctuation">)</span><br>  library<span class="hljs-punctuation">(</span>harmony<span class="hljs-punctuation">)</span><br>  library<span class="hljs-punctuation">(</span>pheatmap<span class="hljs-punctuation">)</span><br>  library<span class="hljs-punctuation">(</span>ggplot2<span class="hljs-punctuation">)</span><br>  library<span class="hljs-punctuation">(</span>grid<span class="hljs-punctuation">)</span><br>  library<span class="hljs-punctuation">(</span>gridExtra<span class="hljs-punctuation">)</span><br>  library<span class="hljs-punctuation">(</span>qs<span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;/root/wangje/Project/GSE161529&#x27;</span><span class="hljs-punctuation">)</span><br>dirName <span class="hljs-operator">&lt;-</span> gsub<span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;./&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;&#x27;</span><span class="hljs-punctuation">,</span>list.dirs<span class="hljs-punctuation">(</span>path <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;.&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_3b98060d1db5b22aea32948030380423.png"></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># 去除上皮细胞和淋巴结的数据</span><br>dirName <span class="hljs-operator">&lt;-</span> dirName<span class="hljs-punctuation">[</span><span class="hljs-operator">-</span>grep<span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;Epi|LN&#x27;</span><span class="hljs-punctuation">,</span>dirName<span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><br>scRNAlist <span class="hljs-operator">&lt;-</span> setNames<span class="hljs-punctuation">(</span>lapply<span class="hljs-punctuation">(</span>dirName<span class="hljs-punctuation">,</span>FUN<span class="hljs-operator">=</span><span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>    message<span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">)</span><br>    RenameCells<span class="hljs-punctuation">(</span>CreateSeuratObject<span class="hljs-punctuation">(</span>Read10X<span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>min.cells <span class="hljs-operator">=</span> <span class="hljs-number">5</span><span class="hljs-punctuation">,</span>min.features <span class="hljs-operator">=</span> <span class="hljs-number">200</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>add.cell.id<span class="hljs-operator">=</span>x<span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>dirName<span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_7f3cb8689f517e6798834a9096856296.png"></p><blockquote><p>查看数据分布</p></blockquote><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#合并数据</span><br>scRNA <span class="hljs-operator">&lt;-</span> merge<span class="hljs-punctuation">(</span>scRNAlist<span class="hljs-punctuation">[[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>scRNAlist<span class="hljs-punctuation">[</span><span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><br>scRNA<br><span class="hljs-comment"># n object of class Seurat</span><br><span class="hljs-comment"># 25503 features across 329921 samples within 1 assay</span><br><span class="hljs-comment"># Active assay: RNA (25503 features, 0 variable features)</span><br><span class="hljs-comment">#  2 layers present: counts, data</span><br>library<span class="hljs-punctuation">(</span>magrittr<span class="hljs-punctuation">)</span><br>scRNA <span class="hljs-operator">%&lt;&gt;%</span> PercentageFeatureSet<span class="hljs-punctuation">(</span>pattern <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;^MT-&#x27;</span><span class="hljs-punctuation">,</span>col.name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;percent.mt&#x27;</span><span class="hljs-punctuation">)</span><br>scRNA<span class="hljs-operator">$</span>sample <span class="hljs-operator">&lt;-</span> stringr<span class="hljs-operator">::</span>str_split_fixed<span class="hljs-punctuation">(</span>rownames<span class="hljs-punctuation">(</span>scRNA<span class="hljs-operator">@</span>meta.data<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;_[A|T|G|C].*&#x27;</span><span class="hljs-punctuation">,</span> n <span class="hljs-operator">=</span> <span class="hljs-number">2</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><br> unique<span class="hljs-punctuation">(</span>scRNA<span class="hljs-operator">$</span>sample<span class="hljs-punctuation">)</span><br><span class="hljs-comment">#  [1] &quot;B1-KCF0894&quot;     &quot;B1-MH0023&quot;      &quot;B1-MH0033&quot;      &quot;B1-MH0090&quot;      &quot;ER-AH0319&quot;      &quot;ER-MH0001&quot;      &quot;ER-MH0025&quot;      &quot;ER-MH0029-7C&quot;</span><br><span class="hljs-comment">#  [9] &quot;ER-MH0029-9C&quot;   &quot;ER-MH0032&quot;      &quot;ER-MH0040&quot;      &quot;ER-MH0042&quot;      &quot;ER-MH0043-T&quot;    &quot;ER-MH0056-T&quot;    &quot;ER-MH0064-T&quot;    &quot;ER-MH0114-T3&quot;</span><br><span class="hljs-comment"># [17] &quot;ER-MH0125&quot;      &quot;ER-MH0151&quot;      &quot;ER-MH0163&quot;      &quot;ER-MH0167-T&quot;    &quot;ER-MH0173-T&quot;    &quot;ER-PM0360&quot;      &quot;HER2-AH0308&quot;    &quot;HER2-MH0031&quot;</span><br><span class="hljs-comment"># [25] &quot;HER2-MH0069&quot;    &quot;HER2-MH0161&quot;    &quot;HER2-MH0176&quot;    &quot;HER2-PM0337&quot;    &quot;mER-MH0068-T&quot;   &quot;mER-PM0178&quot;     &quot;N-MH0021-Total&quot; &quot;N-MH0023-Total&quot;</span><br><span class="hljs-comment"># [33] &quot;N-MH0064-Total&quot; &quot;N-MH0169-Total&quot; &quot;N-MH275-Total&quot;  &quot;N-MH288-Total&quot;  &quot;N-PM0019-Total&quot; &quot;N-PM0092-Total&quot; &quot;N-PM0095-Total&quot; &quot;N-PM0230-Total&quot;</span><br><span class="hljs-comment"># [41] &quot;N-PM0233-Total&quot; &quot;N-PM0342-Total&quot; &quot;N-PM0372-Total&quot; &quot;TN-B1-MH0131&quot;   &quot;TN-B1-MH0177&quot;   &quot;TN-B1-MH4031&quot;   &quot;TN-B1-Tum0554&quot;  &quot;TN-MH0114-T2&quot;</span><br><span class="hljs-comment"># [49] &quot;TN-MH0126&quot;      &quot;TN-MH0135&quot;      &quot;TN-SH0106&quot;</span><br>p1 <span class="hljs-operator">&lt;-</span> VlnPlot<span class="hljs-punctuation">(</span>scRNA<span class="hljs-punctuation">,</span> features <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;nCount_RNA&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;nFeature_RNA&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;percent.mt&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> ncol <span class="hljs-operator">=</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> group.by <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;sample&#x27;</span><span class="hljs-punctuation">,</span>pt.size <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_8f76179bb36294da0eb0681730df708e.png"></p><blockquote><p>数据粗过滤</p></blockquote><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs R">filterP <span class="hljs-operator">&lt;-</span> scRNA<span class="hljs-operator">$</span>nFeature_RNA <span class="hljs-operator">&gt;=</span><span class="hljs-number">200</span> <span class="hljs-operator">&amp;</span> scRNA<span class="hljs-operator">$</span>nFeature_RNA <span class="hljs-operator">&lt;</span> <span class="hljs-number">5000</span> <span class="hljs-operator">&amp;</span> scRNA<span class="hljs-operator">$</span>percent.mt <span class="hljs-operator">&lt;</span><span class="hljs-number">15</span><br>scRNA <span class="hljs-operator">&lt;-</span> scRNA<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span>filterP<span class="hljs-punctuation">]</span><br>scRNA<br><span class="hljs-comment"># An object of class Seurat</span><br><span class="hljs-comment"># 25503 features across 282938 samples within 1 assay</span><br><span class="hljs-comment"># Active assay: RNA (25503 features, 0 variable features)</span><br><span class="hljs-comment">#  2 layers present: counts, data</span><br>p1 <span class="hljs-operator">&lt;-</span> VlnPlot<span class="hljs-punctuation">(</span>scRNA<span class="hljs-punctuation">,</span> features <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;nCount_RNA&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;nFeature_RNA&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;percent.mt&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> ncol <span class="hljs-operator">=</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> group.by <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;sample&#x27;</span><span class="hljs-punctuation">,</span>pt.size <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_e511bae230a7f8780e9dcbec94570df0.png"></p><h3 id="去除双细胞"><a href="#去除双细胞" class="headerlink" title="去除双细胞"></a>去除双细胞</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs R">library<span class="hljs-punctuation">(</span>DoubletFinder<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>dplyr<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>patchwork<span class="hljs-punctuation">)</span><br>scRNAlist <span class="hljs-operator">&lt;-</span> SplitObject<span class="hljs-punctuation">(</span>scRNA<span class="hljs-punctuation">,</span> split.by<span class="hljs-operator">=</span><span class="hljs-string">&#x27;sample&#x27;</span><span class="hljs-punctuation">)</span><br><span class="hljs-keyword">for</span><span class="hljs-punctuation">(</span>i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>scRNAlist<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>  print<span class="hljs-punctuation">(</span><span class="hljs-built_in">names</span><span class="hljs-punctuation">(</span>scRNAlist<span class="hljs-punctuation">[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>  <br>  scRNAlist<span class="hljs-punctuation">[[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> NormalizeData<span class="hljs-punctuation">(</span>scRNAlist<span class="hljs-punctuation">[[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><br>  scRNAlist<span class="hljs-punctuation">[[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> ScaleData<span class="hljs-punctuation">(</span>scRNAlist<span class="hljs-punctuation">[[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> verbose <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span><br>  scRNAlist<span class="hljs-punctuation">[[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> FindVariableFeatures<span class="hljs-punctuation">(</span>scRNAlist<span class="hljs-punctuation">[[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> verbose <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span><br>  scRNAlist<span class="hljs-punctuation">[[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> RunPCA<span class="hljs-punctuation">(</span>scRNAlist<span class="hljs-punctuation">[[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> npcs <span class="hljs-operator">=</span> <span class="hljs-number">30</span><span class="hljs-punctuation">,</span> verbose <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span><br>  scRNAlist<span class="hljs-punctuation">[[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> RunUMAP<span class="hljs-punctuation">(</span>scRNAlist<span class="hljs-punctuation">[[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> reduction <span class="hljs-operator">=</span> <span class="hljs-string">&quot;pca&quot;</span><span class="hljs-punctuation">,</span> dims <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-punctuation">)</span><br>  scRNAlist<span class="hljs-punctuation">[[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> FindNeighbors<span class="hljs-punctuation">(</span>scRNAlist<span class="hljs-punctuation">[[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> reduction <span class="hljs-operator">=</span> <span class="hljs-string">&quot;pca&quot;</span><span class="hljs-punctuation">,</span> dims <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-punctuation">)</span><br>  scRNAlist<span class="hljs-punctuation">[[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> FindClusters<span class="hljs-punctuation">(</span>scRNAlist<span class="hljs-punctuation">[[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> resolution <span class="hljs-operator">=</span> <span class="hljs-number">0.8</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br>message<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;双细胞检测....&quot;</span><span class="hljs-punctuation">)</span><br>detectDoublet <span class="hljs-operator">&lt;-</span> <span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span><br>  obj<span class="hljs-punctuation">,</span> <span class="hljs-comment">#seurat obj</span><br>  dims<span class="hljs-punctuation">,</span> <span class="hljs-comment">#Pc数目</span><br>  estDubRate<span class="hljs-punctuation">,</span> <span class="hljs-comment">#期望双细胞率，该值最好通过细胞在10X/Drop-Seq装置上的负载密度来估计</span><br>  ncores<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-comment">#线程数</span><br>  SCTransform<span class="hljs-punctuation">,</span><span class="hljs-comment">#True or False</span><br>  Homotypic<span class="hljs-operator">=</span><span class="hljs-built_in">F</span><span class="hljs-punctuation">,</span><span class="hljs-comment">#是否需要优化同源双细胞</span><br>  annotation<span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span> <span class="hljs-comment">#听说最好是celltype</span><br>  <span class="hljs-comment">#use DoubletFinder packages</span><br>  require<span class="hljs-punctuation">(</span>DoubletFinder<span class="hljs-punctuation">)</span><span class="hljs-comment">#2.0.4</span><br>  <span class="hljs-comment">#select pK</span><br>  sweep.res.list <span class="hljs-operator">&lt;-</span> paramSweep<span class="hljs-punctuation">(</span>obj<span class="hljs-punctuation">,</span> PCs<span class="hljs-operator">=</span>dims<span class="hljs-punctuation">,</span> sct<span class="hljs-operator">=</span>SCTransform<span class="hljs-punctuation">,</span> num.cores<span class="hljs-operator">=</span>ncores<span class="hljs-punctuation">)</span><br>  sweep.stats <span class="hljs-operator">&lt;-</span> summarizeSweep<span class="hljs-punctuation">(</span>sweep.res.list<span class="hljs-punctuation">,</span> GT<span class="hljs-operator">=</span><span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span><br>  bcmvn <span class="hljs-operator">&lt;-</span> find.pK<span class="hljs-punctuation">(</span>sweep.stats<span class="hljs-punctuation">)</span><br>  pK <span class="hljs-operator">&lt;-</span> bcmvn<span class="hljs-operator">$</span>pK<span class="hljs-punctuation">[</span>which.max<span class="hljs-punctuation">(</span>bcmvn<span class="hljs-operator">$</span>BCmetric<span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">%&gt;%</span> <span class="hljs-built_in">as.character</span><span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%&gt;%</span> <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>  message<span class="hljs-punctuation">(</span>sprintf<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Using pK = %s...&quot;</span><span class="hljs-punctuation">,</span> pK<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>  <span class="hljs-comment">#Doublet Proportion Estimate</span><br>  <span class="hljs-keyword">if</span><span class="hljs-punctuation">(</span>Homotypic<span class="hljs-operator">==</span><span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>    nExp_poi <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">round</span><span class="hljs-punctuation">(</span>estDubRate <span class="hljs-operator">*</span> <span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>Cells<span class="hljs-punctuation">(</span>obj<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-keyword">else</span><span class="hljs-punctuation">&#123;</span><br>    homotypic.prop <span class="hljs-operator">&lt;-</span> modelHomotypic<span class="hljs-punctuation">(</span>obj<span class="hljs-operator">@</span>meta.data<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span>annotation<span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><br>    nExp_poi <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">round</span><span class="hljs-punctuation">(</span>estDubRate <span class="hljs-operator">*</span> <span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>Cells<span class="hljs-punctuation">(</span>obj<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>    nExp_poi  <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">round</span><span class="hljs-punctuation">(</span>nExp_poi<span class="hljs-operator">*</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-operator">-</span>homotypic.prop<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>  <span class="hljs-punctuation">&#125;</span><br>  obj <span class="hljs-operator">&lt;-</span> doubletFinder<span class="hljs-punctuation">(</span>obj<span class="hljs-punctuation">,</span> PCs <span class="hljs-operator">=</span> dims<span class="hljs-punctuation">,</span> pN <span class="hljs-operator">=</span> <span class="hljs-number">0.25</span><span class="hljs-punctuation">,</span> pK <span class="hljs-operator">=</span> pK<span class="hljs-punctuation">,</span> nExp <span class="hljs-operator">=</span> nExp_poi<span class="hljs-punctuation">,</span> reuse.pANN <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">,</span> sct <span class="hljs-operator">=</span> SCTransform<span class="hljs-punctuation">)</span><br>  pann <span class="hljs-operator">&lt;-</span> grep<span class="hljs-punctuation">(</span>pattern<span class="hljs-operator">=</span><span class="hljs-string">&quot;^pANN&quot;</span><span class="hljs-punctuation">,</span> x<span class="hljs-operator">=</span><span class="hljs-built_in">names</span><span class="hljs-punctuation">(</span>obj<span class="hljs-operator">@</span>meta.data<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> value<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>  message<span class="hljs-punctuation">(</span>sprintf<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Using pANN = %s...&quot;</span><span class="hljs-punctuation">,</span> pann<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>  classify <span class="hljs-operator">&lt;-</span> grep<span class="hljs-punctuation">(</span>pattern<span class="hljs-operator">=</span><span class="hljs-string">&quot;^DF.classifications&quot;</span><span class="hljs-punctuation">,</span> x<span class="hljs-operator">=</span><span class="hljs-built_in">names</span><span class="hljs-punctuation">(</span>obj<span class="hljs-operator">@</span>meta.data<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> value<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>  obj<span class="hljs-operator">$</span>pANN <span class="hljs-operator">&lt;-</span> obj<span class="hljs-punctuation">[[</span>pann<span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><br>  obj<span class="hljs-operator">$</span>DF.classify <span class="hljs-operator">&lt;-</span> obj<span class="hljs-punctuation">[[</span>classify<span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><br>  obj<span class="hljs-punctuation">[[</span>pann<span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-literal">NULL</span><br>  obj<span class="hljs-punctuation">[[</span>classify<span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-literal">NULL</span><br>  <span class="hljs-built_in">return</span><span class="hljs-punctuation">(</span>obj<span class="hljs-punctuation">)</span><br> <span class="hljs-punctuation">&#125;</span><br><span class="hljs-comment">#分样预测双细胞</span><br><span class="hljs-comment"># 对每个样本进行分析</span><br>message<span class="hljs-punctuation">(</span>paste0<span class="hljs-punctuation">(</span>Sys.time<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27; 开始进行双细胞检测...&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>scRNAlist <span class="hljs-operator">&lt;-</span> lapply<span class="hljs-punctuation">(</span>scRNAlist<span class="hljs-punctuation">,</span> FUN <span class="hljs-operator">=</span> <span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>    detectDoublet<span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">,</span>dims <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><span class="hljs-punctuation">,</span><br>    estDubRate<span class="hljs-operator">=</span><span class="hljs-number">0.075</span><span class="hljs-punctuation">,</span><br>    ncores <span class="hljs-operator">=</span> <span class="hljs-number">20</span><span class="hljs-punctuation">,</span> <br>    SCTransform<span class="hljs-operator">=</span><span class="hljs-built_in">F</span><span class="hljs-punctuation">,</span> <br>    Homotypic<span class="hljs-operator">=</span><span class="hljs-built_in">F</span><span class="hljs-punctuation">,</span> <br>   annotation<span class="hljs-operator">=</span><span class="hljs-string">&quot;seurat_clusters&quot;</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">)</span><br><span class="hljs-comment"># 合并文件</span><br>scRNA_harmony <span class="hljs-operator">&lt;-</span> merge<span class="hljs-punctuation">(</span>scRNAlist<span class="hljs-punctuation">[[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>scRNAlist<span class="hljs-punctuation">[</span><span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><br>scRNA_harmony <span class="hljs-operator">&lt;-</span> scRNA_harmony<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span>scRNA_harmony<span class="hljs-operator">$</span>DF.classify<span class="hljs-operator">==</span><span class="hljs-string">&quot;Singlet&quot;</span><span class="hljs-punctuation">]</span><br></code></pre></td></tr></table></figure><h3 id="查看细胞周期的影响"><a href="#查看细胞周期的影响" class="headerlink" title="查看细胞周期的影响"></a>查看细胞周期的影响</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs R">library<span class="hljs-punctuation">(</span>magrittr<span class="hljs-punctuation">)</span><br>scRNA_harmony <span class="hljs-operator">%&lt;&gt;%</span> NormalizeData<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>scRNA_harmony <span class="hljs-operator">%&lt;&gt;%</span> CellCycleScoring<span class="hljs-punctuation">(</span>g2m.features <span class="hljs-operator">=</span> cc.genes<span class="hljs-operator">$</span>g2m.genes<span class="hljs-punctuation">,</span><br>                                  s.features <span class="hljs-operator">=</span> cc.genes<span class="hljs-operator">$</span>s.genes<span class="hljs-punctuation">,</span><br>                                  g1.features <span class="hljs-operator">=</span> cc.genes<span class="hljs-operator">$</span>g1.genes<span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_f212c24f2e4cfe53a674523bc3a7355b.png"></p><h3 id="聚类分群"><a href="#聚类分群" class="headerlink" title="聚类分群"></a>聚类分群</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs R">scRNA_harmony <span class="hljs-operator">&lt;-</span> FindVariableFeatures<span class="hljs-punctuation">(</span>scRNA_harmony<span class="hljs-punctuation">)</span><br>scRNA_harmony <span class="hljs-operator">&lt;-</span> ScaleData<span class="hljs-punctuation">(</span>scRNA_harmony<span class="hljs-punctuation">,</span> vars.to.regress<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;Phase&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;nCount_RNA&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;percent.mt&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>scRNA_harmony <span class="hljs-operator">&lt;-</span> RunPCA<span class="hljs-punctuation">(</span>scRNA_harmony<span class="hljs-punctuation">,</span> verbose<span class="hljs-operator">=</span><span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>harmony<span class="hljs-punctuation">)</span><br>system.time<span class="hljs-punctuation">(</span><span class="hljs-punctuation">&#123;</span>scRNA_harmony <span class="hljs-operator">&lt;-</span> RunHarmony<span class="hljs-punctuation">(</span>scRNA_harmony<span class="hljs-punctuation">,</span> group.by.vars <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;sample&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">)</span><br>plot1 <span class="hljs-operator">&lt;-</span> DimPlot<span class="hljs-punctuation">(</span>scRNA_harmony<span class="hljs-punctuation">,</span> reduction <span class="hljs-operator">=</span> <span class="hljs-string">&quot;pca&quot;</span><span class="hljs-punctuation">,</span> group.by<span class="hljs-operator">=</span><span class="hljs-string">&quot;sample&quot;</span><span class="hljs-punctuation">,</span>raster<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>plot2 <span class="hljs-operator">&lt;-</span> ElbowPlot<span class="hljs-punctuation">(</span>scRNA_harmony<span class="hljs-punctuation">,</span> ndims<span class="hljs-operator">=</span><span class="hljs-number">50</span><span class="hljs-punctuation">,</span> reduction<span class="hljs-operator">=</span><span class="hljs-string">&quot;pca&quot;</span><span class="hljs-punctuation">)</span><br>plotc <span class="hljs-operator">&lt;-</span> plot1<span class="hljs-operator">+</span>plot2<br>plotc<br>pc.num <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">30</span><br>scRNA_harmony <span class="hljs-operator">&lt;-</span> RunUMAP<span class="hljs-punctuation">(</span>scRNA_harmony<span class="hljs-punctuation">,</span> reduction <span class="hljs-operator">=</span> <span class="hljs-string">&quot;harmony&quot;</span><span class="hljs-punctuation">,</span> dims <span class="hljs-operator">=</span> pc.num<span class="hljs-punctuation">)</span><br><span class="hljs-comment">#scRNA_harmony &lt;- RunTSNE(scRNA_harmony, reduction = &quot;harmony&quot;, dims = pc.num)</span><br>scRNA_harmony <span class="hljs-operator">&lt;-</span> FindNeighbors<span class="hljs-punctuation">(</span>scRNA_harmony<span class="hljs-punctuation">,</span> reduction <span class="hljs-operator">=</span> <span class="hljs-string">&quot;harmony&quot;</span><span class="hljs-punctuation">,</span> dims <span class="hljs-operator">=</span> pc.num<span class="hljs-punctuation">)</span><br>scRNA_harmony <span class="hljs-operator">&lt;-</span> FindClusters<span class="hljs-punctuation">(</span>scRNA_harmony<span class="hljs-punctuation">,</span> reduction <span class="hljs-operator">=</span> <span class="hljs-string">&quot;harmony&quot;</span><span class="hljs-punctuation">,</span> resolution <span class="hljs-operator">=</span> <span class="hljs-number">0.8</span><span class="hljs-punctuation">)</span><br>DimPlot<span class="hljs-punctuation">(</span>scRNA_harmony<span class="hljs-punctuation">,</span> reduction <span class="hljs-operator">=</span> <span class="hljs-string">&quot;umap&quot;</span><span class="hljs-punctuation">,</span> label<span class="hljs-operator">=</span><span class="hljs-built_in">T</span><span class="hljs-punctuation">,</span>raster<span class="hljs-operator">=</span><span class="hljs-built_in">F</span><span class="hljs-punctuation">)</span><br><span class="hljs-comment">#DimPlot(scRNA_harmony, reduction = &quot;tsne&quot;, label=T)</span><br>qsave<span class="hljs-punctuation">(</span>scRNA_harmony<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;001_大群Harmony.qs&quot;</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>BRAC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>scRNA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2024/05/28/%E8%A7%86%E9%A2%91%E5%88%B6%E4%BD%9C/"/>
    <url>/2024/05/28/%E8%A7%86%E9%A2%91%E5%88%B6%E4%BD%9C/</url>
    
    <content type="html"><![CDATA[<h2 id="视频制作"><a href="#视频制作" class="headerlink" title="视频制作"></a>视频制作</h2><h3 id="远程连接工具的使用"><a href="#远程连接工具的使用" class="headerlink" title="远程连接工具的使用"></a>远程连接工具的使用</h3><blockquote><p>windows系统</p></blockquote><h4 id="xshell"><a href="#xshell" class="headerlink" title="xshell"></a>xshell</h4><h4 id="Mobaxterm"><a href="#Mobaxterm" class="headerlink" title="Mobaxterm"></a>Mobaxterm</h4><blockquote><p>MAC系统</p></blockquote><h4 id="windterm"><a href="#windterm" class="headerlink" title="windterm"></a>windterm</h4><h4 id="tabby"><a href="#tabby" class="headerlink" title="tabby"></a>tabby</h4><h3 id="文件传输"><a href="#文件传输" class="headerlink" title="文件传输"></a>文件传输</h3><blockquote><p>服务器和电脑之间文件传输</p></blockquote><h4 id="命令行传输"><a href="#命令行传输" class="headerlink" title="命令行传输"></a>命令行传输</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">lrzsz中的rz和sz命令<br>ftp和sftp<br></code></pre></td></tr></table></figure><h4 id="图形界面软件"><a href="#图形界面软件" class="headerlink" title="图形界面软件"></a>图形界面软件</h4><p>windows系统: Winscp</p><p>Mac系统：<a href="https://www.filezilla.cn/">FileZilla</a></p><blockquote><p>服务器和服务器之间传输</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">SCP<br>rcp<br>rsync<br></code></pre></td></tr></table></figure><h3 id="硬盘挂载"><a href="#硬盘挂载" class="headerlink" title="硬盘挂载"></a>硬盘挂载</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">mount<br>unmount<br></code></pre></td></tr></table></figure><h3 id="虚拟桌面或终端复用工具"><a href="#虚拟桌面或终端复用工具" class="headerlink" title="虚拟桌面或终端复用工具"></a>虚拟桌面或终端复用工具</h3><h4 id="Tmux"><a href="#Tmux" class="headerlink" title="Tmux"></a>Tmux</h4><h4 id="screen"><a href="#screen" class="headerlink" title="screen"></a>screen</h4><h3 id="服务器中conda的使用"><a href="#服务器中conda的使用" class="headerlink" title="服务器中conda的使用"></a>服务器中conda的使用</h3><h3 id="服务其中R包的安装方式"><a href="#服务其中R包的安装方式" class="headerlink" title="服务其中R包的安装方式"></a>服务其中R包的安装方式</h3><h4 id="conda-安装"><a href="#conda-安装" class="headerlink" title="conda 安装"></a>conda 安装</h4><h4 id="本地安装"><a href="#本地安装" class="headerlink" title="本地安装"></a>本地安装</h4><h4 id="命令行安装"><a href="#命令行安装" class="headerlink" title="命令行安装"></a>命令行安装</h4><h3 id="集群服务器的使用"><a href="#集群服务器的使用" class="headerlink" title="集群服务器的使用"></a>集群服务器的使用</h3><h4 id="计算节点和管理节点"><a href="#计算节点和管理节点" class="headerlink" title="计算节点和管理节点"></a>计算节点和管理节点</h4><h4 id="pbs任务管理器的使用"><a href="#pbs任务管理器的使用" class="headerlink" title="pbs任务管理器的使用"></a>pbs任务管理器的使用</h4><h5 id="任务提交及查询"><a href="#任务提交及查询" class="headerlink" title="任务提交及查询"></a>任务提交及查询</h5><h5 id="计算节点的切换"><a href="#计算节点的切换" class="headerlink" title="计算节点的切换"></a>计算节点的切换</h5><h5 id="任务终止"><a href="#任务终止" class="headerlink" title="任务终止"></a>任务终止</h5><h3 id="服务器终端radian使用R语言"><a href="#服务器终端radian使用R语言" class="headerlink" title="服务器终端radian使用R语言"></a>服务器终端radian使用R语言</h3><h3 id="服务器终端ipython使用python"><a href="#服务器终端ipython使用python" class="headerlink" title="服务器终端ipython使用python"></a>服务器终端ipython使用python</h3><h3 id="服务器中Rstudio使用R语言"><a href="#服务器中Rstudio使用R语言" class="headerlink" title="服务器中Rstudio使用R语言"></a>服务器中Rstudio使用R语言</h3><h3 id="服务器中jupyter使用python"><a href="#服务器中jupyter使用python" class="headerlink" title="服务器中jupyter使用python"></a>服务器中jupyter使用python</h3><h4 id="常用编辑器的使用"><a href="#常用编辑器的使用" class="headerlink" title="常用编辑器的使用"></a>常用编辑器的使用</h4><h5 id="vscode"><a href="#vscode" class="headerlink" title="vscode"></a>vscode</h5><h5 id="sublime"><a href="#sublime" class="headerlink" title="sublime"></a>sublime</h5>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>java学习</title>
    <link href="/2024/05/28/java%E5%AD%A6%E4%B9%A0/"/>
    <url>/2024/05/28/java%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1 id="Java-基础语法"><a href="#Java-基础语法" class="headerlink" title="Java 基础语法"></a>Java 基础语法</h1><h3 id="基础数据类型"><a href="#基础数据类型" class="headerlink" title="基础数据类型"></a>基础数据类型</h3><p>Java语言提供了8种基本数据类型，分别是<strong>byte、short、int、long、float、double、boolean、char</strong></p><p>一个字节有8个比特位。</p><table><thead><tr><th>byte</th><th>8位</th><th>1个字节</th></tr></thead><tbody><tr><td>short</td><td>16位</td><td>2个字节</td></tr><tr><td>int</td><td>32位</td><td>4个字节</td></tr><tr><td>long</td><td>64位</td><td>8个字节</td></tr><tr><td>float</td><td>32位</td><td>4个字节</td></tr><tr><td>double</td><td>64位</td><td>8个字节</td></tr><tr><td>boolean</td><td>8位</td><td>1个字节</td></tr><tr><td>char</td><td>16位</td><td>2个字节</td></tr></tbody></table><p>字节最左位是符号位，例如：byte的最大值为2^(16-1)-1，最小值为-（2^15）。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.New;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">dataType</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">byte</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> <span class="hljs-number">10</span>;<br>        <span class="hljs-type">short</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> <span class="hljs-number">20</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">30</span>;<br>        <span class="hljs-type">long</span> <span class="hljs-variable">l</span> <span class="hljs-operator">=</span> <span class="hljs-number">40</span>;<br>        <span class="hljs-type">float</span> <span class="hljs-variable">f</span> <span class="hljs-operator">=</span> <span class="hljs-number">50.0f</span>;<br>        <span class="hljs-type">double</span> <span class="hljs-variable">d</span> <span class="hljs-operator">=</span> <span class="hljs-number">60.0</span>;<br>        <span class="hljs-type">char</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;A&#x27;</span>;<br>        <span class="hljs-type">boolean</span> <span class="hljs-variable">bo</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>;<br>        System.out.println(<span class="hljs-string">&quot;byte: &quot;</span> + b);<br>        System.out.println(<span class="hljs-string">&quot;short: &quot;</span> + s);<br>        System.out.println(<span class="hljs-string">&quot;int: &quot;</span> + i);<br>        System.out.println(<span class="hljs-string">&quot;long: &quot;</span> + l);<br>        System.out.println(<span class="hljs-string">&quot;float: &quot;</span> + f);<br>        System.out.println(<span class="hljs-string">&quot;double: &quot;</span> + d);<br>        System.out.println(<span class="hljs-string">&quot;char: &quot;</span> + c);<br>        System.out.println(<span class="hljs-string">&quot;boolean: &quot;</span> + bo);<br>    &#125;<br>&#125;<br><span class="hljs-comment">//byte: 10</span><br><span class="hljs-comment">//short: 20</span><br><span class="hljs-comment">//int: 30</span><br><span class="hljs-comment">//long: 40</span><br><span class="hljs-comment">//float: 50.0</span><br><span class="hljs-comment">//double: 60.0</span><br><span class="hljs-comment">//char: A</span><br><span class="hljs-comment">//boolean: true</span><br></code></pre></td></tr></table></figure><p>tips: 什么是双精度，什么是单精度？</p><p>在Java中，单精度（float）和双精度（double）是两种用于表示浮点数的数据类型。浮点数是用于表示实数（即有小数部分的数）的数值数据类型。这两种类型的主要区别在于它们的精度（即存储的数字的准确程度）和范围（即可以表示的最大和最小数值）。</p><ol><li><strong>单精度（float）</strong>：<ul><li>占用32位（4字节）的存储空间。</li><li>大约有7位有效数字。</li><li>表示的数值范围较小，但足够大多数日常计算使用。</li><li>在声明时，可以使用<code>float</code>关键字，但在赋值时，通常需要在数字后面加上<code>f</code>或<code>F</code>来表明这是一个单精度浮点数，例如：<code>float myFloat = 3.14f;</code>。</li></ul></li><li><strong>双精度（double）</strong>：<ul><li>占用64位（8字节）的存储空间。</li><li>大约有15-16位有效数字。</li><li>表示的数值范围更大，精度也更高。</li><li>在声明时，可以使用<code>double</code>关键字，例如：<code>double myDouble = 3.141592653589793;</code>。</li></ul></li></ol><p>由于双精度浮点数具有更高的精度和更大的范围，因此在大多数需要高精度计算的场景中，建议使用双精度浮点数。但是，如果你知道你的数据不需要那么高的精度，或者为了节省存储空间，可以使用单精度浮点数</p><h3 id="java中基础数据类型转换"><a href="#java中基础数据类型转换" class="headerlink" title="java中基础数据类型转换"></a>java中基础数据类型转换</h3><h4 id="自动类型转换"><a href="#自动类型转换" class="headerlink" title="自动类型转换"></a>自动类型转换</h4><p>当低精度向高精度转换的时候，可以进行自动类型转换。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">byte</span> -&gt; <span class="hljs-type">short</span> -&gt; <span class="hljs-type">int</span> -&gt; <span class="hljs-type">long</span> -&gt; <span class="hljs-type">float</span> -&gt; <span class="hljs-type">double</span><br><span class="hljs-type">char</span> -&gt; <span class="hljs-type">int</span> -&gt; <span class="hljs-type">long</span> -&gt; <span class="hljs-type">float</span> -&gt; <span class="hljs-type">double</span><br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.New;<br><br><span class="hljs-keyword">import</span> java.lang.reflect.Type;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">dataType01</span> &#123;<br>   <span class="hljs-comment">// 定义一个方法，根据传入的对象，返回其数据类型</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">getDataType</span><span class="hljs-params">(Object obj)</span> &#123;<br>        <span class="hljs-keyword">if</span> (obj == <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;null&quot;</span>;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (obj <span class="hljs-keyword">instanceof</span> Integer) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;int&quot;</span>;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (obj <span class="hljs-keyword">instanceof</span> Double) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;double&quot;</span>;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (obj <span class="hljs-keyword">instanceof</span> Byte) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;byte&quot;</span>;<br>        &#125; <span class="hljs-comment">// ... 其他类型检查</span><br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">return</span> obj.getClass().getSimpleName();<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">byte</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> <span class="hljs-number">127</span>;<br>        <span class="hljs-type">short</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> <span class="hljs-number">32767</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">2147483647</span>;<br>        <span class="hljs-type">double</span> <span class="hljs-variable">d</span> <span class="hljs-operator">=</span> <span class="hljs-number">123.456</span>;<br>        <span class="hljs-type">double</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> d * s;<br>        System.out.println(result);<br>        System.out.println(getDataType(result));<br>        System.out.println(<span class="hljs-string">&quot;-------------------&quot;</span>);<br>        <span class="hljs-type">char</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;A&#x27;</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">result1</span> <span class="hljs-operator">=</span> c + <span class="hljs-number">1</span>;<br>        System.out.println(result1);<br>        System.out.println(getDataType(result1));<br>    &#125;<br>&#125;<br><span class="hljs-comment">//4045282.7520000003</span><br><span class="hljs-comment">//double</span><br><span class="hljs-comment">//-------------------</span><br><span class="hljs-comment">//66</span><br><span class="hljs-comment">//int</span><br></code></pre></td></tr></table></figure><h3 id="强制类型转换"><a href="#强制类型转换" class="headerlink" title="强制类型转换"></a>强制类型转换</h3><p>在Java中，强制类型转换（也称为窄化转换或<strong>向下转型</strong>）是一种显式地将一种数据类型的值转换为另一种数据类型的操作。<strong>这种转换在源类型和目标类型之间存在潜在的信息丢失风险时是必需的</strong>，因为编译器不会自动进行这样的转换。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.New;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">dataType02</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">double</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> <span class="hljs-number">20.5</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) b;<br>        System.out.println(a);<br>        System.out.println(a ==b ? <span class="hljs-string">&quot;Equal&quot;</span> : <span class="hljs-string">&quot;Not Equal&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-comment">//20</span><br><span class="hljs-comment">//Not Equal</span><br></code></pre></td></tr></table></figure><h3 id="java中流程控制"><a href="#java中流程控制" class="headerlink" title="java中流程控制"></a>java中流程控制</h3><h4 id="顺序控制"><a href="#顺序控制" class="headerlink" title="顺序控制"></a>顺序控制</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//在Java中，if语句的基本语法如下：</span><br><span class="hljs-keyword">if</span> (condition) &#123;<br>    <span class="hljs-comment">// 如果条件为真执行的代码块</span><br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-comment">// 如果条件为假执行的代码块</span><br>&#125;<br><span class="hljs-comment">// condation是布尔值</span><br></code></pre></td></tr></table></figure><blockquote><p>单分支结构</p></blockquote><p>举例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.New;<br><br><span class="hljs-keyword">import</span> java.util.Scanner;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IfDemo</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Scanner</span> <span class="hljs-variable">scanner</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);<br>        System.out.print(<span class="hljs-string">&quot;Enter the first number: &quot;</span>);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">num1</span> <span class="hljs-operator">=</span> scanner.nextInt();<br>        <span class="hljs-keyword">if</span> (num1 &gt; <span class="hljs-number">60</span>)&#123;<br>            System.out.println(<span class="hljs-string">&quot;The first number is greater than 60&quot;</span>);<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            System.out.println(<span class="hljs-string">&quot;The first number is less than or equal to 60&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-comment">// 70</span><br><span class="hljs-comment">// The first number is greater than 60</span><br></code></pre></td></tr></table></figure><blockquote><p>多分支结构</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//在Java中，if语句多分支的基本语法如下：</span><br><span class="hljs-keyword">if</span> (condition) &#123;<br>    <span class="hljs-comment">// 如果条件为真执行的代码块</span><br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>&#123;<br>    <span class="hljs-comment">// 如果条件为假执行的代码块</span><br>&#125;<br><span class="hljs-comment">// condation是布尔值</span><br></code></pre></td></tr></table></figure><p>举例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.New;<br><span class="hljs-keyword">import</span> java.util.Scanner;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IfDemo02</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Scanner</span> <span class="hljs-variable">scanner</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);<br>        System.out.print(<span class="hljs-string">&quot;Enter the first number: &quot;</span>);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">num1</span> <span class="hljs-operator">=</span> scanner.nextInt();<br>        System.out.print(<span class="hljs-string">&quot;Enter the second number: &quot;</span>);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">num2</span> <span class="hljs-operator">=</span> scanner.nextInt();<br>        <span class="hljs-keyword">if</span> (num1 &gt; num2) &#123;<br>            System.out.println(num1 + <span class="hljs-string">&quot; is greater than &quot;</span> + num2);<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (num1 &lt; num2) &#123;<br>            System.out.println(num2 + <span class="hljs-string">&quot; is greater than &quot;</span> + num1);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            System.out.println(<span class="hljs-string">&quot;Both numbers are equal&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-comment">//Enter the first number: 10</span><br><span class="hljs-comment">//Enter the second number: 20</span><br><span class="hljs-comment">//20 is greater than 10</span><br></code></pre></td></tr></table></figure><h3 id="循环结构"><a href="#循环结构" class="headerlink" title="循环结构"></a>循环结构</h3><h4 id="for循环"><a href="#for循环" class="headerlink" title="for循环"></a>for循环</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">for</span>(初始化; 布尔表达式; 更新) &#123;<br>    <span class="hljs-comment">//代码语句</span><br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>举例</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.New;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ForDemo</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">int</span>[] arr = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>&#125;;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; arr.length; i++) &#123;<br>            System.out.println(<span class="hljs-string">&quot;Element at index &quot;</span> + i + <span class="hljs-string">&quot; is &quot;</span> +arr[i]);<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-comment">//Element at index 0 is 1</span><br><span class="hljs-comment">//Element at index 1 is 2</span><br><span class="hljs-comment">//Element at index 2 is 3</span><br><span class="hljs-comment">//Element at index 3 is 4</span><br><span class="hljs-comment">//Element at index 4 is 5</span><br></code></pre></td></tr></table></figure><h4 id="while循环"><a href="#while循环" class="headerlink" title="while循环"></a>while循环</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">while</span>( 布尔表达式 ) &#123;<br>  <span class="hljs-comment">//循环内容</span><br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>举例</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.New;<br><span class="hljs-keyword">import</span> java.util.Scanner;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">whileDemo</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Scanner</span> <span class="hljs-variable">sc</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);<br>        System.out.println(<span class="hljs-string">&quot;Enter a number:&quot;</span>);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">num</span> <span class="hljs-operator">=</span> sc.nextInt();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">while</span> (i &lt;= num) &#123;<br>            System.out.println(<span class="hljs-string">&quot;hello world&quot;</span>);<br>            i++;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-comment">//Enter a number:</span><br><span class="hljs-comment">//7</span><br><span class="hljs-comment">//hello world</span><br><span class="hljs-comment">//hello world</span><br><span class="hljs-comment">//hello world</span><br><span class="hljs-comment">//hello world</span><br><span class="hljs-comment">//hello world</span><br><span class="hljs-comment">//hello world</span><br><span class="hljs-comment">//hello world</span><br></code></pre></td></tr></table></figure><h4 id="do-while循环"><a href="#do-while循环" class="headerlink" title="do..while循环"></a>do..while循环</h4><p>对于 while 语句而言，如果不满足条件，则不能进入循环。但有时候我们需要即使不满足条件，也至少执行一次。do…while 循环和 while 循环相似，不同的是，do…while 循环至少会执行一次。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">do</span> &#123;<br>       <span class="hljs-comment">//代码语句</span><br>&#125;<span class="hljs-keyword">while</span>(布尔表达式);<br></code></pre></td></tr></table></figure><blockquote><p>举例</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.New;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DowhileDemo</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">do</span> &#123;<br>            System.out.println(i);<br>            i++;<br>        &#125;<span class="hljs-keyword">while</span>(i &lt; <span class="hljs-number">5</span>);<br>    &#125;<br>&#125;<br><span class="hljs-comment">//0</span><br><span class="hljs-comment">//1</span><br><span class="hljs-comment">//2</span><br><span class="hljs-comment">//3</span><br><span class="hljs-comment">//4</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>python中的闭包和装饰器</title>
    <link href="/2024/05/28/python%E4%B8%AD%E7%9A%84%E9%97%AD%E5%8C%85%E5%92%8C%E8%A3%85%E9%A5%B0%E5%99%A8/"/>
    <url>/2024/05/28/python%E4%B8%AD%E7%9A%84%E9%97%AD%E5%8C%85%E5%92%8C%E8%A3%85%E9%A5%B0%E5%99%A8/</url>
    
    <content type="html"><![CDATA[<h2 id="python中的闭包和装饰器"><a href="#python中的闭包和装饰器" class="headerlink" title="python中的闭包和装饰器"></a>python中的闭包和装饰器</h2><hr><p>title: python中的闭包和装饰器</p><p>date: 2024-01-14 16:35:20 </p><p>tags: - 原创 </p><p>categories: - python</p><hr><h3 id="引入闭包"><a href="#引入闭包" class="headerlink" title="引入闭包"></a>引入闭包</h3><p>在python的函数中，变量的作用域是有生命周期的，在函数运行完成以后，函数中的变量便会死去。出于种种原因，我们有时候需要在函数外部得到函数内的局部变量。但是，由于<a href="https://zhuanlan.zhihu.com/p/400388568">Python中作用域的搜索顺序</a>（”链式作用域”结构（chain scope）：子对象会一级一级地向上寻找所有父对象的变量），这一点通常是无法实现的。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 函数中的变量的作用域</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fun1</span>():<br>    n = <span class="hljs-number">1000</span><br><br><span class="hljs-built_in">print</span>(n)<br></code></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/01/14/hbsoOEzdrnA3B8L.png" alt="image-20240114163423406"></p><p>在函数的外部访问函数内部的变量会报错，函数中的变量作用域是局部变量，在全局环境中无法访问。如果想要能够访问函数中的变量，可以在函数中再建立一个函数，然后返回函数中的内部函数，内部函数中再返回函数中的变量，这样就可以访问函数中的变量了。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">fun1</span>():<br>    n = <span class="hljs-number">999</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">fun2</span>():<br>        <span class="hljs-built_in">print</span>(n)<br>    <span class="hljs-keyword">return</span> fun2<br><br>var = fun1()<br>var()<br></code></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/01/14/5ux7zXi8J3YryVM.png" alt="image-20240114164022916"></p><p>从上面的程序中可以看出，外部函数的返回值是一个函数地址，调用函数地址就可以使用返回的函数。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">fun3</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;hello word&quot;</span>)<br><br><br><span class="hljs-built_in">print</span>(fun3)<br></code></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/01/14/TWnB7HyDNSwbx3z.png" alt="image-20240114164410201"></p><h3 id="闭包的概念"><a href="#闭包的概念" class="headerlink" title="闭包的概念"></a>闭包的概念</h3><p>在一个外函数中定义了一个内函数，内函数里运用了外函数的临时变量，并且外函数的返回值是内函数的引<br>用。这样就构成了一个闭包。</p><p>一般情况下，在我们认知当中，如果一个函数结束，函数的内部所有东西都会释放掉，还给内存，局部变量都会消失。但是闭包是一种特殊情况，如果外函数在结束的时候发现有自己的临时变量将来会在内部函数中用到，就把这个临时变量绑定给了内部函数，然后自己再结束。</p><ul><li>作用1：闭包是将外层函数内的局部变量和外层函数的外部连接起来的一座桥梁。</li><li>作用2：将外层函数的变量持久地保存在内存中。</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">x,y</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">f</span>(<span class="hljs-params">z</span>):<br>        <span class="hljs-keyword">return</span> x+y+z<br>    <span class="hljs-keyword">return</span> f<br><br>d = add(<span class="hljs-number">5</span>,<span class="hljs-number">6</span>)<br><span class="hljs-built_in">print</span>(d(<span class="hljs-number">9</span>))<br><span class="hljs-built_in">print</span>(d(<span class="hljs-number">1</span>))<br></code></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/01/14/5mYruainXA9JToO.png" alt="image-20240114170539463"></p><h3 id="引入装饰器"><a href="#引入装饰器" class="headerlink" title="引入装饰器"></a>引入装饰器</h3><p>实现一个应用，在函数执行之前输出befor，在函数执行之后使用after。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 使用最粗暴的方法</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;before&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;我是func函数&#x27;</span>)<br>    value = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>]<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;after&quot;</span>)<br>    <span class="hljs-keyword">return</span> value<br><span class="hljs-comment"># 调用func函数</span><br>func()<br></code></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/01/14/n8bNDrgXOVBf3w4.png" alt="image-20240114235427163"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 使用闭包</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;我是func函数&#x27;</span>)<br>    value = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]<br>    <span class="hljs-keyword">return</span> value<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func1</span>(<span class="hljs-params">f</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">inner_func</span>():<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;before&quot;</span>)<br>        result = f()<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;after&quot;</span>)<br>        <span class="hljs-keyword">return</span> result<br><br>    <span class="hljs-keyword">return</span> inner_func<br><br><br>func2 = func1(func)<br>result = func2()<br><span class="hljs-built_in">print</span>(result)<br></code></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/01/15/tAdCaV9wOWFHech.png" alt="image-20240115000425465"></p><p>上方的func1(func)的结果是获得inner_func的函数地址，result的结果是调用inner_func函数。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;我是func函数&#x27;</span>)<br>    value = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]<br>    <span class="hljs-keyword">return</span> value<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func1</span>(<span class="hljs-params">f</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">inner_func</span>():<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;inner_func的函数地址<span class="hljs-subst">&#123;inner_func&#125;</span>&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;before&quot;</span>)<br>        result = f()<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;after&quot;</span>)<br>        <span class="hljs-keyword">return</span> result<br><br>    <span class="hljs-keyword">return</span> inner_func<br><br><br>func2 = func1(func)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;func2的地址是<span class="hljs-subst">&#123;func2&#125;</span>&quot;</span>)<br>result = func2()<br><span class="hljs-built_in">print</span>(result)<br></code></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/01/15/qs3hUaY89zWLwMc.png" alt="image-20240115003213204"></p><p>在python中可以使用装饰器来简化上方的过程。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">func1</span>(<span class="hljs-params">f</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">inner_func</span>():<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;inner_func的函数地址<span class="hljs-subst">&#123;inner_func&#125;</span>&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;before&quot;</span>)<br>        result = f()<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;after&quot;</span>)<br>        <span class="hljs-keyword">return</span> result<br><br>    <span class="hljs-keyword">return</span> inner_func<br><br><br><span class="hljs-meta">@func1</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;func函数的地址是<span class="hljs-subst">&#123;func&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;我是func函数&#x27;</span>)<br>    value = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]<br>    <span class="hljs-keyword">return</span> value<br><br><br>func()<br></code></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/01/15/bGMq93h25iLJ6uV.png" alt="image-20240115004506286"></p><h3 id="装饰器添加参数"><a href="#装饰器添加参数" class="headerlink" title="装饰器添加参数"></a>装饰器添加参数</h3><p>上面的例子都是无参函数，如果是有参数的函数，上面的程序是否还有正确运行呢？</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">func1</span>(<span class="hljs-params">f</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">inner_func</span>():<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;inner_func的函数地址<span class="hljs-subst">&#123;inner_func&#125;</span>&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;before&quot;</span>)<br>        result = f()<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;after&quot;</span>)<br>        <span class="hljs-keyword">return</span> result<br><br>    <span class="hljs-keyword">return</span> inner_func<br><br><br><span class="hljs-meta">@func1</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>(<span class="hljs-params">a</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;func函数的地址是<span class="hljs-subst">&#123;func&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;我是func函数&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;函数的参数是:<span class="hljs-subst">&#123;a&#125;</span>&quot;</span>)<br>    value = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]<br>    <span class="hljs-keyword">return</span> value<br><br><br>func(a=<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/01/15/XPn89TWm47Cev3b.png" alt="image-20240115004956314"></p><p>在函数中添加*args和**kwargs</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">func1</span>(<span class="hljs-params">f</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">inner_func</span>(<span class="hljs-params">*args, **kwargs</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;inner_func的函数地址<span class="hljs-subst">&#123;inner_func&#125;</span>&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;before&quot;</span>)<br>        result = f(*args, **kwargs)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;after&quot;</span>)<br>        <span class="hljs-keyword">return</span> result<br><br>    <span class="hljs-keyword">return</span> inner_func<br><br><br><span class="hljs-meta">@func1</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>(<span class="hljs-params">a</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;func函数的地址是<span class="hljs-subst">&#123;func&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;我是func函数&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;函数的参数是:<span class="hljs-subst">&#123;a&#125;</span>&quot;</span>)<br>    value = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]<br>    <span class="hljs-keyword">return</span> value<br><br><br>func(a=<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/01/15/ejLG8qOrfdpsZgR.png" alt="image-20240115010955515"></p><h3 id="装饰器扩展"><a href="#装饰器扩展" class="headerlink" title="装饰器扩展"></a>装饰器扩展</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">func1</span>(<span class="hljs-params">f</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">inner_func</span>(<span class="hljs-params">*args, **kwargs</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;这是inner_func函数&quot;&quot;&quot;</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;before&quot;</span>)<br>        result = f(*args, **kwargs)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;after&quot;</span>)<br>        <span class="hljs-keyword">return</span> result<br><br>    <span class="hljs-keyword">return</span> inner_func<br><br><br><span class="hljs-meta">@func1</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>(<span class="hljs-params">a</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;这是func函数&quot;&quot;&quot;</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;我是func函数&#x27;</span>)<br>    value = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]<br>    <span class="hljs-keyword">return</span> value<br><br><br><span class="hljs-built_in">print</span>(func.__doc__)<br><span class="hljs-built_in">print</span>(func.__name__)<br></code></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/01/15/DIHiOhUlbckXSoP.png" alt="image-20240115011512053"></p><p>在函数中答应文档信息和函数名称，可以很明显的看出当func函数使用装饰器装饰后，文档和函数名均输出为inner_func的函数名和doc文档。这也与上方的闭包符合。如果想打印出func函数的文档信息和函数名称的话，需要使用functiontools函数。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> functools<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func1</span>(<span class="hljs-params">f</span>):<br><span class="hljs-meta">    @functools.wraps(<span class="hljs-params">f</span>)</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">inner_func</span>(<span class="hljs-params">*args, **kwargs</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;这是inner_func函数&quot;&quot;&quot;</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;before&quot;</span>)<br>        result = f(*args, **kwargs)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;after&quot;</span>)<br>        <span class="hljs-keyword">return</span> result<br><br>    <span class="hljs-keyword">return</span> inner_func<br><br><br><span class="hljs-meta">@func1</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>(<span class="hljs-params">a</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;这是func函数&quot;&quot;&quot;</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;我是func函数&#x27;</span>)<br>    value = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]<br>    <span class="hljs-keyword">return</span> value<br><br><br>func(a=<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span>(func.__name__)<br><span class="hljs-built_in">print</span>(func.__doc__)<br></code></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/01/15/Lw9txQuzCXVnbiH.png" alt="image-20240115012317116"></p>]]></content>
    
    
    <categories>
      
      <category>python base</category>
      
    </categories>
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>文章代码学习01</title>
    <link href="/2024/05/28/%E6%96%87%E7%AB%A0%E4%BB%A3%E7%A0%81%E5%AD%A6%E4%B9%A001/"/>
    <url>/2024/05/28/%E6%96%87%E7%AB%A0%E4%BB%A3%E7%A0%81%E5%AD%A6%E4%B9%A001/</url>
    
    <content type="html"><![CDATA[<h1 id="R语言文章代码学习"><a href="#R语言文章代码学习" class="headerlink" title="R语言文章代码学习"></a>R语言文章代码学习</h1><blockquote><p>文章链接:Single-cell analysis of anti-BCMA CAR T cell therapy inpatients with central nervous system autoimmunity</p><p>代码地址:</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>R</category>
      
    </categories>
    
    
    <tags>
      
      <tag>R</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2024/05/27/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0/R%E8%AF%AD%E8%A8%80%E4%B8%AD%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92/"/>
    <url>/2024/05/27/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0/R%E8%AF%AD%E8%A8%80%E4%B8%AD%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92/</url>
    
    <content type="html"><![CDATA[<h1 id="R语言中参数传递"><a href="#R语言中参数传递" class="headerlink" title="R语言中参数传递"></a>R语言中参数传递</h1><h2 id="getopt"><a href="#getopt" class="headerlink" title="getopt"></a>getopt</h2><blockquote><p><a href="https://github.com/trevorld/r-getopt">https://github.com/trevorld/r-getopt</a></p></blockquote><h3 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs R">getopt<span class="hljs-punctuation">(</span><br>     spec <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span><br>     opt <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span><br>     command <span class="hljs-operator">=</span> get_Rscript_filename<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>     usage <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">,</span><br>     debug <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p>space是一个参数矩阵，该参数矩阵至少包括4列，使用matrix(x,ncol&#x3D;4,byrow&#x3D;TRUE)。</p><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_984b6d64c8b842bc76ff984b2144752d.png"></p><h3 id="举例"><a href="#举例" class="headerlink" title="举例"></a>举例</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs R">library<span class="hljs-punctuation">(</span>getopt<span class="hljs-punctuation">)</span><br><br>spac <span class="hljs-operator">=</span> matrix<span class="hljs-punctuation">(</span><br><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;first&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-string">&quot;f&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;integer&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;This is first!&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-string">&quot;second&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;s&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;character&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-string">&quot;This is second!&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-string">&quot;third&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-string">&quot;t&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;double&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-string">&quot;This is third!&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-string">&quot;help&quot;</span><span class="hljs-punctuation">,</span>   <span class="hljs-string">&quot;h&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;logical&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-string">&quot;This is Help!&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  byrow<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> ncol<span class="hljs-operator">=</span><span class="hljs-number">5</span><span class="hljs-punctuation">)</span><br><br>opt <span class="hljs-operator">=</span> getopt<span class="hljs-punctuation">(</span>spac<span class="hljs-punctuation">)</span><br>opt <span class="hljs-operator">=</span> getopt<span class="hljs-punctuation">(</span>spac<span class="hljs-punctuation">)</span><br>cat<span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;第一个参数&#x27;</span><span class="hljs-punctuation">,</span>opt<span class="hljs-operator">$</span>first<span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;\n&#x27;</span><span class="hljs-punctuation">)</span><br>cat<span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;第二个参数&#x27;</span><span class="hljs-punctuation">,</span>opt<span class="hljs-operator">$</span>second<span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;\n&#x27;</span><span class="hljs-punctuation">)</span><br>cat<span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;第三个参数&#x27;</span><span class="hljs-punctuation">,</span>opt<span class="hljs-operator">$</span>third<span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;\n&#x27;</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p>将上面的代码封装在getopttest.R文件中，使用Rscript调用该文件</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs R">Rscript getopttest.R <span class="hljs-operator">-</span>f <span class="hljs-number">123</span> <span class="hljs-operator">-</span>s ABC <span class="hljs-operator">-</span>t <span class="hljs-number">23</span><br><span class="hljs-comment"># 第一个参数 123 </span><br><span class="hljs-comment"># 第二个参数 ABC </span><br><span class="hljs-comment"># 第三个参数 23 </span><br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_57f3e0f010237aaa5bc996aaa2b7b754.png"></p><p>上面的代码不能打印帮助信息，可以添加</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment">#usage: If ‘TRUE’, argument ‘opt’ will be ignored and a usage</span><br><span class="hljs-comment">#         statement (character string) will be generated and returned</span><br><span class="hljs-comment">#         from ‘spec’.</span><br></code></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs R">library<span class="hljs-punctuation">(</span>getopt<span class="hljs-punctuation">)</span><br><br>spac <span class="hljs-operator">=</span> matrix<span class="hljs-punctuation">(</span><br><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;first&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-string">&quot;f&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;integer&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;This is first!&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-string">&quot;second&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;s&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;character&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-string">&quot;This is second!&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-string">&quot;third&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-string">&quot;t&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;double&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-string">&quot;This is third!&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-string">&quot;help&quot;</span><span class="hljs-punctuation">,</span>   <span class="hljs-string">&quot;h&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;logical&quot;</span><span class="hljs-punctuation">,</span>  <span class="hljs-string">&quot;This is Help!&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  byrow<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> ncol<span class="hljs-operator">=</span><span class="hljs-number">5</span><span class="hljs-punctuation">)</span><br><br>opt <span class="hljs-operator">=</span> getopt<span class="hljs-punctuation">(</span>spac<span class="hljs-punctuation">)</span><br>cat<span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;第一个参数&#x27;</span><span class="hljs-punctuation">,</span>opt<span class="hljs-operator">$</span>first<span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;\n&#x27;</span><span class="hljs-punctuation">)</span><br>cat<span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;第二个参数&#x27;</span><span class="hljs-punctuation">,</span>opt<span class="hljs-operator">$</span>second<span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;\n&#x27;</span><span class="hljs-punctuation">)</span><br>cat<span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;第三个参数&#x27;</span><span class="hljs-punctuation">,</span>opt<span class="hljs-operator">$</span>third<span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;\n&#x27;</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 添加帮助信息</span><br><span class="hljs-keyword">if</span><span class="hljs-punctuation">(</span> <span class="hljs-operator">!</span><span class="hljs-built_in">is.null</span><span class="hljs-punctuation">(</span>opt<span class="hljs-operator">$</span>help<span class="hljs-punctuation">)</span> <span class="hljs-operator">||</span> <span class="hljs-built_in">is.null</span><span class="hljs-punctuation">(</span>opt<span class="hljs-operator">$</span>first<span class="hljs-punctuation">)</span> <span class="hljs-operator">||</span> <span class="hljs-built_in">is.null</span><span class="hljs-punctuation">(</span>opt<span class="hljs-operator">$</span>third<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">)</span><span class="hljs-punctuation">&#123;</span><br>    cat<span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span>getopt<span class="hljs-punctuation">(</span>spec<span class="hljs-operator">=</span>spac<span class="hljs-punctuation">,</span> usage <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;\n&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>    quit<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_23331c2b8d395b6cfed0a5dd63e097ae.png"></p><h2 id="getoptlong"><a href="#getoptlong" class="headerlink" title="getoptlong"></a>getoptlong</h2><blockquote><p><a href="https://github.com/jokergoo/GetoptLong">https://github.com/jokergoo/GetoptLong</a></p></blockquote><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs R">install.packages<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;GetoptLong&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-comment"># CRAN</span><br>devtools<span class="hljs-operator">::</span>install_github<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;jokergoo/GetoptLong&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-comment">#github</span><br></code></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs R">GetoptLong<span class="hljs-punctuation">(</span>...<span class="hljs-punctuation">,</span> <br>         help_head <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span> <br>         help_foot <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span> <br>         envir <span class="hljs-operator">=</span> parent.frame<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>         argv_str <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span> template_control <span class="hljs-operator">=</span> <span class="hljs-built_in">list</span><span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>         help_style <span class="hljs-operator">=</span> GetoptLong.options<span class="hljs-operator">$</span>help_style<span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2024/05/26/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0/R%E7%BB%98%E5%9B%BE%E7%B3%BB%E7%BB%9F/"/>
    <url>/2024/05/26/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0/R%E7%BB%98%E5%9B%BE%E7%B3%BB%E7%BB%9F/</url>
    
    <content type="html"><![CDATA[<h1 id="R绘图系统"><a href="#R绘图系统" class="headerlink" title="R绘图系统"></a>R绘图系统</h1><blockquote><p>R绘图系统有4种</p></blockquote><ol><li>R基础绘图系统<ul><li>也称为基本绘图系统或Base Plotting System。</li><li>它对应于R的内置<code>graphics</code>包。</li><li>特点是需要事先计划，直观地实时反映绘图和分析数据的逻辑。</li><li>绘图过程通常包括两个步骤：首先使用如<code>plot()</code>函数画出图的主体，然后在此基础上进行修饰和添加。</li><li>适用于绘制2D图形。</li></ul></li><li>Lattice绘图系统<ul><li>Lattice Plotting System。</li><li>特点是一次函数调用即可生成图形。</li><li>特别适用于观测变量间的交互，例如在变量z的不同水平下，变量y如何随变量x变化。</li></ul></li><li>ggplot2绘图系统<ul><li>基于“图形的语法”（The Grammar of Graphics）的绘图系统。</li><li>将数据映射到几何客体（如点、线、条）的美学属性（如颜色、形状、大小）。</li><li>结合了基本绘图系统和Lattice绘图系统的特点。</li><li>自动处理标题、文字说明、空间等，但也允许通过添加注释进行修改。</li></ul></li><li>Grid绘图系统<ul><li>虽然在参考文章中提到了Grid绘图系统，但详细描述并不多。Grid系统提供了一系列不同的绘图函数，但并没有提供一套完整的绘图函数，因此通常不是直接用于绘图，而是作为其他绘图系统（如lattice和ggplot2）的基础。</li></ul></li><li>其他绘图系统和包<ul><li>除了上述四种主要的绘图系统外，R还有大量的扩展包，这些包提供了各种各样的绘图功能和选项，包括交互式绘图、3D绘图、动画等。</li></ul></li></ol><h2 id="R基础绘图"><a href="#R基础绘图" class="headerlink" title="R基础绘图"></a>R基础绘图</h2><h3 id="单变量绘图"><a href="#单变量绘图" class="headerlink" title="单变量绘图"></a>单变量绘图</h3><h2 id="grid绘图系统"><a href="#grid绘图系统" class="headerlink" title="grid绘图系统"></a>grid绘图系统</h2><h3 id="grid中的视口函数"><a href="#grid中的视口函数" class="headerlink" title="grid中的视口函数"></a>grid中的视口函数</h3><h4 id="grid-circle"><a href="#grid-circle" class="headerlink" title="grid.circle()"></a>grid.circle()</h4><p>根据给定的位置和半径绘图。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs R">grid.newpage<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>grid.circle<span class="hljs-punctuation">(</span><br>    x <span class="hljs-operator">=</span> seq<span class="hljs-punctuation">(</span><span class="hljs-number">0.1</span><span class="hljs-punctuation">,</span><span class="hljs-number">0.9</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">length</span><span class="hljs-operator">=</span><span class="hljs-number">100</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>    y<span class="hljs-operator">=</span><span class="hljs-number">0.5</span><span class="hljs-operator">+</span><span class="hljs-number">0.4</span><span class="hljs-operator">*</span><span class="hljs-built_in">sin</span><span class="hljs-punctuation">(</span>seq<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-operator">*</span><span class="hljs-built_in">pi</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">length</span><span class="hljs-operator">=</span><span class="hljs-number">100</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>    r<span class="hljs-operator">=</span><span class="hljs-built_in">abs</span><span class="hljs-punctuation">(</span><span class="hljs-number">0.1</span><span class="hljs-operator">*</span><span class="hljs-built_in">cos</span><span class="hljs-punctuation">(</span>seq<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-operator">*</span><span class="hljs-built_in">pi</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">length</span><span class="hljs-operator">=</span><span class="hljs-number">100</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_77c734368e3d40ce4cdbd28d9b655414.png"></p><p>使用gpar函数修改颜色。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs R">grid.newpage<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>grid.circle<span class="hljs-punctuation">(</span><br>    x <span class="hljs-operator">=</span> seq<span class="hljs-punctuation">(</span><span class="hljs-number">0.1</span><span class="hljs-punctuation">,</span><span class="hljs-number">0.9</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">length</span><span class="hljs-operator">=</span><span class="hljs-number">100</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>    y<span class="hljs-operator">=</span><span class="hljs-number">0.5</span><span class="hljs-operator">+</span><span class="hljs-number">0.4</span><span class="hljs-operator">*</span><span class="hljs-built_in">sin</span><span class="hljs-punctuation">(</span>seq<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-operator">*</span><span class="hljs-built_in">pi</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">length</span><span class="hljs-operator">=</span><span class="hljs-number">100</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>    r<span class="hljs-operator">=</span><span class="hljs-built_in">abs</span><span class="hljs-punctuation">(</span><span class="hljs-number">0.1</span><span class="hljs-operator">*</span><span class="hljs-built_in">cos</span><span class="hljs-punctuation">(</span>seq<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-operator">*</span><span class="hljs-built_in">pi</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">length</span><span class="hljs-operator">=</span><span class="hljs-number">100</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>    gp <span class="hljs-operator">=</span> gpar<span class="hljs-punctuation">(</span>col<span class="hljs-operator">=</span><span class="hljs-string">&quot;red&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_328e8931201b46b6fbff616f0e0d4413.png"></p><h4 id="gpar"><a href="#gpar" class="headerlink" title="gpar()"></a>gpar()</h4><table><thead><tr><th>col</th><th>线条和边框的颜色。</th></tr></thead><tbody><tr><td>fill</td><td>用于填充矩形、多边形等的颜色</td></tr><tr><td>alpha</td><td>Alpha 通道透明度</td></tr><tr><td>lty</td><td>线型</td></tr><tr><td>lwd</td><td>行宽</td></tr><tr><td>lex</td><td>应用于线宽的乘数</td></tr><tr><td>lineend</td><td>线端样式(圆形、对接、方形)</td></tr><tr><td>linejoin</td><td>线连接样式(圆形、斜接、斜角)</td></tr><tr><td>linemitre</td><td>线斜接限制(数量大于 1)</td></tr><tr><td>fontsize</td><td>文本大小(以点为单位)</td></tr><tr><td>cex</td><td>应用于字体大小的乘数</td></tr><tr><td>fontfamily</td><td>字体家族</td></tr><tr><td>fontface</td><td>字体(粗体、斜体……)</td></tr><tr><td>lineheight</td><td>行高是文本大小的倍数</td></tr><tr><td>font</td><td>Font Face(fontface 的别名；为了向后兼容)</td></tr></tbody></table><h4 id="line"><a href="#line" class="headerlink" title="line"></a>line</h4><p>grid.move.to函数绘制线条的起点位置，grid.line.to绘制线条的结束点。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs R">grid.move.to<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> default.units <span class="hljs-operator">=</span> <span class="hljs-string">&quot;npc&quot;</span><span class="hljs-punctuation">,</span> name <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span><br>             draw <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> vp <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">)</span><br>grid.line.to<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> default.units <span class="hljs-operator">=</span> <span class="hljs-string">&quot;npc&quot;</span><span class="hljs-punctuation">,</span><br>             arrow <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span> name <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span><br>             gp <span class="hljs-operator">=</span> gpar<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> draw <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> vp <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs R">grid.newpage<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>grid.move.to<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br>grid.line.to<span class="hljs-punctuation">(</span><span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span>arrow <span class="hljs-operator">=</span> arrow<span class="hljs-punctuation">(</span>type <span class="hljs-operator">=</span> <span class="hljs-string">&quot;closed&quot;</span><span class="hljs-punctuation">,</span>angle <span class="hljs-operator">=</span> <span class="hljs-number">25</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>gp <span class="hljs-operator">=</span> gpar<span class="hljs-punctuation">(</span>col<span class="hljs-operator">=</span><span class="hljs-string">&quot;red&quot;</span><span class="hljs-punctuation">,</span>fill<span class="hljs-operator">=</span><span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_68c0bfbe45a315208ddc8e2077520d04.png"></p><h4 id="grid-curve"><a href="#grid-curve" class="headerlink" title="grid.curve"></a>grid.curve</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs R">grid.curve<span class="hljs-punctuation">(</span>...<span class="hljs-punctuation">)</span><br>curveGrob<span class="hljs-punctuation">(</span>x1<span class="hljs-punctuation">,</span> y1<span class="hljs-punctuation">,</span> x2<span class="hljs-punctuation">,</span> y2<span class="hljs-punctuation">,</span> default.units <span class="hljs-operator">=</span> <span class="hljs-string">&quot;npc&quot;</span><span class="hljs-punctuation">,</span><br>          curvature <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> angle <span class="hljs-operator">=</span> <span class="hljs-number">90</span><span class="hljs-punctuation">,</span> ncp <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> shape <span class="hljs-operator">=</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span><br>          square <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> squareShape <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span><br>          inflect <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">,</span> arrow <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span> open <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span><br>          debug <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">,</span><br>          name <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span> gp <span class="hljs-operator">=</span> gpar<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> vp <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">)</span><br>arcCurvature<span class="hljs-punctuation">(</span>theta<span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><table><thead><tr><th><code>x1</code></th><th>指定起始点 x-location 的数值向量或单位对象。</th></tr></thead><tbody><tr><td><code>y1</code></td><td>指定起始点 y-location 的数值向量或单位对象。</td></tr><tr><td><code>x2</code></td><td>指定终点x-location的数值向量或单位对象。</td></tr><tr><td><code>y2</code></td><td>指定终点y-location的数值向量或单位对象。</td></tr><tr><td><code>default.units</code></td><td>一个字符串，指示仅以数值形式给出 <code>x1</code> 、 <code>y1</code> 、 <code>x2</code> 或 <code>y2</code> 时使用的默认单位。</td></tr><tr><td><code>curvature</code></td><td>给出曲率量的数值。负值产生左手曲线，正值产生右手曲线，零产生直线。</td></tr><tr><td><code>angle</code></td><td>0 到 180 之间的数值，给出曲线控制点的倾斜量。小于 90 的值使曲线向起点倾斜，大于 90 的值使曲线向终点倾斜。</td></tr><tr><td><code>ncp</code></td><td>用于绘制曲线的控制点的数量。更多控制点可创建更平滑的曲线。</td></tr><tr><td><code>shape</code></td><td>由 -1 到 1 之间的值组成的数值向量，用于控制曲线相对于其控制点的形状。有关更多详细信息，请参阅<code>grid.xspline</code>。</td></tr><tr><td><code>square</code></td><td>控制是否以 city-block 方式或倾斜方式创建曲线控制点的逻辑值。当 <code>ncp</code> 为 1 并且 <code>angle</code> 为 90 时，这通常是 <code>TRUE</code> ，否则可能应设置为 <code>FALSE</code> (请参见下面的示例)。</td></tr><tr><td><code>squareShape</code></td><td><code>shape</code> 值，用于控制曲线相对于在 <code>square</code> 为 <code>TRUE</code> 时插入的任何其他控制点的行为。</td></tr><tr><td><code>inflect</code></td><td>一个逻辑值，指定曲线是否应切成两半并反转(请参见下面的示例)。</td></tr><tr><td><code>arrow</code></td><td>说明放置在曲线两端的箭头的列表，由 <code>arrow</code> 函数生成。</td></tr><tr><td><code>open</code></td><td>一个逻辑值，指示是否闭合曲线(连接起点和终点)。</td></tr><tr><td><code>debug</code></td><td>指示是否应绘制调试信息的逻辑值。</td></tr><tr><td><code>name</code></td><td>字符标识符。</td></tr><tr><td><code>gp</code></td><td>类 <code>&quot;gpar&quot;</code> 的对象，通常是调用函数 <code>gpar</code> 的输出。这本质上是图形参数设置的列表。</td></tr><tr><td><code>vp</code></td><td>网格视口对象(或 NULL)。</td></tr><tr><td><code>...</code></td><td>要传递给 <code>curveGrob</code> 的参数。</td></tr><tr><td><code>theta</code></td><td>角度(以度为单位)。</td></tr></tbody></table><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs R">grid.newpage<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>grid.curve<span class="hljs-punctuation">(</span>x1 <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br>           y1<span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br>           x2<span class="hljs-operator">=</span><span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span><br>           y2<span class="hljs-operator">=</span><span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span><br>           arrow<span class="hljs-operator">=</span>arrow<span class="hljs-punctuation">(</span>type <span class="hljs-operator">=</span> <span class="hljs-string">&quot;closed&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>gp<span class="hljs-operator">=</span>gpar<span class="hljs-punctuation">(</span>col<span class="hljs-operator">=</span><span class="hljs-string">&quot;red&quot;</span><span class="hljs-punctuation">,</span>lwd<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span>fill<span class="hljs-operator">=</span><span class="hljs-string">&quot;red&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>           angle<span class="hljs-operator">=</span><span class="hljs-number">130</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_4e670b373f9b8b3c960457e374907968.png"></p><h4 id="grid-segments"><a href="#grid-segments" class="headerlink" title="grid.segments"></a>grid.segments</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs R">grid.segments<span class="hljs-punctuation">(</span>x0 <span class="hljs-operator">=</span> unit<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;npc&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> y0 <span class="hljs-operator">=</span> unit<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;npc&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>              x1 <span class="hljs-operator">=</span> unit<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;npc&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> y1 <span class="hljs-operator">=</span> unit<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;npc&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>              default.units <span class="hljs-operator">=</span> <span class="hljs-string">&quot;npc&quot;</span><span class="hljs-punctuation">,</span><br>              arrow <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span><br>              name <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span> gp <span class="hljs-operator">=</span> gpar<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> draw <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> vp <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">)</span><br>segmentsGrob<span class="hljs-punctuation">(</span>x0 <span class="hljs-operator">=</span> unit<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;npc&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> y0 <span class="hljs-operator">=</span> unit<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;npc&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>              x1 <span class="hljs-operator">=</span> unit<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;npc&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> y1 <span class="hljs-operator">=</span> unit<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;npc&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>              default.units <span class="hljs-operator">=</span> <span class="hljs-string">&quot;npc&quot;</span><span class="hljs-punctuation">,</span><br>              arrow <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span> name <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span> gp <span class="hljs-operator">=</span> gpar<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> vp <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><table><thead><tr><th><code>x0</code></th><th>表示线段起始 x-values 的数字。</th></tr></thead><tbody><tr><td><code>y0</code></td><td>表示线段起始 y-values 的数字。</td></tr><tr><td><code>x1</code></td><td>表示线段停止x-values的数字。</td></tr><tr><td><code>y1</code></td><td>表示线段停止y-values的数字。</td></tr><tr><td><code>default.units</code></td><td>一个字符串。</td></tr><tr><td><code>arrow</code></td><td>说明放置在线段两端的箭头的列表，由 <code>arrow</code> 函数生成。</td></tr><tr><td><code>name</code></td><td>字符标识符。</td></tr><tr><td><code>gp</code></td><td>类 <code>&quot;gpar&quot;</code> 的对象，通常是调用函数 <code>gpar</code> 的输出。这本质上是图形参数设置的列表。</td></tr><tr><td><code>draw</code></td><td>指示是否应生成图形输出的逻辑值。</td></tr><tr><td><code>vp</code></td><td>网格视口对象(或 NULL)。</td></tr></tbody></table><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs R">grid.newpage<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>grid.segments<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span><span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span><br>              arrow <span class="hljs-operator">=</span> arrow<span class="hljs-punctuation">(</span>angle <span class="hljs-operator">=</span> <span class="hljs-number">25</span><span class="hljs-punctuation">,</span>type <span class="hljs-operator">=</span> <span class="hljs-string">&quot;closed&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>              gp <span class="hljs-operator">=</span> gpar<span class="hljs-punctuation">(</span>fill<span class="hljs-operator">=</span><span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_5a931f7c6fc00aa446c3897242aa7dd9.png"></p><h4 id="grid-ployline"><a href="#grid-ployline" class="headerlink" title="grid.ployline"></a>grid.ployline</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs R">polylineGrob<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> unit<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;npc&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>             y <span class="hljs-operator">=</span> unit<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;npc&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>             id<span class="hljs-operator">=</span><span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span> id.lengths<span class="hljs-operator">=</span><span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span><br>             default.units <span class="hljs-operator">=</span> <span class="hljs-string">&quot;npc&quot;</span><span class="hljs-punctuation">,</span><br>             arrow <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span> name <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span><br>             gp<span class="hljs-operator">=</span>gpar<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> vp <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><table><thead><tr><th><code>x</code></th><th>指定 x 值的数值向量或单位对象。</th></tr></thead><tbody><tr><td><code>y</code></td><td>指定 y 值的数值向量或单位对象。</td></tr><tr><td><code>default.units</code></td><td>指示仅以数字向量形式给出 <code>x</code> 或 <code>y</code> 时要使用的默认单位的字符串。</td></tr><tr><td><code>arrow</code></td><td>描述要放置在线条两端的箭头的列表，由 <code>arrow</code> 函数生成。</td></tr><tr><td><code>name</code></td><td>字符标识符。</td></tr><tr><td><code>gp</code></td><td>类 <code>&quot;gpar&quot;</code> 的对象，通常是调用函数 <code>gpar</code> 的输出。这基本上是图形参数设置的列表。</td></tr><tr><td><code>draw</code></td><td>指示是否应生成图形输出的逻辑值。</td></tr><tr><td><code>vp</code></td><td>网格视口对象（或 NULL）。</td></tr><tr><td><code>id</code></td><td>用于将 <code>x</code> 和 <code>y</code> 中的位置分成多行的数值向量。所有具有相同 <code>id</code> 的位置都属于同一线路。</td></tr><tr><td><code>id.lengths</code></td><td>用于将 <code>x</code> 和 <code>y</code> 中的位置分成多行的数值向量。指定组成单独行的连续位置块。</td></tr><tr><td><code>...</code></td><td>参数传递至 <code>polylineGrob</code> 。</td></tr></tbody></table><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs R">grid.newpage<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>grid.polyline<span class="hljs-punctuation">(</span>x<span class="hljs-operator">=</span>outer<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">.5</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-number">5</span><span class="hljs-operator">:</span><span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">5</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>             y<span class="hljs-operator">=</span>outer<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-number">5</span><span class="hljs-operator">:</span><span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">5</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>             id.lengths<span class="hljs-operator">=</span><span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span> <span class="hljs-number">5</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>             gp<span class="hljs-operator">=</span>gpar<span class="hljs-punctuation">(</span>col<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">5</span><span class="hljs-punctuation">,</span> lwd<span class="hljs-operator">=</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_d29712265d28d6fe36e0b4e9b855c6dc.png"></p><h4 id="grid-xpline"><a href="#grid-xpline" class="headerlink" title="grid.xpline"></a>grid.xpline</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs R">grid.xspline<span class="hljs-punctuation">(</span>...<span class="hljs-punctuation">)</span><br>xsplineGrob<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>            id <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span> id.lengths <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span><br>            default.units <span class="hljs-operator">=</span> <span class="hljs-string">&quot;npc&quot;</span><span class="hljs-punctuation">,</span><br>            shape <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> open <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> arrow <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span> repEnds <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span><br>            name <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span> gp <span class="hljs-operator">=</span> gpar<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> vp <span class="hljs-operator">=</span> <span class="hljs-literal">NULL</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><table><thead><tr><th><code>x</code></th><th>指定样条控制点x-locations的数值向量或单位对象。</th></tr></thead><tbody><tr><td><code>y</code></td><td>指定样条控制点y-locations的数值向量或单位对象。</td></tr><tr><td><code>id</code></td><td>用于将 <code>x</code> 和 <code>y</code> 中的位置分成多个 xsplines 的数值向量。具有相同 <code>id</code> 的所有位置都属于同一 xspline。</td></tr><tr><td><code>id.lengths</code></td><td>用于将 <code>x</code> 和 <code>y</code> 中的位置分隔成多个 xspline 的数值向量。指定构成单独xspline 的连续位置块。</td></tr><tr><td><code>default.units</code></td><td>指示 <code>x</code> 或 <code>y</code> 仅作为数值向量给出时使用的默认单位的字符串。</td></tr><tr><td><code>shape</code></td><td>值介于 -1 和 1 之间的数值向量，用于控制样条线相对于控制点的形状。</td></tr><tr><td><code>open</code></td><td>指示样条线是直线还是闭合形状的逻辑值。</td></tr><tr><td><code>arrow</code></td><td>说明要放置在 xspline 两端的箭头的列表，由 <code>arrow</code> 函数生成。</td></tr><tr><td><code>repEnds</code></td><td>一个逻辑值，指示是否应复制第一个和最后一个控制点来绘制曲线(请参阅下面的详细信息)。</td></tr><tr><td><code>name</code></td><td>字符标识符。</td></tr><tr><td><code>gp</code></td><td>类 <code>&quot;gpar&quot;</code> 的对象，通常是调用函数 <code>gpar</code> 的输出。这本质上是图形参数设置的列表。</td></tr><tr><td><code>vp</code></td><td>网格视口对象(或 NULL)。</td></tr><tr><td><code>...</code></td><td>要传递给 <code>xsplineGrob</code> 的参数。</td></tr></tbody></table><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs R">grid.newpage<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>x <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0.25</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.25</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.75</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.75</span><span class="hljs-punctuation">)</span><br>y <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0.25</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.75</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.75</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.25</span><span class="hljs-punctuation">)</span><br><br>xsplineTest <span class="hljs-operator">&lt;-</span> <span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span>s<span class="hljs-punctuation">,</span> i<span class="hljs-punctuation">,</span> j<span class="hljs-punctuation">,</span> open<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>  pushViewport<span class="hljs-punctuation">(</span>viewport<span class="hljs-punctuation">(</span>layout.pos.col<span class="hljs-operator">=</span>j<span class="hljs-punctuation">,</span> layout.pos.row<span class="hljs-operator">=</span>i<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>  grid.points<span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">,</span> y<span class="hljs-punctuation">,</span> default.units<span class="hljs-operator">=</span><span class="hljs-string">&quot;npc&quot;</span><span class="hljs-punctuation">,</span> pch<span class="hljs-operator">=</span><span class="hljs-number">16</span><span class="hljs-punctuation">,</span> size<span class="hljs-operator">=</span>unit<span class="hljs-punctuation">(</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;mm&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>  grid.xspline<span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">,</span> y<span class="hljs-punctuation">,</span> shape<span class="hljs-operator">=</span>s<span class="hljs-punctuation">,</span> open<span class="hljs-operator">=</span>open<span class="hljs-punctuation">,</span> gp<span class="hljs-operator">=</span>gpar<span class="hljs-punctuation">(</span>fill<span class="hljs-operator">=</span><span class="hljs-string">&quot;grey&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>  grid.text<span class="hljs-punctuation">(</span>s<span class="hljs-punctuation">,</span> gp<span class="hljs-operator">=</span>gpar<span class="hljs-punctuation">(</span>col<span class="hljs-operator">=</span><span class="hljs-string">&quot;grey&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>            x<span class="hljs-operator">=</span>unit<span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;npc&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> unit<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;mm&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>            y<span class="hljs-operator">=</span>unit<span class="hljs-punctuation">(</span>y<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;npc&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span> unit<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;mm&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>            hjust<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>            vjust<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>  popViewport<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br><br>pushViewport<span class="hljs-punctuation">(</span>viewport<span class="hljs-punctuation">(</span>width<span class="hljs-operator">=</span><span class="hljs-number">.5</span><span class="hljs-punctuation">,</span> x<span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> just<span class="hljs-operator">=</span><span class="hljs-string">&quot;left&quot;</span><span class="hljs-punctuation">,</span><br>                      layout<span class="hljs-operator">=</span>grid.layout<span class="hljs-punctuation">(</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> respect<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>pushViewport<span class="hljs-punctuation">(</span>viewport<span class="hljs-punctuation">(</span>layout.pos.row<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>grid.text<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Open Splines&quot;</span><span class="hljs-punctuation">,</span> y<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> just<span class="hljs-operator">=</span><span class="hljs-string">&quot;bottom&quot;</span><span class="hljs-punctuation">)</span><br>popViewport<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>xsplineTest<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>xsplineTest<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>xsplineTest<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>xsplineTest<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>xsplineTest<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>xsplineTest<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>xsplineTest<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>xsplineTest<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>xsplineTest<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>popViewport<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>pushViewport<span class="hljs-punctuation">(</span>viewport<span class="hljs-punctuation">(</span>width<span class="hljs-operator">=</span><span class="hljs-number">.5</span><span class="hljs-punctuation">,</span> x<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> just<span class="hljs-operator">=</span><span class="hljs-string">&quot;right&quot;</span><span class="hljs-punctuation">,</span><br>                      layout<span class="hljs-operator">=</span>grid.layout<span class="hljs-punctuation">(</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> respect<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>pushViewport<span class="hljs-punctuation">(</span>viewport<span class="hljs-punctuation">(</span>layout.pos.row<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>grid.text<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Closed Splines&quot;</span><span class="hljs-punctuation">,</span> y<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> just<span class="hljs-operator">=</span><span class="hljs-string">&quot;bottom&quot;</span><span class="hljs-punctuation">)</span><br>popViewport<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>xsplineTest<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span><br>xsplineTest<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span><br>xsplineTest<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span><br>xsplineTest<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span><br>xsplineTest<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span><br>xsplineTest<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">0</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span><br>xsplineTest<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-operator">-</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span><br>xsplineTest<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span><br>xsplineTest<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span><br>popViewport<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_f94decc7bb0065535df11335806b6433.png"></p><h4 id="grid-path"><a href="#grid-path" class="headerlink" title="grid.path"></a>grid.path</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs R">pathGrob<span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">,</span> y<span class="hljs-punctuation">,</span><br>         id<span class="hljs-operator">=</span><span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span> id.lengths<span class="hljs-operator">=</span><span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span><br>         pathId<span class="hljs-operator">=</span><span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span> pathId.lengths<span class="hljs-operator">=</span><span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span><br>         rule<span class="hljs-operator">=</span><span class="hljs-string">&quot;winding&quot;</span><span class="hljs-punctuation">,</span><br>         default.units<span class="hljs-operator">=</span><span class="hljs-string">&quot;npc&quot;</span><span class="hljs-punctuation">,</span><br>         name<span class="hljs-operator">=</span><span class="hljs-literal">NULL</span><span class="hljs-punctuation">,</span> gp<span class="hljs-operator">=</span>gpar<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> vp<span class="hljs-operator">=</span><span class="hljs-literal">NULL</span><span class="hljs-punctuation">)</span><br>grid.path<span class="hljs-punctuation">(</span>...<span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><table><thead><tr><th><code>x</code></th><th>指定 x-locations 的数值向量或单位对象。</th></tr></thead><tbody><tr><td><code>y</code></td><td>指定 y-locations 的数值向量或单位对象。</td></tr><tr><td><code>id</code></td><td>用于将 <code>x</code> 和 <code>y</code> 中的位置分隔为 sub-paths 的数值向量。所有具有相同<code>id</code>的位置都属于相同的sub-path。</td></tr><tr><td><code>id.lengths</code></td><td>用于将 <code>x</code> 和 <code>y</code> 中的位置分隔为 sub-paths 的数值向量。指定组成单独sub-paths的连续位置块。</td></tr><tr><td><code>pathId</code></td><td>用于将 <code>x</code> 和 <code>y</code> 中的位置分隔成不同路径的数值向量。所有具有相同 <code>pathId</code> 的位置都属于同一路径。</td></tr><tr><td><code>pathId.lengths</code></td><td>用于将 <code>x</code> 和 <code>y</code> 中的位置分隔成路径的数值向量。指定组成单独路径的连续位置块。</td></tr><tr><td><code>rule</code></td><td>指定填充规则的字符值： <code>&quot;winding&quot;</code> 或 <code>&quot;evenodd&quot;</code> 。</td></tr><tr><td><code>default.units</code></td><td>指示 <code>x</code> 或 <code>y</code> 仅作为数值向量给出时使用的默认单位的字符串。</td></tr><tr><td><code>name</code></td><td>字符标识符。</td></tr><tr><td><code>gp</code></td><td>类 <code>&quot;gpar&quot;</code> 的对象，通常是调用函数 <code>gpar</code> 的输出。这本质上是图形参数设置的列表。</td></tr><tr><td><code>vp</code></td><td>网格视口对象(或 NULL)。</td></tr><tr><td><code>...</code></td><td>传递给 <code>pathGrob()</code> 的参数。</td></tr></tbody></table><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs R">grid.newpage<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>angle <span class="hljs-operator">&lt;-</span> seq<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-operator">*</span><span class="hljs-built_in">pi</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">length</span><span class="hljs-operator">=</span><span class="hljs-number">10</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">[</span><span class="hljs-operator">-</span><span class="hljs-number">10</span><span class="hljs-punctuation">]</span><br>grid.path<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> <span class="hljs-number">0.25</span><span class="hljs-operator">+</span><span class="hljs-number">0.15</span><span class="hljs-operator">*</span><span class="hljs-built_in">cos</span><span class="hljs-punctuation">(</span>angle<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>y<span class="hljs-operator">=</span><span class="hljs-number">0.5</span><span class="hljs-operator">+</span><span class="hljs-number">0.3</span><span class="hljs-operator">*</span><span class="hljs-built_in">sin</span><span class="hljs-punctuation">(</span>angle<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>gp <span class="hljs-operator">=</span> gpar<span class="hljs-punctuation">(</span>fill<span class="hljs-operator">=</span><span class="hljs-string">&quot;grey&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>grid.path<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0.75</span><span class="hljs-operator">+</span><span class="hljs-number">0.15</span><span class="hljs-operator">*</span><span class="hljs-built_in">cos</span><span class="hljs-punctuation">(</span>angle<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-number">.7</span><span class="hljs-punctuation">,</span><span class="hljs-number">.7</span><span class="hljs-punctuation">,</span><span class="hljs-number">.8</span><span class="hljs-punctuation">,</span><span class="hljs-number">.8</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>          y<span class="hljs-operator">=</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0.5</span><span class="hljs-operator">+</span><span class="hljs-number">0.3</span><span class="hljs-operator">*</span><span class="hljs-built_in">sin</span><span class="hljs-punctuation">(</span>angle<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-number">.4</span><span class="hljs-punctuation">,</span><span class="hljs-number">.6</span><span class="hljs-punctuation">,</span><span class="hljs-number">.6</span><span class="hljs-punctuation">,</span><span class="hljs-number">.4</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>          id <span class="hljs-operator">=</span> <span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">9</span><span class="hljs-punctuation">,</span><span class="hljs-number">4</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>          gp<span class="hljs-operator">=</span>gpar<span class="hljs-punctuation">(</span>fill<span class="hljs-operator">=</span><span class="hljs-string">&quot;red&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_55d3e61ab3b6ec761d9955633ace66d0.png"></p><h4 id="grid-point"><a href="#grid-point" class="headerlink" title="grid.point"></a>grid.point</h4><h3 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h3><h4 id="viewpor"><a href="#viewpor" class="headerlink" title="viewpor()"></a>viewpor()</h4><p>viewport()创建新的视图，grid会默认生成一个根视图，这个视图对应整个页面，绘图是在整个页面，绘图是在整个页面中进行的，使用默认的绘图参数设置，直到创建新的视图为止。</p><h4 id="pushViewport"><a href="#pushViewport" class="headerlink" title="pushViewport()"></a>pushViewport()</h4><p>pushViewport()调入一个viewport()对象，并用它在糊涂设备上创建一个区域，这个区域成为后续图形输出的绘图背景。</p><h4 id="popViewport"><a href="#popViewport" class="headerlink" title="popViewport()"></a>popViewport()</h4><p>popViewport()函数有一个整数参数，默认的整数参数的值是1，指返回上一级的viewport()，整数参数为0，指返回最上级（root）viewport。</p><p>使用上面的三个视图函数绘图。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs R">grid.newpage<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>grid.text<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;top-left corner&quot;</span><span class="hljs-punctuation">,</span>x <span class="hljs-operator">=</span> unit<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;mm&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>y <span class="hljs-operator">=</span> unit<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;npc&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-operator">-</span>unit<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;mm&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>just <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;left&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;top&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><span class="hljs-comment">## 创建第一个视图</span><br>pushViewport<span class="hljs-punctuation">(</span>viewport<span class="hljs-punctuation">(</span>width <span class="hljs-operator">=</span> <span class="hljs-number">0.8</span><span class="hljs-punctuation">,</span>height <span class="hljs-operator">=</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span>angle <span class="hljs-operator">=</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span>name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;vp1&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>grid.rect<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>grid.text<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;top-left coener&quot;</span><span class="hljs-punctuation">,</span>x<span class="hljs-operator">=</span>unit<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;mm&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>y <span class="hljs-operator">=</span> unit<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;npc&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-operator">-</span>unit<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;mm&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>just <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;left&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;top&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><span class="hljs-comment">## 创建第二个视图</span><br>pushViewport<span class="hljs-punctuation">(</span>viewport<span class="hljs-punctuation">(</span>width <span class="hljs-operator">=</span> <span class="hljs-number">0.8</span><span class="hljs-punctuation">,</span>height <span class="hljs-operator">=</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span>angle <span class="hljs-operator">=</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span>name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;vp2&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>grid.rect<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>grid.text<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;top-left coener&quot;</span><span class="hljs-punctuation">,</span>x<span class="hljs-operator">=</span>unit<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;mm&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>y <span class="hljs-operator">=</span> unit<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;npc&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-operator">-</span>unit<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;mm&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>just <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;left&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;top&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><span class="hljs-comment">## 创建第三个视图</span><br>pushViewport<span class="hljs-punctuation">(</span>viewport<span class="hljs-punctuation">(</span>width <span class="hljs-operator">=</span> <span class="hljs-number">0.8</span><span class="hljs-punctuation">,</span>height <span class="hljs-operator">=</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span>angle <span class="hljs-operator">=</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span>name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;vp3&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>grid.rect<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>grid.text<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;top-left coener&quot;</span><span class="hljs-punctuation">,</span>x<span class="hljs-operator">=</span>unit<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;mm&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>y <span class="hljs-operator">=</span> unit<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;npc&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-operator">-</span>unit<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;mm&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>just <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;left&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;top&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><span class="hljs-comment">## </span><br>popViewport<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>grid.text<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;bottom-right coener&quot;</span><span class="hljs-punctuation">,</span>y<span class="hljs-operator">=</span>unit<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;mm&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>x <span class="hljs-operator">=</span> unit<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;npc&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-operator">-</span>unit<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;mm&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>just <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;right&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;bottom&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>gp <span class="hljs-operator">=</span> gpar<span class="hljs-punctuation">(</span>col<span class="hljs-operator">=</span><span class="hljs-string">&quot;red&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><span class="hljs-comment">##</span><br>popViewport<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">)</span><br>grid.text<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;bottom-right coener&quot;</span><span class="hljs-punctuation">,</span>y<span class="hljs-operator">=</span>unit<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;mm&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>x <span class="hljs-operator">=</span> unit<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;npc&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-operator">-</span>unit<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;mm&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>just <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;right&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;bottom&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>gp <span class="hljs-operator">=</span>gpar<span class="hljs-punctuation">(</span>col<span class="hljs-operator">=</span><span class="hljs-string">&quot;green&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><span class="hljs-comment">##</span><br>popViewport<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">)</span><br>grid.text<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;bottom-right coener&quot;</span><span class="hljs-punctuation">,</span>y<span class="hljs-operator">=</span>unit<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;mm&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>x <span class="hljs-operator">=</span> unit<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;npc&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-operator">-</span>unit<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;mm&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>just <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;right&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;bottom&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>gp <span class="hljs-operator">=</span>gpar<span class="hljs-punctuation">(</span>col<span class="hljs-operator">=</span><span class="hljs-string">&quot;blue&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p><img src="https://markdown.liuchengtu.com/work/uploads/upload_603d37deb937380236d3e7372244546d.png"></p><h4 id="upViewport函数和downViewport函数"><a href="#upViewport函数和downViewport函数" class="headerlink" title="upViewport函数和downViewport函数"></a>upViewport函数和downViewport函数</h4><p>upViewport()和downViewport()和popViewport函数的区别在于，popViewpoprt()会从页面中移除当前视图，但是upViewport和downViewport不会。</p><h4 id="seekViewport"><a href="#seekViewport" class="headerlink" title="seekViewport()"></a>seekViewport()</h4><p>seekViewport用于遍历视图树，在交互过程总会比较方便。</p><h3 id="视图列表，栈，树"><a href="#视图列表，栈，树" class="headerlink" title="视图列表，栈，树"></a>视图列表，栈，树</h3><ul><li>vpList()</li><li>vpStack()</li><li>vpTree()</li></ul><h2 id="grid绘图对象模型"><a href="#grid绘图对象模型" class="headerlink" title="grid绘图对象模型"></a>grid绘图对象模型</h2><h3 id="绘图元件grob"><a href="#绘图元件grob" class="headerlink" title="绘图元件grob"></a>绘图元件grob</h3><h4 id="grid-ls"><a href="#grid-ls" class="headerlink" title="grid.ls()"></a>grid.ls()</h4><p>grid.list()会显示的列出所有的绘图元件</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs R">grid.newpage<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>grid.circle<span class="hljs-punctuation">(</span>r<span class="hljs-operator">=</span><span class="hljs-number">.4</span><span class="hljs-punctuation">,</span>name<span class="hljs-operator">=</span><span class="hljs-string">&quot;mycircle&quot;</span><span class="hljs-punctuation">)</span><br>grid.ls<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <span class="hljs-comment"># mycircle</span><br></code></pre></td></tr></table></figure><h4 id="grid-edit"><a href="#grid-edit" class="headerlink" title="grid.edit()"></a>grid.edit()</h4><p>grid.edit()修改列表中的绘图元件</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs R">grid.newpage<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>grid.circle<span class="hljs-punctuation">(</span>r<span class="hljs-operator">=</span><span class="hljs-number">.4</span><span class="hljs-punctuation">,</span>name<span class="hljs-operator">=</span><span class="hljs-string">&quot;mycircle&quot;</span><span class="hljs-punctuation">)</span><br>grid.ls<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <span class="hljs-comment"># mycircle</span><br>grid.edit<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;mycircle&quot;</span><span class="hljs-punctuation">,</span>gp <span class="hljs-operator">=</span> gpar<span class="hljs-punctuation">(</span>fill<span class="hljs-operator">=</span><span class="hljs-string">&quot;blue&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><img src="https://markdown.liuchengtu.com/work/uploads/upload_96befd38beafcfaef7a37e45c348c91a.png" style="zoom:50%;" /><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs R">suffix <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&#x27;odd&#x27;</span><span class="hljs-punctuation">,</span><span class="hljs-string">&#x27;even&#x27;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><span class="hljs-number">4</span><span class="hljs-punctuation">)</span><br><span class="hljs-built_in">names</span> <span class="hljs-operator">&lt;-</span> paste0<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;circle&quot;</span><span class="hljs-punctuation">,</span>suffix<span class="hljs-punctuation">)</span><br><span class="hljs-built_in">names</span><br>grid.newpage<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><span class="hljs-keyword">for</span> <span class="hljs-punctuation">(</span>i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">8</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>  grid.circle<span class="hljs-punctuation">(</span>name <span class="hljs-operator">=</span> <span class="hljs-built_in">names</span><span class="hljs-punctuation">[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>r<span class="hljs-operator">=</span><span class="hljs-punctuation">(</span><span class="hljs-number">9</span><span class="hljs-operator">-</span>i<span class="hljs-punctuation">)</span><span class="hljs-operator">/</span><span class="hljs-number">20</span><span class="hljs-punctuation">,</span>gp<span class="hljs-operator">=</span>gpar<span class="hljs-punctuation">(</span>col<span class="hljs-operator">=</span> <span class="hljs-literal">NA</span><span class="hljs-punctuation">,</span> fill<span class="hljs-operator">=</span>gray<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">10</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br><span class="hljs-comment"># grid.ls()</span><br>grid.edit<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;circleodd&quot;</span><span class="hljs-punctuation">,</span>gp <span class="hljs-operator">=</span> gpar<span class="hljs-punctuation">(</span>fill<span class="hljs-operator">=</span><span class="hljs-string">&quot;red&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>global <span class="hljs-operator">=</span> <span class="hljs-built_in">T</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure><p> <img src="https://markdown.liuchengtu.com/work/uploads/upload_7b72d116d31c0da411ee56e9e9a0ce53.png"></p><h3 id="图形树gTrees"><a href="#图形树gTrees" class="headerlink" title="图形树gTrees"></a>图形树gTrees</h3><h4 id="捕捉和输出"><a href="#捕捉和输出" class="headerlink" title="捕捉和输出"></a>捕捉和输出</h4><h4 id="grid-grab和grid-grabExpr"><a href="#grid-grab和grid-grabExpr" class="headerlink" title="grid.grab和grid.grabExpr"></a>grid.grab和grid.grabExpr</h4>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>测试文章02</title>
    <link href="/2024/01/09/%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0/"/>
    <url>/2024/01/09/%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0/</url>
    
    <content type="html"><![CDATA[<p><img src="/./images/test.png"></p><p>this is a test</p>]]></content>
    
    
    <categories>
      
      <category>R语言</category>
      
    </categories>
    
    
    <tags>
      
      <tag>R语言</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2023/09/03/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0/R%E8%AF%AD%E8%A8%80%E4%B8%AD%E9%94%AE%E7%9B%98%E5%92%8C%E9%BC%A0%E6%A0%87%E4%BA%8B%E4%BB%B6/"/>
    <url>/2023/09/03/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0/R%E8%AF%AD%E8%A8%80%E4%B8%AD%E9%94%AE%E7%9B%98%E5%92%8C%E9%BC%A0%E6%A0%87%E4%BA%8B%E4%BB%B6/</url>
    
    <content type="html"><![CDATA[<h1 id="R语言中键盘和鼠标事件"><a href="#R语言中键盘和鼠标事件" class="headerlink" title="R语言中键盘和鼠标事件"></a>R语言中键盘和鼠标事件</h1>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2023/08/14/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0/R%E4%B8%AD%E7%9A%84%E9%9D%9E%E6%A0%87%E5%87%86%E8%AF%84%E4%BC%B0/"/>
    <url>/2023/08/14/R%E8%AF%AD%E8%A8%80%E5%AD%A6%E4%B9%A0/R%E4%B8%AD%E7%9A%84%E9%9D%9E%E6%A0%87%E5%87%86%E8%AF%84%E4%BC%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="R中的非标准评估"><a href="#R中的非标准评估" class="headerlink" title="R中的非标准评估"></a>R中的非标准评估</h1><h2 id="什么是非标准评估"><a href="#什么是非标准评估" class="headerlink" title="什么是非标准评估"></a>什么是非标准评估</h2><p>非标准评估（Non-standard evaluation，简称NSE）是R语言中的一个重要概念，涉及到如何处理变量、表达式和函数的名称。在标准的编程语言中，通常使用变量的名称来引用和操作变量，但在非标准评估中，变量的名称可能不是直接的字符串，而是以某种形式传递给函数或表达式。<font color="red"> 简单的说就是在编写函数的时候，有时候参数的传入是字符串，但是我们在函数体内传入的不是字符串，此时就需要使用标准评估进项转化。</font></p><p><strong>Tidy Evaluation (Tidy Eval)，不是一个宏包，而是一个非标准评估的框架，也叫延迟评估。主要目的是更方便地与tidyverse里的函数配合使用，事实上，很多时候我们不一定需要用到它</strong></p><ol><li>**enquo()**：<code>enquo</code> 是 “enquoting” 的缩写，用于创建一个引用（quosure）对象，将变量捕捉到一个对象中，以便在非标准评估环境中使用。它可以用来保存传递给函数的参数，并在函数内部使用。</li><li>**!!**（bang-bang）：<code>!!</code> 运算符，也叫 “unquote-splice” 运算符，用于将一个引用（quosure）解引用，使其成为正常的R表达式。它在函数内部用于执行非标准评估，将引用的值插入到表达式中。</li><li>**!!!**（triple-bang）：<code>!!!</code> 运算符，也叫 “unquote-splice” 运算符，用于将引用列表（list of quosures）解引用并展开成单个表达式。它允许您将多个引用嵌入到表达式中，以进行多个非标准评估操作。</li><li>**sym()**：<code>sym</code> 函数用于将字符转换为符号（symbol）。符号是一个表示R语言变量名的对象，可以在非标准评估环境中使用。</li><li>**syms()**：<code>syms</code> 函数用于将多个字符转换为一组符号。这在需要处理多个变量名时很有用，例如在循环中构建非标准评估的表达式</li></ol><h2 id="enquo"><a href="#enquo" class="headerlink" title="enquo()"></a>enquo()</h2><p>enquo是rlang包中用于非标准评估的函数之一，用于将变量捕获为引用对象(quosure)，以便在函数内部使用。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs R">library<span class="hljs-punctuation">(</span>dplyr<span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>rlang<span class="hljs-punctuation">)</span><br><br>data <span class="hljs-operator">&lt;-</span> data.frame<span class="hljs-punctuation">(</span>value <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span> <span class="hljs-number">20</span><span class="hljs-punctuation">,</span> <span class="hljs-number">25</span><span class="hljs-punctuation">,</span> <span class="hljs-number">30</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><br>calculate_mean <span class="hljs-operator">&lt;-</span> <span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">,</span> column<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>  column_quo <span class="hljs-operator">&lt;-</span> enquo<span class="hljs-punctuation">(</span>column<span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 捕获变量为引用对象</span><br>  <br>  mean_value <span class="hljs-operator">&lt;-</span> data <span class="hljs-operator">%&gt;%</span><br>    summarise<span class="hljs-punctuation">(</span>mean_value <span class="hljs-operator">=</span> mean<span class="hljs-punctuation">(</span><span class="hljs-operator">!</span><span class="hljs-operator">!</span>column_quo<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 使用 !! 解引用引用对象</span><br>  <br>  <span class="hljs-built_in">return</span><span class="hljs-punctuation">(</span>mean_value<span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br><br>result <span class="hljs-operator">&lt;-</span> calculate_mean<span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">,</span> column <span class="hljs-operator">=</span> value<span class="hljs-punctuation">)</span><br>print<span class="hljs-punctuation">(</span>result<span class="hljs-operator">$</span>mean_value<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 输出20</span><br></code></pre></td></tr></table></figure><p>在R中，<code>!!</code>（双感叹号）是 <code>rlang</code> 包中用于非标准评估（Non-Standard Evaluation，NSE）的一个关键运算符，它用于解引用引用（quosure）对象，将其嵌入到表达式中。在非标准评估环境中，<code>!!</code> 通常与 <code>enquo()</code> 函数一起使用，以便在函数内部引用外部变量。</p><p><font color="green">在上面的函数中value是环境变量名称没如果需要需要将value当中data数据框中的一列进行应用，需要对数据进行应用（quote）和解引用（unqote）两步</font></p><ul><li>第一步，用 <code>enquo()</code>把用户传递过来的参数引用起来（<strong>引用</strong>可以理解为<strong>冷冻</strong>起来）</li><li>第二步，用 <code>!!</code> 解开这个引用（<strong>解引用</strong>可以理解为<strong>解冷</strong>），然后使用参数的内容</li></ul><p>这个<code>quote-unquote</code>的过程让环境变量名变成了数据变量，也可以理解为在函数评估过程中，数据变量（data-variable）遮盖了环境变量（env-variable），即数据遮盖（data masking），看到value，正常情况下，本来应该是到环境变量里去找这个valuel对应的值，然而，数据遮盖机制，插队了，让代码去数据变量中去找valuel以及对应的值。</p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
